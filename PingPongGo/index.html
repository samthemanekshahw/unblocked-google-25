<!DOCTYPE html>

<html lang="en">
<head>
<title>Ping Pong Go!</title>
<meta charset="utf-8"/>
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="initial-scale=1.0,maximum-scale=1.01, minimal-ui" name="viewport"/>
<style>
		body {
			margin: 0px;
			padding: 0px;
			width: 100%;
			overflow:hidden
		}	

		canvas {	
			-ms-touch-action: none;
			image-rendering: -o-crisp-edges;           
			image-rendering: optimize-contrast;        
			-ms-interpolation-mode: nearest-neighbor;  
			-webkit-tap-highlight-color: rgba(0,0,0,0);
			-moz-tap-highlight-color: rgba(0,0,0,0);
			tap-highlight-color: rgba(0,0,0,0);
			user-select: none;
			-webkit-touch-callout: none;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
		} 
	</style>
<style type="text/css">	

		@font-face{
		font-family:"luckiestGuy";
		src:url("fonts/LuckiestGuy-Regular.ttf") format("opentype");
		}
		
		@font-face{
		font-family:"benchNine";
		src:url("fonts/BenchNine-Regular.ttf") format("opentype");
		}
					
	</style>
</meta></head>
<script>(()=>{var e=function(e){var n=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return n&&decodeURIComponent(n[1].replace(/\+/g," "))},n="kids"===e("tag"),o=new(function(){function e(){var e=this;this.queue=[],this.init=function(n){return void 0===n&&(n={}),new Promise((function(o,t){e.enqueue("init",n,o,t)}))},this.rewardedBreak=function(){return new Promise((function(e){e(!1)}))},this.noArguments=function(n){return function(){e.enqueue(n)}},this.oneArgument=function(n){return function(o){e.enqueue(n,o)}},this.handleAutoResolvePromise=function(){return new Promise((function(e){e()}))},this.throwNotLoaded=function(){console.debug("PokiSDK is not loaded yet. Not all methods are available.")}}return e.prototype.enqueue=function(e,o,t,i){var r={fn:e,options:o,resolveFn:t,rejectFn:i};n?i&&i():this.queue.push(r)},e.prototype.dequeue=function(){for(var e=function(){var e=n.queue.shift(),o=e,t=o.fn,i=o.options;"function"==typeof window.PokiSDK[t]?(null==e?void 0:e.resolveFn)||(null==e?void 0:e.rejectFn)?window.PokiSDK[t](i).then((function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];"function"==typeof e.resolveFn&&e.resolveFn.apply(e,n)})).catch((function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];"function"==typeof e.rejectFn&&e.rejectFn.apply(e,n)})):void 0!==(null==e?void 0:e.fn)&&window.PokiSDK[t](i):console.error("Cannot execute "+e.fn)},n=this;this.queue.length>0;)e()},e}());window.PokiSDK={init:o.init,initWithVideoHB:o.init,customEvent:o.throwNotLoaded,commercialBreak:o.handleAutoResolvePromise,rewardedBreak:o.rewardedBreak,displayAd:o.throwNotLoaded,destroyAd:o.throwNotLoaded,getLeaderboard:o.handleAutoResolvePromise,getSharableURL:function(){return new Promise((function(e,n){return n()}))},getURLParam:function(n){return e("gd"+n)||e(n)||""}},["disableProgrammatic","gameLoadingStart","gameLoadingFinished","gameInteractive","roundStart","roundEnd","muteAd"].forEach((function(e){window.PokiSDK[e]=o.noArguments(e)})),["setDebug","gameplayStart","gameplayStop","gameLoadingProgress","happyTime","setPlayerAge","togglePlayerAdvertisingConsent","logError","sendHighscore","setDebugTouchOverlayController"].forEach((function(e){window.PokiSDK[e]=o.oneArgument(e)}));var t,i=((t=window.pokiSDKVersion)||(t=e("ab")||"v2.263.0"),"poki-sdk-"+(n?"kids":"core")+"-"+t+".js"),r=document.createElement("script");r.setAttribute("src",i),r.setAttribute("type","text/javascript"),r.setAttribute("crossOrigin","anonymous"),r.onload=function(){return o.dequeue()},document.head.appendChild(r)})();</script>
<body>
<div id="canvas-wrapper" style="overflow:visible; width:100%; height:100%; margin:0; padding:0; position:absolute;">
<canvas id="canvas" moz-opaque=""></canvas>
</div>
</body>
<script>/* esm.sh - @poki/netlib@0.0.16 */
var H=Object.create;var x=Object.defineProperty,K=Object.defineProperties,X=Object.getOwnPropertyDescriptor,Y=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,ee=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var C=(a,t,e)=>t in a?x(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,S=(a,t)=>{for(var e in t||(t={}))$.call(t,e)&&C(a,e,t[e]);if(R)for(var e of R(t))te.call(t,e)&&C(a,e,t[e]);return a},M=(a,t)=>K(a,Y(t));var j=(a,t)=>()=>(t||a((t={exports:{}}).exports,t),t.exports);var ne=(a,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Z(t))!$.call(a,i)&&i!==e&&x(a,i,{get:()=>t[i],enumerable:!(n=X(t,i))||n.enumerable});return a};var ie=(a,t,e)=>(e=a!=null?H(ee(a)):{},ne(t||!a||!a.__esModule?x(e,"default",{value:a,enumerable:!0}):e,a));var c=(a,t,e)=>C(a,typeof t!="symbol"?t+"":t,e);var w=(a,t,e)=>new Promise((n,i)=>{var l=s=>{try{o(e.next(s))}catch(d){i(d)}},h=s=>{try{o(e.throw(s))}catch(d){i(d)}},o=s=>s.done?n(s.value):Promise.resolve(s.value).then(l,h);o((e=e.apply(a,t)).next())});var W=j((ue,I)=>{"use strict";var se=Object.prototype.hasOwnProperty,p="~";function y(){}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(p=!1));function re(a,t,e){this.fn=a,this.context=t,this.once=e||!1}function q(a,t,e,n,i){if(typeof e!="function")throw new TypeError("The listener must be a function");var l=new re(e,n||a,i),h=p?p+t:t;return a._events[h]?a._events[h].fn?a._events[h]=[a._events[h],l]:a._events[h].push(l):(a._events[h]=l,a._eventsCount++),a}function E(a,t){--a._eventsCount===0?a._events=new y:delete a._events[t]}function g(){this._events=new y,this._eventsCount=0}g.prototype.eventNames=function(){var t=[],e,n;if(this._eventsCount===0)return t;for(n in e=this._events)se.call(e,n)&&t.push(p?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};g.prototype.listeners=function(t){var e=p?p+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,l=n.length,h=new Array(l);i<l;i++)h[i]=n[i].fn;return h};g.prototype.listenerCount=function(t){var e=p?p+t:t,n=this._events[e];return n?n.fn?1:n.length:0};g.prototype.emit=function(t,e,n,i,l,h){var o=p?p+t:t;if(!this._events[o])return!1;var s=this._events[o],d=arguments.length,f,r;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),d){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,n),!0;case 4:return s.fn.call(s.context,e,n,i),!0;case 5:return s.fn.call(s.context,e,n,i,l),!0;case 6:return s.fn.call(s.context,e,n,i,l,h),!0}for(r=1,f=new Array(d-1);r<d;r++)f[r-1]=arguments[r];s.fn.apply(s.context,f)}else{var u=s.length,v;for(r=0;r<u;r++)switch(s[r].once&&this.removeListener(t,s[r].fn,void 0,!0),d){case 1:s[r].fn.call(s[r].context);break;case 2:s[r].fn.call(s[r].context,e);break;case 3:s[r].fn.call(s[r].context,e,n);break;case 4:s[r].fn.call(s[r].context,e,n,i);break;default:if(!f)for(v=1,f=new Array(d-1);v<d;v++)f[v-1]=arguments[v];s[r].fn.apply(s[r].context,f)}}return!0};g.prototype.on=function(t,e,n){return q(this,t,e,n,!1)};g.prototype.once=function(t,e,n){return q(this,t,e,n,!0)};g.prototype.removeListener=function(t,e,n,i){var l=p?p+t:t;if(!this._events[l])return this;if(!e)return E(this,l),this;var h=this._events[l];if(h.fn)h.fn===e&&(!i||h.once)&&(!n||h.context===n)&&E(this,l);else{for(var o=0,s=[],d=h.length;o<d;o++)(h[o].fn!==e||i&&!h[o].once||n&&h[o].context!==n)&&s.push(h[o]);s.length?this._events[l]=s.length===1?s[0]:s:E(this,l)}return this};g.prototype.removeAllListeners=function(t){var e;return t?(e=p?p+t:t,this._events[e]&&E(this,e)):(this._events=new y,this._eventsCount=0),this};g.prototype.off=g.prototype.removeListener;g.prototype.addListener=g.prototype.on;g.prefixed=p;g.EventEmitter=g;typeof I!="undefined"&&(I.exports=g)});var G=j((ge,k)=>{var Q=W();function _(a,t,e,n){Object.defineProperty(a,t,{get:e,set:n,enumerable:!0,configurable:!0})}_(k.exports,"DefaultSignalingURL",function(){return V});_(k.exports,"DefaultRTCConfiguration",function(){return z});_(k.exports,"DefaultDataChannels",function(){return F});_(k.exports,"Network",function(){return D});var O=5e3,b="turn:turn.rtc.poki.com",A=class{constructor(t){c(this,"signaling");c(this,"cachedCredentials");c(this,"cachedCredentialsExpireAt");c(this,"runningPromise");this.signaling=t,this.cachedCredentialsExpireAt=0}fillCredentials(t){return w(this,null,function*(){var l,h;let e=JSON.parse(JSON.stringify(t));if(t.testproxyURL!==void 0||!((h=(l=e.iceServers)==null?void 0:l.some(o=>o.urls===b||o.urls.includes(b)))!=null?h:!1)||e.iceServers===void 0)return e;this.runningPromise===void 0&&(this.runningPromise=new Promise(o=>{if(this.cachedCredentials!=null&&this.cachedCredentialsExpireAt>performance.now()){o(this.cachedCredentials);return}let s=setTimeout(()=>{o({type:"credentials"}),this.cachedCredentials={type:"credentials"},this.cachedCredentialsExpireAt=performance.now()+O},O);this.signaling.request({type:"credentials"}).then(d=>{var f;d.type==="credentials"&&(this.cachedCredentials=d,this.cachedCredentialsExpireAt=performance.now()+(((f=d.lifetime)!=null?f:0)-60)*1e3,clearTimeout(s),o(d))}).catch(()=>{clearTimeout(s),o({type:"credentials"}),this.cachedCredentials={type:"credentials"},this.cachedCredentialsExpireAt=performance.now()+O})}));let i=yield this.runningPromise;return this.runningPromise=void 0,i.url===void 0||e.iceServers.forEach(o=>{var s;(o.urls===b||o.urls.includes(b))&&(o.urls=(s=i.url)!=null?s:"",o.username=i.username,o.credential=i.credential)}),e})}},P=class extends Q.EventEmitter{constructor(e,n,i){super();c(this,"network");c(this,"url");c(this,"ws");c(this,"reconnectAttempt");c(this,"reconnecting");c(this,"receivedID");c(this,"receivedSecret");c(this,"currentLobby");c(this,"currentLobbyInfo");c(this,"currentLeader");c(this,"currentTerm");c(this,"connections");c(this,"replayQueue");c(this,"requests");this.network=e,this.reconnectAttempt=0,this.reconnecting=!1,this.currentTerm=0,this.requests=new Map,this.url=i,this.connections=n,this.replayQueue=new Map,this.ws=this.connect(),setInterval(()=>{this.ping()},5e3)}connect(){let e=new WebSocket(this.url),n=()=>{this.reconnectAttempt=0,this.reconnecting=!1,this.send({type:"hello",game:this.network.gameID,id:this.receivedID,secret:this.receivedSecret})},i=o=>{let s=new m("socket-error","unexpected websocket error",o);this.network._onSignalingError(s),e.readyState===WebSocket.CLOSED&&(this.reconnecting=!1,e.removeEventListener("open",n),e.removeEventListener("error",i),e.removeEventListener("message",l),e.removeEventListener("close",h),setTimeout(()=>{this.reconnect()},100))},l=o=>{this.handleSignalingMessage(o.data).catch(s=>{})},h=()=>{if(!this.network.closing){let o=new m("socket-error","signaling socket closed");this.network._onSignalingError(o)}e.removeEventListener("open",n),e.removeEventListener("error",i),e.removeEventListener("message",l),e.removeEventListener("close",h),setTimeout(()=>{this.reconnect()},100)};return e.addEventListener("open",n),e.addEventListener("error",i),e.addEventListener("message",l),e.addEventListener("close",h),e}reconnect(){if(!(this.reconnecting||this.network.closing)){if(this.close(),this.requests.forEach(e=>e.reject(new m("socket-error","signaling socket closed"))),this.requests.clear(),this.reconnectAttempt>42){this.network.emit("failed"),this.network._onSignalingError(new m("socket-error","giving up on reconnecting to signaling server"));return}this.event("signaling","attempt-reconnect"),this.reconnecting=!0,setTimeout(()=>{this.ws=this.connect()},Math.random()*100*this.reconnectAttempt),this.reconnectAttempt+=1}}close(){this.ws.close()}request(e){return w(this,null,function*(){return yield new Promise((n,i)=>{if(this.ws.readyState!==WebSocket.OPEN){i(new m("socket-error","signaling socket not open"));return}let l=Math.random().toString(36).slice(2);e.rid=l,this.network.log("requesting signaling packet:",e.type);let h=JSON.stringify(e);this.ws.send(h),this.requests.set(l,{resolve:n,reject:i})})})}send(e){if(this.ws.readyState===WebSocket.OPEN){this.network.log("sending signaling packet:",e.type);let n=JSON.stringify(e);this.ws.send(n)}}ping(){if(this.ws.readyState===WebSocket.OPEN){let e=JSON.stringify({type:"ping"});this.ws.send(e)}}handleSignalingMessage(e){return w(this,null,function*(){var n,i,l,h,o,s,d,f;try{let r=JSON.parse(e);if(this.network.log("signaling packet received:",r.type),r.rid!==void 0){let u=this.requests.get(r.rid);u!=null&&(this.requests.delete(r.rid),r.type==="error"?u.reject(new m("server-error",r.message,void 0,r.code)):u.resolve(r))}switch(r.type){case"error":{let u=new m("server-error",r.message,void 0,r.code);if(this.network._onSignalingError(u),r.code==="missing-recipient"&&((n=r.error)==null?void 0:n.recipient)!==void 0){let v=(i=r.error)==null?void 0:i.recipient;this.connections.has(v)&&(this.network.log("cleaning up missing recipient",v),(l=this.connections.get(v))==null||l.close("missing-recipient"))}else r.code==="reconnect-failed"&&this.network.close("reconnect failed")}break;case"welcome":if(this.receivedID!==void 0){this.network.log("signaling reconnected"),this.network.emit("signalingreconnected");return}if(r.id==="")throw new Error("missing id on received welcome packet");this.receivedID=r.id,this.receivedSecret=r.secret,this.network.emit("ready"),this.network._prefetchTURNCredentials();break;case"joined":{let u=r.lobbyInfo.code;if(u==="")throw new Error("missing lobby on received connect packet");this.currentLobby=u,this.currentLeader=r.lobbyInfo.leader,this.currentTerm=r.lobbyInfo.term,this.network.emit("lobby",u,r.lobbyInfo),this.currentLeader!==void 0&&this.network.emit("leader",this.currentLeader)}break;case"leader":if(this.currentLobby===void 0)return;r.term>this.currentTerm&&(this.currentLeader=r.leader,this.currentTerm=r.term,this.network.emit("leader",r.leader));break;case"lobbyUpdated":if(this.currentLobby===void 0)return;this.currentLobbyInfo=r.lobbyInfo,this.network.emit("lobbyUpdated",r.lobbyInfo.code,r.lobbyInfo);break;case"connect":if(this.receivedID===r.id)return;yield this.network._addPeer(r.id,r.polite);for(let u of(h=this.replayQueue.get(r.id))!=null?h:[])yield(o=this.connections.get(r.id))==null?void 0:o._onSignalingMessage(u);this.replayQueue.delete(r.id);break;case"disconnect":this.connections.has(r.id)&&((s=this.connections.get(r.id))==null||s.close());break;case"candidate":case"description":if(this.connections.has(r.source))yield(d=this.connections.get(r.source))==null?void 0:d._onSignalingMessage(r);else{let u=(f=this.replayQueue.get(r.source))!=null?f:[];u.push(r),this.replayQueue.set(r.source,u)}break;case"credentials":this.emit("credentials",r);break;case"ping":break}}catch(r){let u=new m("unknown-error",r);this.network._onSignalingError(u)}})}event(e,n,i){return w(this,null,function*(){return yield new Promise(l=>{setTimeout(()=>{this.send({type:"event",game:this.network.gameID,lobby:this.currentLobby,peer:this.network.id,category:e,action:n,data:i}),l()},0)})})}},m=class{constructor(t,e,n,i){c(this,"type");c(this,"message");c(this,"event");c(this,"code");this.type=t,this.message=e,this.event=n,this.code=i}toString(){return`[${this.type}: ${this.message}]`}},oe=500,ce=50,U="ping",J="pong",L=class{constructor(t,e){c(this,"peer");c(this,"control");c(this,"window");c(this,"lastPingSentAt");c(this,"last");c(this,"average");c(this,"jitter");c(this,"max");c(this,"min");this.peer=t,this.control=e,this.window=[],this.lastPingSentAt=0,this.last=0,this.average=0,this.jitter=0,this.max=0,this.min=0,e!==void 0&&(this.ping(),e.addEventListener("message",n=>this.onMessage(n.data)))}ping(){var t,e;this.lastPingSentAt=performance.now(),((t=this.control)==null?void 0:t.readyState)==="open"&&((e=this.control)==null||e.send(U))}onMessage(t){var i,l;if(t===U){((i=this.control)==null?void 0:i.readyState)==="open"&&((l=this.control)==null||l.send(J));return}if(t!==J)return;let n=performance.now()-this.lastPingSentAt;this.window.unshift(n),this.window.length>ce&&this.window.pop(),this.last=n,this.max=Math.max(...this.window),this.min=Math.min(...this.window),this.average=this.window.reduce((h,o)=>h+o,0)/this.window.length,this.window.length>1&&(this.jitter=this.window.slice(1).map((h,o)=>Math.abs(h-this.window[o])).reduce((h,o)=>h+o,0)/(this.window.length-1)),setTimeout(()=>this.ping(),Math.max(oe-n,0))}},ae=1e3,he=8e3,T=class{constructor(t,e,n,i,l){c(this,"network");c(this,"signaling");c(this,"id");c(this,"config");c(this,"polite");c(this,"conn");c(this,"makingOffer");c(this,"ignoreOffer");c(this,"isSettingRemoteAnswerPending");c(this,"opened");c(this,"closing");c(this,"reconnecting");c(this,"abortReconnectionAt");c(this,"allowNextManualRestartIceAt");c(this,"latency");c(this,"lastMessageReceivedAt");c(this,"politenessTimeout");c(this,"reportLatencyEventTimeout");c(this,"checkStateInterval");c(this,"channels");c(this,"testSessionWrapper");this.network=t,this.signaling=e,this.id=n,this.config=i,this.polite=l,this.makingOffer=!1,this.ignoreOffer=!1,this.isSettingRemoteAnswerPending=!1,this.opened=!1,this.closing=!1,this.reconnecting=!1,this.abortReconnectionAt=0,this.allowNextManualRestartIceAt=0,this.latency=new L(this),this.lastMessageReceivedAt=0,this.channels={},this.network.log("creating peer"),this.testSessionWrapper=void 0,this.conn=new RTCPeerConnection(i),i.testproxyURL===void 0?this.conn.addEventListener("icecandidate",o=>{let s=o.candidate;s!==null&&e.send({type:"candidate",source:this.network.id,recipient:this.id,candidate:s})}):this.testSessionWrapper=le,this.conn.addEventListener("negotiationneeded",()=>{this.politenessTimeout=setTimeout(()=>{w(this,null,function*(){var o;try{if(this.closing)return;this.makingOffer=!0,yield this.conn.setLocalDescription();let s=this.conn.localDescription;s!=null&&(yield(o=this.testSessionWrapper)==null?void 0:o.call(this,s,this.config,this.network.id,this.id),this.signaling.send({type:"description",source:this.network.id,recipient:this.id,description:s}))}catch(s){let d=new m("unknown-error",s);this.network._onSignalingError(d)}finally{this.makingOffer=!1}}).catch(o=>{})},this.polite?100:0)}),this.checkStateInterval=setInterval(()=>{this.checkState()},500),this.conn.addEventListener("signalingstatechange",()=>this.checkState()),this.conn.addEventListener("connectionstatechange",()=>this.checkState()),this.conn.addEventListener("iceconnectionstatechange",()=>this.checkState()),this.network.emit("connecting",this);let h=0;for(let o in this.network.dataChannels){let s=this.conn.createDataChannel(o,M(S({},this.network.dataChannels[o]),{id:h++,negotiated:!0}));s.binaryType="arraybuffer",s.addEventListener("error",d=>this.onError(d)),s.addEventListener("closing",()=>this.checkState()),s.addEventListener("close",()=>this.checkState()),s.addEventListener("open",()=>{!this.opened&&!Object.values(this.channels).some(d=>d.readyState!=="open")&&("control"in this.channels&&(this.latency=new L(this,this.channels.control)),this.politenessTimeout!==void 0&&clearTimeout(this.politenessTimeout),this.signaling.send({type:"connected",id:this.id}),this.opened=!0,this.network.emit("connected",this),this.signaling.event("rtc","connected",{target:this.id}),this.reportLatencyEventTimeout=setTimeout(()=>{this.signaling.event("rtc","avg-latency-at-10s",{target:this.id,latency:`${this.latency.average}`})},1e4))}),s.addEventListener("message",d=>{this.lastMessageReceivedAt=performance.now(),o!=="control"&&this.network.emit("message",this,o,d.data)}),this.channels[o]=s}}close(t){this.closing||(this.closing=!0,this.signaling.send({type:"disconnected",id:this.id,reason:t!=null?t:"normal closure"}),Object.values(this.channels).forEach(e=>e.close()),this.conn.close(),this.network._removePeer(this),this.checkStateInterval!=null&&clearInterval(this.checkStateInterval),this.reportLatencyEventTimeout!=null&&clearTimeout(this.reportLatencyEventTimeout),this.opened&&(this.network.emit("disconnected",this),this.signaling.event("rtc","disconnected",{target:this.id,reason:t!=null?t:"",reconnecting:this.reconnecting?"true":"false"})))}checkState(){var n;let t=performance.now(),e=(n=this.conn.connectionState)!=null?n:this.conn.iceConnectionState;if(!this.closing){if(!this.opened){e==="failed"&&this.close("connecting failed");return}if(Object.values(this.channels).some(i=>i.readyState!=="open")&&this.close("data channel closed"),!this.reconnecting&&(e==="disconnected"||e==="failed")?(this.reconnecting=!0,this.abortReconnectionAt=t+he,this.network.emit("reconnecting",this),this.signaling.event("rtc","attempt-reconnect",{target:this.id})):this.reconnecting&&e==="connected"?(this.reconnecting=!1,this.network.emit("reconnected",this),this.signaling.event("rtc","attempt-reconnected",{target:this.id})):this.reconnecting&&t>this.abortReconnectionAt&&this.close("reconnection timed out"),!this.reconnecting&&"control"in this.channels){let i=this.lastMessageReceivedAt;i!==0&&t-i>ae&&t>this.allowNextManualRestartIceAt&&(this.allowNextManualRestartIceAt=t+1e4,this.conn.restartIce())}}}onError(t){this.network.emit("rtcerror",t),this.network.listenerCount("rtcerror")===0&&console.error("rtcerror not handled:",t),this.checkState(),this.signaling.event("rtc","error",{target:this.id,error:JSON.stringify(t)})}_onSignalingMessage(t){return w(this,null,function*(){var e;switch(t.type){case"candidate":if(t.candidate!=null)try{yield this.conn.addIceCandidate(t.candidate)}catch(n){if(!this.ignoreOffer)throw n}break;case"description":{let{description:n}=t,i=!this.makingOffer&&(this.conn.signalingState==="stable"||this.isSettingRemoteAnswerPending),l=n.type==="offer"&&!i;if(this.ignoreOffer=!this.polite&&l,this.ignoreOffer)return;if(this.isSettingRemoteAnswerPending=n.type==="answer",yield this.conn.setRemoteDescription(n),this.isSettingRemoteAnswerPending=!1,n.type==="offer"){yield this.conn.setLocalDescription();let h=this.conn.localDescription;h!=null&&(yield(e=this.testSessionWrapper)==null?void 0:e.call(this,h,this.config,this.network.id,this.id),this.signaling.send({type:"description",source:this.network.id,recipient:this.id,description:h}))}}break}})}send(t,e){if(!(t in this.channels))throw new Error("unknown channel "+t);let n=this.channels[t];n.readyState==="open"&&n.send(e)}toString(){return`[Peer: ${this.id}]`}};function le(a,t,e,n){return w(this,null,function*(){var l;if(t.testproxyURL===void 0)return;let i=a.sdp.split(`\r
`);i=i.filter(h=>!h.startsWith("a=candidate")||h.includes("127.0.0.1")&&h.includes("udp"));for(let h=0;h<i.length;h++){let o=i[h];if(o.startsWith("a=candidate")&&o.includes("127.0.0.1")){let s=(l=o.split("127.0.0.1 ").pop())==null?void 0:l.split(" ")[0];if(s!=null){let f=yield(yield fetch(`${t.testproxyURL}/create?id=${e+n}&port=${s}`)).text();i[h]=o.replaceAll(` ${s} `,` ${f} `)}}}a.sdp=i.join(`\r
`)})}var D=class extends Q.EventEmitter{constructor(e,n=z,i=V){super();c(this,"gameID");c(this,"rtcConfig");c(this,"_closing");c(this,"peers");c(this,"signaling");c(this,"credentials");c(this,"dataChannels");c(this,"log");c(this,"unloadListener");this.gameID=e,this.rtcConfig=n,this._closing=!1,this.dataChannels=F,this.log=(...l)=>{},this.peers=new Map,this.signaling=new P(this,this.peers,i),this.credentials=new A(this.signaling),this.unloadListener=()=>this.close(),typeof window!="undefined"&&window.addEventListener("unload",this.unloadListener)}list(e){return w(this,null,function*(){if(this._closing||this.signaling.receivedID===void 0)return[];let n=e!=null?JSON.stringify(e):void 0,i=yield this.signaling.request({type:"list",filter:n});return i.type==="lobbies"?i.lobbies:[]})}create(e){return w(this,null,function*(){if(this._closing||this.signaling.receivedID===void 0)return"";let n=yield this.signaling.request(S({type:"create"},e));return n.type==="joined"?n.lobbyInfo.code:""})}join(e,n){return w(this,null,function*(){if(this._closing||this.signaling.receivedID===void 0)return;let i=yield this.signaling.request({type:"join",lobby:e,password:n});if(i.type==="joined")return i.lobbyInfo})}setLobbySettings(e){return w(this,null,function*(){return this._closing||this.signaling.receivedID===void 0?new Error("network is closing or not connected"):(yield this.signaling.request(S({type:"lobbyUpdate"},e)),!0)})}close(e){this._closing||this.signaling.receivedID===void 0||(this._closing=!0,this.emit("close",e),this.id!==""&&this.signaling.send({type:"close",id:this.id,reason:e!=null?e:"normal closure"}),this.peers.forEach(n=>n.close(e)),this.signaling.close(),typeof window!="undefined"&&window.removeEventListener("unload",this.unloadListener))}send(e,n,i){var l;if(!(e in this.dataChannels))throw new Error("unknown channel "+e);this.peers.has(n)&&((l=this.peers.get(n))==null||l.send(e,i))}broadcast(e,n){if(!(e in this.dataChannels))throw new Error("unknown channel "+e);this.peers.forEach(i=>i.send(e,n))}_addPeer(e,n){return w(this,null,function*(){var h;let i=yield this.credentials.fillCredentials(this.rtcConfig);i.iceServers=(h=i.iceServers)==null?void 0:h.filter(o=>!(o.urls.includes("turn:")&&o.username===void 0));let l=new T(this,this.signaling,e,i,n);this.peers.set(e,l)})}_removePeer(e){return this.peers.delete(e.id)}_prefetchTURNCredentials(){this.credentials.fillCredentials(this.rtcConfig).catch(()=>{})}_onSignalingError(e){this.emit("signalingerror",e),this.listenerCount("signalingerror")===0&&console.error("signallingerror not handled:",e),this.signaling.event("signaling","error",{error:JSON.stringify(e)})}_forceReconnectSignaling(){this.signaling.close()}get id(){var e;return(e=this.signaling.receivedID)!=null?e:""}get closing(){return this._closing}get size(){return this.peers.size}get currentLobby(){return this.signaling.currentLobby}get currentLobbyInfo(){return this.signaling.currentLobbyInfo}get currentLeader(){return this.signaling.currentLeader}},V="wss://netlib.poki.io/v0/signaling",z={iceServers:[{urls:["stun:stun.l.google.com:19302"]},{urls:b}]},F={reliable:{ordered:!0},unreliable:{ordered:!0,maxRetransmits:0},control:{ordered:!1}}});var N=ie(G()),B,pe=(B=N.default)!=null?B:N;window.netlib=pe;
//# sourceMappingURL=netlib.bundle.mjs.map</script>
<script>ï»¿// seedrandom.js version 2.2.
// Author: David Bau
// Date: 2013 Jun 15
//
// Defines a method Math.seedrandom() that, when called, substitutes
// an explicitly seeded RC4-based algorithm for Math.random(). Also
// supports automatic seeding from local or network sources of entropy.
//
// http://davidbau.com/encode/seedrandom.js
// http://davidbau.com/encode/seedrandom-min.js
//
// Usage:
//
// <script src=http://davidbau.com/encode/seedrandom-min.js></script>
//
// Math.seedrandom('yay.'); Sets Math.random to a function that is
// initialized using the given explicit seed.
//
// Math.seedrandom(); Sets Math.random to a function that is
// seeded using the current time, dom state,
// and other accumulated local entropy.
// The generated seed string is returned.
//
// Math.seedrandom('yowza.', true);
// Seeds using the given explicit seed mixed
// together with accumulated entropy.
//
// <script src="https://jsonlib.appspot.com/urandom?callback=Math.seedrandom">
// </script> Seeds using urandom bits from a server.
//
// More advanced examples:
//
// Math.seedrandom("hello."); // Use "hello." as the seed.
// document.write(Math.random()); // Always 0.9282578795792454
// document.write(Math.random()); // Always 0.3752569768646784
// var rng1 = Math.random; // Remember the current prng.
//
// var autoseed = Math.seedrandom(); // New prng with an automatic seed.
// document.write(Math.random()); // Pretty much unpredictable x.
//
// Math.random = rng1; // Continue "hello." prng sequence.
// document.write(Math.random()); // Always 0.7316977468919549
//
// Math.seedrandom(autoseed); // Restart at the previous seed.
// document.write(Math.random()); // Repeat the 'unpredictable' x.
//
// function reseed(event, count) { // Define a custom entropy collector.
// var t = [];
// function w(e) {
// t.push([e.pageX, e.pageY, +new Date]);
// if (t.length < count) { return; }
// document.removeEventListener(event, w);
// Math.seedrandom(t, true); // Mix in any previous entropy.
// }
// document.addEventListener(event, w);
// }
// reseed('mousemove', 100); // Reseed after 100 mouse moves.
//
// Version notes:
//
// The random number sequence is the same as version 1.0 for string seeds.
// Version 2.0 changed the sequence for non-string seeds.
// Version 2.1 speeds seeding and uses window.crypto to autoseed if present.
// Version 2.2 alters non-crypto autoseeding to sweep up entropy from plugins.
//
// The standard ARC4 key scheduler cycles short keys, which means that
// seedrandom('ab') is equivalent to seedrandom('abab') and 'ababab'.
// Therefore it is a good idea to add a terminator to avoid trivial
// equivalences on short string seeds, e.g., Math.seedrandom(str + '\0').
// Starting with version 2.0, a terminator is added automatically for
// non-string seeds, so seeding with the number 111 is the same as seeding
// with '111\0'.
//
// When seedrandom() is called with zero args, it uses a seed
// drawn from the browser crypto object if present. If there is no
// crypto support, seedrandom() uses the current time, the native rng,
// and a walk of several DOM objects to collect a few bits of entropy.
//
// Each time the one- or two-argument forms of seedrandom are called,
// entropy from the passed seed is accumulated in a pool to help generate
// future seeds for the zero- and two-argument forms of seedrandom.
//
// On speed - This javascript implementation of Math.random() is about
// 3-10x slower than the built-in Math.random() because it is not native
// code, but that is typically fast enough. Some details (timings on
// Chrome 25 on a 2010 vintage macbook):
//
// seeded Math.random() - avg less than 0.0002 milliseconds per call
// seedrandom('explicit.') - avg less than 0.2 milliseconds per call
// seedrandom('explicit.', true) - avg less than 0.2 milliseconds per call
// seedrandom() with crypto - avg less than 0.2 milliseconds per call
//
// Autoseeding without crypto is somewhat slower, about 20-30 milliseconds on
// a 2012 windows 7 1.5ghz i5 laptop, as seen on Firefox 19, IE 10, and Opera.
// Seeded rng calls themselves are fast across these browsers, with slowest
// numbers on Opera at about 0.0005 ms per seeded Math.random().
//
// LICENSE (BSD):
//
// Copyright 2013 David Bau, all rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
// 1. Redistributions of source code must retain the above copyright
// notice, this list of conditions and the following disclaimer.
//
// 2. Redistributions in binary form must reproduce the above copyright
// notice, this list of conditions and the following disclaimer in the
// documentation and/or other materials provided with the distribution.
//
// 3. Neither the name of this module nor the names of its contributors may
// be used to endorse or promote products derived from this software
// without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
/**
* All code is in an anonymous closure to keep the global namespace clean.
*/
(function (
    global, pool, math, width, chunks, digits) {

//
// The following constants are related to IEEE 754 limits.
//
var startdenom = math.pow(width, chunks),
    significance = math.pow(2, digits),
    overflow = significance * 2,
    mask = width - 1;

//
// seedrandom()
// This is the seedrandom function described above.
//
math['seedrandom'] = function(seed, use_entropy) {
  var key = [];

  // Flatten the seed string or build one from local entropy if needed.
  var shortseed = mixkey(flatten(
    use_entropy ? [seed, tostring(pool)] :
    0 in arguments ? seed : autoseed(), 3), key);

  // Use the seed to initialize an ARC4 generator.
  var arc4 = new ARC4(key);

  // Mix the randomness into accumulated entropy.
  mixkey(tostring(arc4.S), pool);

  // Override Math.random

  // This function returns a random double in [0, 1) that contains
  // randomness in every bit of the mantissa of the IEEE 754 value.

  math['random'] = function() { // Closure to return a random double:
    var n = arc4.g(chunks), // Start with a numerator n < 2 ^ 48
        d = startdenom, // and denominator d = 2 ^ 48.
        x = 0; // and no 'extra last byte'.
    while (n < significance) { // Fill up all significant digits by
      n = (n + x) * width; // shifting numerator and
      d *= width; // denominator and generating a
      x = arc4.g(1); // new least-significant-byte.
    }
    while (n >= overflow) { // To avoid rounding up, before adding
      n /= 2; // last byte, shift everything
      d /= 2; // right using integer math until
      x >>>= 1; // we have exactly the desired bits.
    }
    return (n + x) / d; // Form the number within [0, 1).
  };

  // Return the seed that was used
  return shortseed;
};

//
// ARC4
//
// An ARC4 implementation. The constructor takes a key in the form of
// an array of at most (width) integers that should be 0 <= x < (width).
//
// The g(count) method returns a pseudorandom integer that concatenates
// the next (count) outputs from ARC4. Its return value is a number x
// that is in the range 0 <= x < (width ^ count).
//
/** @constructor */
function ARC4(key) {
  var t, keylen = key.length,
      me = this, i = 0, j = me.i = me.j = 0, s = me.S = [];

  // The empty key [] is treated as [0].
  if (!keylen) { key = [keylen++]; }

  // Set up S using the standard key scheduling algorithm.
  while (i < width) {
    s[i] = i++;
  }
  for (i = 0; i < width; i++) {
    s[i] = s[j = mask & (j + key[i % keylen] + (t = s[i]))];
    s[j] = t;
  }

  // The "g" method returns the next (count) outputs as one number.
  (me.g = function(count) {
    // Using instance members instead of closure state nearly doubles speed.
    var t, r = 0,
        i = me.i, j = me.j, s = me.S;
    while (count--) {
      t = s[i = mask & (i + 1)];
      r = r * width + s[mask & ((s[i] = s[j = mask & (j + t)]) + (s[j] = t))];
    }
    me.i = i; me.j = j;
    return r;
    // For robust unpredictability discard an initial batch of values.
    // See http://www.rsa.com/rsalabs/node.asp?id=2009
  })(width);
}

//
// flatten()
// Converts an object tree to nested arrays of strings.
//
function flatten(obj, depth) {
  var result = [], typ = (typeof obj)[0], prop;
  if (depth && typ == 'o') {
    for (prop in obj) {
      try { result.push(flatten(obj[prop], depth - 1)); } catch (e) {}
    }
  }
  return (result.length ? result : typ == 's' ? obj : obj + '\0');
}

//
// mixkey()
// Mixes a string seed into a key that is an array of integers, and
// returns a shortened string seed that is equivalent to the result key.
//
function mixkey(seed, key) {
  var stringseed = seed + '', smear, j = 0;
  while (j < stringseed.length) {
    key[mask & j] =
      mask & ((smear ^= key[mask & j] * 19) + stringseed.charCodeAt(j++));
  }
  return tostring(key);
}

//
// autoseed()
// Returns an object for autoseeding, using window.crypto if available.
//
/** @param {Uint8Array=} seed */
function autoseed(seed) {
  try {
    global.crypto.getRandomValues(seed = new Uint8Array(width));
    return tostring(seed);
  } catch (e) {
    return [+new Date, global, global.navigator.plugins,
            global.screen, tostring(pool)];
  }
}

//
// tostring()
// Converts an array of charcodes to a string
//
function tostring(a) {
  return String.fromCharCode.apply(0, a);
}

//
// When seedrandom.js is loaded, we immediately mix a few bits
// from the built-in RNG into the entropy pool. Because we do
// not want to intefere with determinstic PRNG state later,
// seedrandom will not call math.random on its own again after
// initialization.
//
mixkey(math.random(), pool);

// End anonymous scope, and pass initial values.
})(
  this, // global window object
  [], // pool: entropy pool starts empty
  Math, // math: package containing random, pow, and seedrandom
  256, // width: each RC4 output is 0 <= x < 256
  6, // chunks: at least six RC4 outputs for each double
  52 // digits: there are 52 significant digits in a double
);</script>
<script>/*!
 * GSAP 3.3.4
 * https://greensock.com
 * 
 * @license Copyright 2020, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,function(e){"use strict";function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t){return"string"==typeof t}function o(t){return"function"==typeof t}function p(t){return"number"==typeof t}function q(t){return void 0===t}function r(t){return"object"==typeof t}function s(t){return!1!==t}function t(){return"undefined"!=typeof window}function u(t){return o(t)||n(t)}function K(t){return(l=pt(t,at))&&ie}function L(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")}function M(t,e){return!e&&console.warn(t)}function N(t,e){return t&&(at[t]=e)&&l&&(l[t]=e)||at}function O(){return 0}function Y(t){var e,i,n=t[0];if(r(n)||o(n)||(t=[t]),!(e=(n._gsap||{}).harness)){for(i=dt.length;i--&&!dt[i].targetTest(n););e=dt[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new Ft(t[i],e)))||t.splice(i,1);return t}function Z(t){return t._gsap||Y(yt(t))[0]._gsap}function $(t,e){var r=t[e];return o(r)?t[e]():q(r)&&t.getAttribute(e)||r}function _(t,e){return(t=t.split(",")).forEach(e)||t}function aa(t){return Math.round(1e5*t)/1e5||0}function ba(t,e){for(var r=e.length,i=0;t.indexOf(e[i])<0&&++i<r;);return i<r}function ca(t,e,r){var i,n=p(t[1]),a=(n?2:1)+(e<2?0:1),o=t[a];if(n&&(o.duration=t[1]),o.parent=r,e){for(i=o;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=s(r.vars.inherit)&&r.parent;o.immediateRender=s(i.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return o}function da(){var t,e,r=ot.length,i=ot.slice(0);for(ut={},t=ot.length=0;t<r;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)}function ea(t,e,r,i){ot.length&&da(),t.render(e,r,i),ot.length&&da()}function fa(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(nt).length<2?e:t}function ga(t){return t}function ha(t,e){for(var r in e)r in t||(t[r]=e[r]);return t}function ia(t,e){for(var r in e)r in t||"duration"===r||"ease"===r||(t[r]=e[r])}function ka(t,e){for(var i in e)t[i]=r(e[i])?ka(t[i]||(t[i]={}),e[i]):e[i];return t}function la(t,e){var r,i={};for(r in t)r in e||(i[r]=t[r]);return i}function ma(t){var e=t.parent||F,r=t.keyframes?ia:ha;if(s(t.inherit))for(;e;)r(t,e.vars.defaults),e=e.parent||e._dp;return t}function pa(t,e,r,i){void 0===r&&(r="_first"),void 0===i&&(i="_last");var n=e._prev,a=e._next;n?n._next=a:t[r]===e&&(t[r]=a),a?a._prev=n:t[i]===e&&(t[i]=n),e._next=e._prev=e.parent=null}function qa(t,e){!t.parent||e&&!t.parent.autoRemoveChildren||t.parent.remove(t),t._act=0}function ra(t){for(var e=t;e;)e._dirty=1,e=e.parent;return t}function ua(t){return t._repeat?_t(t._tTime,t=t.duration()+t._rDelay)*t:0}function wa(t,e){return(t-e._start)*e._ts+(0<=e._ts?0:e._dirty?e.totalDuration():e._tDur)}function xa(t){return t._end=aa(t._start+(t._tDur/Math.abs(t._ts||t._rts||B)||0))}function ya(t,e){var r;if((e._time||e._initted&&!e._dur)&&(r=wa(t.rawTime(),e),(!e._dur||gt(0,e.totalDuration(),r)-e._tTime>B)&&e.render(r,!0)),ra(t)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(r=t;r._dp;)0<=r.rawTime()&&r.totalTime(r._tTime),r=r._dp;t._zTime=-B}}function za(t,e,r,i){return e.parent&&qa(e),e._start=aa(r+e._delay),e._end=aa(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),function _addLinkedListItem(t,e,r,i,n){void 0===r&&(r="_first"),void 0===i&&(i="_last");var a,s=t[i];if(n)for(a=e[n];s&&s[n]>a;)s=s._prev;s?(e._next=s._next,s._next=e):(e._next=t[r],t[r]=e),e._next?e._next._prev=e:t[i]=e,e._prev=s,e.parent=e._dp=t}(t,e,"_first","_last",t._sort?"_start":0),t._recent=e,i||ya(t,e),t}function Aa(t,e){return(at.ScrollTrigger||L("scrollTrigger",e))&&at.ScrollTrigger.create(e,t)}function Ba(t,e,r,i){return qt(t,e),t._initted?!r&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&d!==Mt.frame?(ot.push(t),t._lazy=[e,i],1):void 0:1}function Ea(t,e,r){var i=t._repeat,n=aa(e)||0;return t._dur=n,t._tDur=i?i<0?1e10:aa(n*(i+1)+t._rDelay*i):n,t._time>n&&(t._time=n,t._tTime=Math.min(t._tTime,t._tDur)),r||ra(t.parent),t.parent&&xa(t),t}function Fa(t){return t instanceof Bt?ra(t):Ea(t,t._dur)}function Ha(t,e){var r,i,a=t.labels,s=t._recent||mt,o=t.duration()>=E?s.endTime(!1):t._dur;return n(e)&&(isNaN(e)||e in a)?"<"===(r=e.charAt(0))||">"===r?("<"===r?s._start:s.endTime(0<=s._repeat))+(parseFloat(e.substr(1))||0):(r=e.indexOf("="))<0?(e in a||(a[e]=o),a[e]):(i=+(e.charAt(r-1)+e.substr(r+1)),1<r?Ha(t,e.substr(0,r-1))+i:o+i):null==e?o:+e}function Ia(t,e){return t||0===t?e(t):e}function Ka(t){return(t+"").substr((parseFloat(t)+"").length)}function Na(t,e){return t&&r(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&r(t[0]))&&!t.nodeType&&t!==i}function Qa(t){return t.sort(function(){return.5-Math.random()})}function Ra(t){if(o(t))return t;var p=r(t)?t:{each:t},_=zt(p.ease),m=p.from||0,g=parseFloat(p.base)||0,v={},e=0<m&&m<1,y=isNaN(m)||e,T=p.axis,b=m,w=m;return n(m)?b=w={center:.5,edges:.5,end:1}[m]||0:!e&&y&&(b=m[0],w=m[1]),function(t,e,r){var i,n,a,s,o,u,h,l,f,d=(r||p).length,c=v[d];if(!c){if(!(f="auto"===p.grid?0:(p.grid||[1,E])[1])){for(h=-E;h<(h=r[f++].getBoundingClientRect().left)&&f<d;);f--}for(c=v[d]=[],i=y?Math.min(f,d)*b-.5:m%f,n=y?d*w/f-.5:m/f|0,l=E,u=h=0;u<d;u++)a=u%f-i,s=n-(u/f|0),c[u]=o=T?Math.abs("y"===T?s:a):V(a*a+s*s),h<o&&(h=o),o<l&&(l=o);"random"===m&&Qa(c),c.max=h-l,c.min=l,c.v=d=(parseFloat(p.amount)||parseFloat(p.each)*(d<f?d-1:T?"y"===T?d/f:f:Math.max(f,d/f))||0)*("edges"===m?-1:1),c.b=d<0?g-d:g,c.u=Ka(p.amount||p.each)||0,_=_&&d<0?At(_):_}return d=(c[t]-c.min)/c.max||0,aa(c.b+(_?_(d):d)*c.v)+c.u}}function Sa(e){var r=e<1?Math.pow(10,(e+"").length-2):1;return function(t){return Math.floor(Math.round(parseFloat(t)/e)*e*r)/r+(p(t)?0:Ka(t))}}function Ta(u,t){var h,l,e=W(u);return!e&&r(u)&&(h=e=u.radius||E,u.values?(u=yt(u.values),(l=!p(u[0]))&&(h*=h)):u=Sa(u.increment)),Ia(t,e?o(u)?function(t){return l=u(t),Math.abs(l-t)<=h?l:t}:function(t){for(var e,r,i=parseFloat(l?t.x:t),n=parseFloat(l?t.y:0),a=E,s=0,o=u.length;o--;)(e=l?(e=u[o].x-i)*e+(r=u[o].y-n)*r:Math.abs(u[o]-i))<a&&(a=e,s=o);return s=!h||a<=h?u[s]:t,l||s===t||p(t)?s:s+Ka(t)}:Sa(u))}function Ua(t,e,r,i){return Ia(W(t)?!e:!0===r?!!(r=0):!i,function(){return W(t)?t[~~(Math.random()*t.length)]:(r=r||1e-5)&&(i=r<1?Math.pow(10,(r+"").length-2):1)&&Math.floor(Math.round((t+Math.random()*(e-t))/r)*r*i)/i})}function Ya(e,r,t){return Ia(t,function(t){return e[~~r(t)]})}function _a(t){for(var e,r,i,n,a=0,s="";~(e=t.indexOf("random(",a));)i=t.indexOf(")",e),n="["===t.charAt(e+7),r=t.substr(e+7,i-e-7).match(n?nt:G),s+=t.substr(a,e-a)+Ua(n?r:+r[0],+r[1],+r[2]||1e-5),a=i+1;return s+t.substr(a,t.length-a)}function cb(t,e,r){var i,n,a,s=t.labels,o=E;for(i in s)(n=s[i]-e)<0==!!r&&n&&o>(n=Math.abs(n))&&(a=i,o=n);return a}function eb(t){return qa(t),t.progress()<1&&bt(t,"onInterrupt"),t}function jb(t,e,r){return(6*(t=t<0?t+1:1<t?t-1:t)<1?e+(r-e)*t*6:t<.5?r:3*t<2?e+(r-e)*(2/3-t)*6:e)*wt+.5|0}function kb(t,e,r){var i,n,a,s,o,u,h,l,f,d,c=t?p(t)?[t>>16,t>>8&wt,t&wt]:0:xt.black;if(!c){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),xt[t])c=xt[t];else if("#"===t.charAt(0))4===t.length&&(t="#"+(i=t.charAt(1))+i+(n=t.charAt(2))+n+(a=t.charAt(3))+a),c=[(t=parseInt(t.substr(1),16))>>16,t>>8&wt,t&wt];else if("hsl"===t.substr(0,3))if(c=d=t.match(G),e){if(~t.indexOf("="))return c=t.match(J),r&&c.length<4&&(c[3]=1),c}else s=+c[0]%360/360,o=c[1]/100,i=2*(u=c[2]/100)-(n=u<=.5?u*(o+1):u+o-u*o),3<c.length&&(c[3]*=1),c[0]=jb(s+1/3,i,n),c[1]=jb(s,i,n),c[2]=jb(s-1/3,i,n);else c=t.match(G)||xt.transparent;c=c.map(Number)}return e&&!d&&(i=c[0]/wt,n=c[1]/wt,a=c[2]/wt,u=((h=Math.max(i,n,a))+(l=Math.min(i,n,a)))/2,h===l?s=o=0:(f=h-l,o=.5<u?f/(2-h-l):f/(h+l),s=h===i?(n-a)/f+(n<a?6:0):h===n?(a-i)/f+2:(i-n)/f+4,s*=60),c[0]=~~(s+.5),c[1]=~~(100*o+.5),c[2]=~~(100*u+.5)),r&&c.length<4&&(c[3]=1),c}function lb(t){var r=[],i=[],n=-1;return t.split(kt).forEach(function(t){var e=t.match(tt)||[];r.push.apply(r,e),i.push(n+=e.length+1)}),r.c=i,r}function mb(t,e,r){var i,n,a,s,o="",u=(t+o).match(kt),h=e?"hsla(":"rgba(",l=0;if(!u)return t;if(u=u.map(function(t){return(t=kb(t,e,1))&&h+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),r&&(a=lb(t),(i=r.c).join(o)!==a.c.join(o)))for(s=(n=t.replace(kt,"1").split(tt)).length-1;l<s;l++)o+=n[l]+(~i.indexOf(l)?u.shift()||h+"0,0,0,0)":(a.length?a:u.length?u:r).shift());if(!n)for(s=(n=t.split(kt)).length-1;l<s;l++)o+=n[l]+u[l];return o+n[s]}function pb(t){var e,r=t.join(" ");if(kt.lastIndex=0,kt.test(r))return e=Ot.test(r),t[1]=mb(t[1],e),t[0]=mb(t[0],e,lb(t[1])),!0}function xb(t){var e=(t+"").split("("),r=Ct[e[0]];return r&&1<e.length&&r.config?r.config.apply(null,~t.indexOf("{")?[function _parseObjectInString(t){for(var e,r,i,n={},a=t.substr(1,t.length-3).split(":"),s=a[0],o=1,u=a.length;o<u;o++)r=a[o],e=o!==u-1?r.lastIndexOf(","):r.length,i=r.substr(0,e),n[s]=isNaN(i)?i.replace(Dt,"").trim():+i,s=r.substr(e+1).trim();return n}(e[1])]:rt.exec(t)[1].split(",").map(fa)):Ct._CE&&St.test(t)?Ct._CE("",t):r}function zb(t,e){for(var r,i=t._first;i;)i instanceof Bt?zb(i,e):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===e||(i.timeline?zb(i.timeline,e):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=e)),i=i._next}function Bb(t,e,r,i){void 0===r&&(r=function easeOut(t){return 1-e(1-t)}),void 0===i&&(i=function easeInOut(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var n,a={easeIn:e,easeOut:r,easeInOut:i};return _(t,function(t){for(var e in Ct[t]=at[t]=a,Ct[n=t.toLowerCase()]=r,a)Ct[n+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Ct[t+"."+e]=a[e]}),a}function Cb(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}}function Db(r,t,e){function el(t){return 1===t?1:i*Math.pow(2,-10*t)*Q((t-a)*n)+1}var i=1<=t?t:1,n=(e||(r?.3:.45))/(t<1?t:1),a=n/I*(Math.asin(1/i)||0),s="out"===r?el:"in"===r?function(t){return 1-el(1-t)}:Cb(el);return n=I/n,s.config=function(t,e){return Db(r,t,e)},s}function Eb(e,r){function ml(t){return t?--t*t*((r+1)*t+r)+1:0}void 0===r&&(r=1.70158);var t="out"===e?ml:"in"===e?function(t){return 1-ml(1-t)}:Cb(ml);return t.config=function(t){return Eb(e,t)},t}var F,i,a,h,l,f,d,c,m,g,v,y,T,b,w,x,k,P,C,S,D,A,z,U={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},R={duration:.5,overwrite:!1,delay:0},E=1e8,B=1/E,I=2*Math.PI,H=I/4,X=0,V=Math.sqrt,j=Math.cos,Q=Math.sin,W=Array.isArray,G=/(?:-?\.?\d|\.)+/gi,J=/[-+=.]*\d+[.e\-+]*\d*[e\-\+]*\d*/g,tt=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,et=/[-+=.]*\d+(?:\.|e-|e)*\d*/gi,rt=/\(([^()]+)\)/i,it=/[+-]=-?[\.\d]+/,nt=/[#\-+.]*\b[a-z\d-=+%.]+/gi,at={},st={},ot=[],ut={},ht={},lt={},ft=30,dt=[],ct="",pt=function _merge(t,e){for(var r in e)t[r]=e[r];return t},_t=function _animationCycle(t,e){return(t/=e)&&~~t===t?~~t-1:~~t},mt={_start:0,endTime:O},gt=function _clamp(t,e,r){return r<t?t:e<r?e:r},vt=[].slice,yt=function toArray(t,e){return!n(t)||e||!a&&Pt()?W(t)?function _flatten(t,e,r){return void 0===r&&(r=[]),t.forEach(function(t){return n(t)&&!e||Na(t,1)?r.push.apply(r,yt(t)):r.push(t)})||r}(t,e):Na(t)?vt.call(t,0):t?[t]:[]:vt.call(h.querySelectorAll(t),0)},Tt=function mapRange(e,t,r,i,n){var a=t-e,s=i-r;return Ia(n,function(t){return r+((t-e)/a*s||0)})},bt=function _callback(t,e,r){var i,n,a=t.vars,s=a[e];if(s)return i=a[e+"Params"],n=a.callbackScope||t,r&&ot.length&&da(),i?s.apply(n,i):s.call(n)},wt=255,xt={aqua:[0,wt,wt],lime:[0,wt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,wt],navy:[0,0,128],white:[wt,wt,wt],olive:[128,128,0],yellow:[wt,wt,0],orange:[wt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[wt,0,0],pink:[wt,192,203],cyan:[0,wt,wt],transparent:[wt,wt,wt,0]},kt=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in xt)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Ot=/hsl[a]?\(/,Mt=(b=Date.now,w=500,x=33,k=b(),P=k,S=C=1/240,T={time:0,frame:0,tick:function tick(){gk(!0)},wake:function wake(){f&&(!a&&t()&&(i=a=window,h=i.document||{},at.gsap=ie,(i.gsapVersions||(i.gsapVersions=[])).push(ie.version),K(l||i.GreenSockGlobals||!i.gsap&&i||{}),y=i.requestAnimationFrame),g&&T.sleep(),v=y||function(t){return setTimeout(t,1e3*(S-T.time)+1|0)},m=1,gk(2))},sleep:function sleep(){(y?i.cancelAnimationFrame:clearTimeout)(g),m=0,v=O},lagSmoothing:function lagSmoothing(t,e){w=t||1e8,x=Math.min(e,w,0)},fps:function fps(t){C=1/(t||240),S=T.time+C},add:function add(t){D.indexOf(t)<0&&D.push(t),Pt()},remove:function remove(t){var e;~(e=D.indexOf(t))&&D.splice(e,1)},_listeners:D=[]}),Pt=function _wake(){return!m&&Mt.wake()},Ct={},St=/^[\d.\-M][\d.\-,\s]/,Dt=/["']/g,At=function _invertEase(e){return function(t){return 1-e(1-t)}},zt=function _parseEase(t,e){return t&&(o(t)?t:Ct[t]||xb(t))||e};function gk(e){var t,r,i=b()-P,n=!0===e;w<i&&(k+=i-x),P+=i,T.time=(P-k)/1e3,(0<(t=T.time-S)||n)&&(T.frame++,S+=t+(C<=t?.004:C-t),r=1),n||(g=v(gk)),r&&D.forEach(function(t){return t(T.time,i,T.frame,e)})}function Dl(t){return t<z?A*t*t:t<.7272727272727273?A*Math.pow(t-1.5/2.75,2)+.75:t<.9090909090909092?A*(t-=2.25/2.75)*t+.9375:A*Math.pow(t-2.625/2.75,2)+.984375}_("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var r=e<5?e+1:e;Bb(t+",Power"+(r-1),e?function(t){return Math.pow(t,r)}:function(t){return t},function(t){return 1-Math.pow(1-t,r)},function(t){return t<.5?Math.pow(2*t,r)/2:1-Math.pow(2*(1-t),r)/2})}),Ct.Linear.easeNone=Ct.none=Ct.Linear.easeIn,Bb("Elastic",Db("in"),Db("out"),Db()),A=7.5625,z=1/2.75,Bb("Bounce",function(t){return 1-Dl(1-t)},Dl),Bb("Expo",function(t){return t?Math.pow(2,10*(t-1)):0}),Bb("Circ",function(t){return-(V(1-t*t)-1)}),Bb("Sine",function(t){return 1===t?1:1-j(t*H)}),Bb("Back",Eb("in"),Eb("out"),Eb()),Ct.SteppedEase=Ct.steps=at.SteppedEase={config:function config(t,e){void 0===t&&(t=1);var r=1/t,i=t+(e?0:1),n=e?1:0;return function(t){return((i*gt(0,.99999999,t)|0)+n)*r}}},R.ease=Ct["quad.out"],_("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return ct+=t+","+t+"Params,"});var Et,Ft=function GSCache(t,e){this.id=X++,(t._gsap=this).target=t,this.harness=e,this.get=e?e.get:$,this.set=e?e.getSetter:Zt},Rt=((Et=Animation.prototype).delay=function delay(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},Et.duration=function duration(t){return arguments.length?this.totalDuration(0<this._repeat?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},Et.totalDuration=function totalDuration(t){return arguments.length?(this._dirty=0,Ea(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},Et.totalTime=function totalTime(t,e){if(Pt(),!arguments.length)return this._tTime;var r=this.parent||this._dp;if(r&&r.smoothChildTiming&&this._ts){for(this._start=aa(r._time-(0<this._ts?t/this._ts:((this._dirty?this.totalDuration():this._tDur)-t)/-this._ts)),xa(this),r._dirty||ra(r);r.parent;)r.parent._time!==r._start+(0<=r._ts?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(0<this._ts&&t<this._tDur||this._ts<0&&0<t||!this._tDur&&!t)&&za(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===B||!t&&!this._initted)&&(this._ts||(this._pTime=t),ea(this,t,e)),this},Et.time=function time(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+ua(this))%this._dur||(t?this._dur:0),e):this._time},Et.totalProgress=function totalProgress(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},Et.progress=function progress(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+ua(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},Et.iteration=function iteration(t,e){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*r,e):this._repeat?_t(this._tTime,r)+1:1},Et.timeScale=function timeScale(t){if(!arguments.length)return this._rts===-B?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?wa(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||t===-B?0:this._rts,function _recacheAncestors(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t}(this.totalTime(gt(0,this._tDur,e),!0))},Et.paused=function paused(t){return arguments.length?(this._ps!==t&&((this._ps=t)?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Pt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=B)&&Math.abs(this._zTime)!==B))),this):this._ps},Et.startTime=function startTime(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return!e||!e._sort&&this.parent||za(e,this,t-this._delay),this}return this._start},Et.endTime=function endTime(t){return this._start+(s(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},Et.rawTime=function rawTime(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?wa(e.rawTime(t),this):this._tTime:this._tTime},Et.repeat=function repeat(t){return arguments.length?(this._repeat=t,Fa(this)):this._repeat},Et.repeatDelay=function repeatDelay(t){return arguments.length?(this._rDelay=t,Fa(this)):this._rDelay},Et.yoyo=function yoyo(t){return arguments.length?(this._yoyo=t,this):this._yoyo},Et.seek=function seek(t,e){return this.totalTime(Ha(this,t),s(e))},Et.restart=function restart(t,e){return this.play().totalTime(t?-this._delay:0,s(e))},Et.play=function play(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},Et.reverse=function reverse(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},Et.pause=function pause(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},Et.resume=function resume(){return this.paused(!1)},Et.reversed=function reversed(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-B:0)),this):this._rts<0},Et.invalidate=function invalidate(){return this._initted=0,this._zTime=-B,this},Et.isActive=function isActive(t){var e,r=this.parent||this._dp,i=this._start;return!(r&&!(this._ts&&(this._initted||!t)&&r.isActive(t)&&(e=r.rawTime(!0))>=i&&e<this.endTime(!0)-B))},Et.eventCallback=function eventCallback(t,e,r){var i=this.vars;return 1<arguments.length?(e?(i[t]=e,r&&(i[t+"Params"]=r),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},Et.then=function then(t){var i=this;return new Promise(function(e){function Sm(){var t=i.then;i.then=null,o(r)&&(r=r(i))&&(r.then||r===i)&&(i.then=t),e(r),i.then=t}var r=o(t)?t:ga;i._initted&&1===i.totalProgress()&&0<=i._ts||!i._tTime&&i._ts<0?Sm():i._prom=Sm})},Et.kill=function kill(){eb(this)},Animation);function Animation(t,e){var r=t.parent||F;this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ea(this,+t.duration,1),this.data=t.data,m||Mt.wake(),r&&za(r,this,e||0===e?e:r._time,1),t.reversed&&this.reverse(),t.paused&&this.paused(!0)}ha(Rt.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-B,_prom:0,_ps:!1,_rts:1});var Bt=function(i){function Timeline(t,e){var r;return void 0===t&&(t={}),(r=i.call(this,t,e)||this).labels={},r.smoothChildTiming=!!t.smoothChildTiming,r.autoRemoveChildren=!!t.autoRemoveChildren,r._sort=s(t.sortChildren),r.parent&&ya(r.parent,_assertThisInitialized(r)),t.scrollTrigger&&Aa(_assertThisInitialized(r),t.scrollTrigger),r}_inheritsLoose(Timeline,i);var t=Timeline.prototype;return t.to=function to(t,e,r,i){return new Ht(t,ca(arguments,0,this),Ha(this,p(e)?i:r)),this},t.from=function from(t,e,r,i){return new Ht(t,ca(arguments,1,this),Ha(this,p(e)?i:r)),this},t.fromTo=function fromTo(t,e,r,i,n){return new Ht(t,ca(arguments,2,this),Ha(this,p(e)?n:i)),this},t.set=function set(t,e,r){return e.duration=0,e.parent=this,ma(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Ht(t,e,Ha(this,r),1),this},t.call=function call(t,e,r){return za(this,Ht.delayedCall(0,t,e),Ha(this,r))},t.staggerTo=function staggerTo(t,e,r,i,n,a,s){return r.duration=e,r.stagger=r.stagger||i,r.onComplete=a,r.onCompleteParams=s,r.parent=this,new Ht(t,r,Ha(this,n)),this},t.staggerFrom=function staggerFrom(t,e,r,i,n,a,o){return r.runBackwards=1,ma(r).immediateRender=s(r.immediateRender),this.staggerTo(t,e,r,i,n,a,o)},t.staggerFromTo=function staggerFromTo(t,e,r,i,n,a,o,u){return i.startAt=r,ma(i).immediateRender=s(i.immediateRender),this.staggerTo(t,e,i,n,a,o,u)},t.render=function render(t,e,r){var i,n,a,s,o,u,h,l,f,d,c,p,_=this._time,m=this._dirty?this.totalDuration():this._tDur,g=this._dur,v=this!==F&&m-B<t&&0<=t?m:t<B?0:t,y=this._zTime<0!=t<0&&(this._initted||!g);if(v!==this._tTime||r||y){if(_!==this._time&&g&&(v+=this._time-_,t+=this._time-_),i=v,f=this._start,u=!(l=this._ts),y&&(g||(_=this._zTime),!t&&e||(this._zTime=t)),this._repeat&&(c=this._yoyo,o=g+this._rDelay,(g<(i=aa(v%o))||m===v)&&(i=g),(s=~~(v/o))&&s===v/o&&(i=g,s--),d=_t(this._tTime,o),!_&&this._tTime&&d!==s&&(d=s),c&&1&s&&(i=g-i,p=1),s!==d&&!this._lock)){var T=c&&1&d,b=T===(c&&1&s);if(s<d&&(T=!T),_=T?0:g,this._lock=1,this.render(_||(p?0:aa(s*o)),e,!g)._lock=0,!e&&this.parent&&bt(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),_!==this._time||u!=!this._ts)return this;if(b&&(this._lock=2,_=T?g+1e-4:-1e-4,this.render(_,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;zb(this,p)}if(this._hasPause&&!this._forcing&&this._lock<2&&(h=function _findNextPauseTween(t,e,r){var i;if(e<r)for(i=t._first;i&&i._start<=r;){if(!i._dur&&"isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=r;){if(!i._dur&&"isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,aa(_),aa(i)))&&(v-=i-(i=h._start)),this._tTime=v,this._time=i,this._act=!l,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t),_||!i||e||bt(this,"onStart"),_<=i&&0<=t)for(n=this._first;n;){if(a=n._next,(n._act||i>=n._start)&&n._ts&&h!==n){if(n.parent!==this)return this.render(t,e,r);if(n.render(0<n._ts?(i-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(i-n._start)*n._ts,e,r),i!==this._time||!this._ts&&!u){h=0,a&&(v+=this._zTime=-B);break}}n=a}else{n=this._last;for(var w=t<0?t:i;n;){if(a=n._prev,(n._act||w<=n._end)&&n._ts&&h!==n){if(n.parent!==this)return this.render(t,e,r);if(n.render(0<n._ts?(w-n._start)*n._ts:(n._dirty?n.totalDuration():n._tDur)+(w-n._start)*n._ts,e,r),i!==this._time||!this._ts&&!u){h=0,a&&(v+=this._zTime=w?-B:B);break}}n=a}}if(h&&!e&&(this.pause(),h.render(_<=i?0:-B)._zTime=_<=i?1:-1,this._ts))return this._start=f,xa(this),this.render(t,e,r);this._onUpdate&&!e&&bt(this,"onUpdate",!0),(v===m&&m>=this.totalDuration()||!v&&_)&&(f!==this._start&&Math.abs(l)===Math.abs(this._ts)||this._lock||(!t&&g||!(v===m&&0<this._ts||!v&&this._ts<0)||qa(this,1),e||t<0&&!_||!v&&!_||(bt(this,v===m?"onComplete":"onReverseComplete",!0),!this._prom||v<m&&0<this.timeScale()||this._prom())))}return this},t.add=function add(t,e){var r=this;if(p(e)||(e=Ha(this,e)),!(t instanceof Rt)){if(W(t))return t.forEach(function(t){return r.add(t,e)}),ra(this);if(n(t))return this.addLabel(t,e);if(!o(t))return this;t=Ht.delayedCall(0,t)}return this!==t?za(this,t,e):this},t.getChildren=function getChildren(t,e,r,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===r&&(r=!0),void 0===i&&(i=-E);for(var n=[],a=this._first;a;)a._start>=i&&(a instanceof Ht?e&&n.push(a):(r&&n.push(a),t&&n.push.apply(n,a.getChildren(!0,e,r)))),a=a._next;return n},t.getById=function getById(t){for(var e=this.getChildren(1,1,1),r=e.length;r--;)if(e[r].vars.id===t)return e[r]},t.remove=function remove(t){return n(t)?this.removeLabel(t):o(t)?this.killTweensOf(t):(pa(this,t),t===this._recent&&(this._recent=this._last),ra(this))},t.totalTime=function totalTime(t,e){return arguments.length?(this._forcing=1,this.parent||this._dp||!this._ts||(this._start=aa(Mt.time-(0<this._ts?t/this._ts:(this.totalDuration()-t)/-this._ts))),i.prototype.totalTime.call(this,t,e),this._forcing=0,this):this._tTime},t.addLabel=function addLabel(t,e){return this.labels[t]=Ha(this,e),this},t.removeLabel=function removeLabel(t){return delete this.labels[t],this},t.addPause=function addPause(t,e,r){var i=Ht.delayedCall(0,e||O,r);return i.data="isPause",this._hasPause=1,za(this,i,Ha(this,t))},t.removePause=function removePause(t){var e=this._first;for(t=Ha(this,t);e;)e._start===t&&"isPause"===e.data&&qa(e),e=e._next},t.killTweensOf=function killTweensOf(t,e,r){for(var i=this.getTweensOf(t,r),n=i.length;n--;)It!==i[n]&&i[n].kill(t,e);return this},t.getTweensOf=function getTweensOf(t,e){for(var r,i=[],n=yt(t),a=this._first;a;)a instanceof Ht?!ba(a._targets,n)||e&&!a.isActive("started"===e)||i.push(a):(r=a.getTweensOf(n,e)).length&&i.push.apply(i,r),a=a._next;return i},t.tweenTo=function tweenTo(t,e){e=e||{};var r=this,i=Ha(r,t),n=e.startAt,a=e.onStart,s=e.onStartParams,o=Ht.to(r,ha(e,{ease:"none",lazy:!1,time:i,duration:e.duration||Math.abs((i-(n&&"time"in n?n.time:r._time))/r.timeScale())||B,onStart:function onStart(){r.pause();var t=e.duration||Math.abs((i-r._time)/r.timeScale());o._dur!==t&&Ea(o,t).render(o._time,!0,!0),a&&a.apply(o,s||[])}}));return o},t.tweenFromTo=function tweenFromTo(t,e,r){return this.tweenTo(e,ha({startAt:{time:Ha(this,t)}},r))},t.recent=function recent(){return this._recent},t.nextLabel=function nextLabel(t){return void 0===t&&(t=this._time),cb(this,Ha(this,t))},t.previousLabel=function previousLabel(t){return void 0===t&&(t=this._time),cb(this,Ha(this,t),1)},t.currentLabel=function currentLabel(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+B)},t.shiftChildren=function shiftChildren(t,e,r){void 0===r&&(r=0);for(var i,n=this._first,a=this.labels;n;)n._start>=r&&(n._start+=t),n=n._next;if(e)for(i in a)a[i]>=r&&(a[i]+=t);return ra(this)},t.invalidate=function invalidate(){var t=this._first;for(this._lock=0;t;)t.invalidate(),t=t._next;return i.prototype.invalidate.call(this)},t.clear=function clear(t){void 0===t&&(t=!0);for(var e,r=this._first;r;)e=r._next,this.remove(r),r=e;return this._time=this._tTime=this._pTime=0,t&&(this.labels={}),ra(this)},t.totalDuration=function totalDuration(t){var e,r,i,n,a=0,s=this,o=s._last,u=E;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(n=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),u<(i=o._start)&&s._sort&&o._ts&&!s._lock?(s._lock=1,za(s,o,i-o._delay,1)._lock=0):u=i,i<0&&o._ts&&(a-=i,(!n&&!s._dp||n&&n.smoothChildTiming)&&(s._start+=i/s._ts,s._time-=i,s._tTime-=i),s.shiftChildren(-i,!1,-Infinity),u=0),a<(r=xa(o))&&o._ts&&(a=r),o=e;Ea(s,s===F&&s._time>a?s._time:a,1),s._dirty=0}return s._tDur},Timeline.updateRoot=function updateRoot(t){if(F._ts&&(ea(F,wa(t,F)),d=Mt.frame),Mt.frame>=ft){ft+=U.autoSleep||120;var e=F._first;if((!e||!e._ts)&&U.autoSleep&&Mt._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Mt.sleep()}}},Timeline}(Rt);ha(Bt.prototype,{_lock:0,_hasPause:0,_forcing:0});function Lb(t,e,i,a,s,u){var h,l,f,d;if(ht[t]&&!1!==(h=new ht[t]).init(s,h.rawVars?e[t]:function _processVars(t,e,i,a,s){if(o(t)&&(t=Yt(t,s,e,i,a)),!r(t)||t.style&&t.nodeType||W(t))return n(t)?Yt(t,s,e,i,a):t;var u,h={};for(u in t)h[u]=Yt(t[u],s,e,i,a);return h}(e[t],a,s,u,i),i,a,u)&&(i._pt=l=new ee(i._pt,s,t,0,1,h.render,h,0,h.priority),i!==c))for(f=i._ptLookup[i._targets.indexOf(s)],d=h._props.length;d--;)f[h._props[d]]=l;return h}var It,Lt=function _addPropTween(t,e,r,i,a,s,u,h,l){o(i)&&(i=i(a||0,t,s));var f,d=t[e],c="get"!==r?r:o(d)?l?t[e.indexOf("set")||!o(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():d,p=o(d)?l?jt:Vt:Xt;if(n(i)&&(~i.indexOf("random(")&&(i=_a(i)),"="===i.charAt(1)&&(i=parseFloat(c)+parseFloat(i.substr(2))*("-"===i.charAt(0)?-1:1)+(Ka(c)||0))),c!==i)return isNaN(c+i)?(d||e in t||L(e,i),function _addComplexStringPropTween(t,e,r,i,n,a,s){var o,u,h,l,f,d,c,p,_=new ee(this._pt,t,e,0,1,Wt,null,n),m=0,g=0;for(_.b=r,_.e=i,r+="",(c=~(i+="").indexOf("random("))&&(i=_a(i)),a&&(a(p=[r,i],t,e),r=p[0],i=p[1]),u=r.match(et)||[];o=et.exec(i);)l=o[0],f=i.substring(m,o.index),h?h=(h+1)%5:"rgba("===f.substr(-5)&&(h=1),l!==u[g++]&&(d=parseFloat(u[g-1])||0,_._pt={_next:_._pt,p:f||1===g?f:",",s:d,c:"="===l.charAt(1)?parseFloat(l.substr(2))*("-"===l.charAt(0)?-1:1):parseFloat(l)-d,m:h&&h<4?Math.round:0},m=et.lastIndex);return _.c=m<i.length?i.substring(m,i.length):"",_.fp=s,(it.test(i)||c)&&(_.e=0),this._pt=_}.call(this,t,e,c,i,p,h||U.stringFilter,l)):(f=new ee(this._pt,t,e,+c||0,i-(c||0),"boolean"==typeof d?Qt:Kt,0,p),l&&(f.fp=l),u&&f.modifier(u,this,t),this._pt=f)},qt=function _initTween(t,e){var r,i,n,a,o,u,h,l,f,d,c,p,_=t.vars,m=_.ease,g=_.startAt,v=_.immediateRender,y=_.lazy,T=_.onUpdate,b=_.onUpdateParams,w=_.callbackScope,x=_.runBackwards,k=_.yoyoEase,O=_.keyframes,M=_.autoRevert,P=t._dur,C=t._startAt,S=t._targets,D=t.parent,A=D&&"nested"===D.data?D.parent._targets:S,z="auto"===t._overwrite,E=t.timeline;if(!E||O&&m||(m="none"),t._ease=zt(m,R.ease),t._yEase=k?At(zt(!0===k?m:k,R.ease)):0,k&&t._yoyo&&!t._repeat&&(k=t._yEase,t._yEase=t._ease,t._ease=k),!E){if(p=(l=S[0]?Z(S[0]).harness:0)&&_[l.prop],r=la(_,st),C&&C.render(-1,!0).kill(),g){if(qa(t._startAt=Ht.set(S,ha({data:"isStart",overwrite:!1,parent:D,immediateRender:!0,lazy:s(y),startAt:null,delay:0,onUpdate:T,onUpdateParams:b,callbackScope:w,stagger:0},g))),v)if(0<e)M||(t._startAt=0);else if(P)return}else if(x&&P)if(C)M||(t._startAt=0);else if(e&&(v=!1),n=ha({overwrite:!1,data:"isFromStart",lazy:v&&s(y),immediateRender:v,stagger:0,parent:D},r),p&&(n[l.prop]=p),qa(t._startAt=Ht.set(S,n)),v){if(!e)return}else _initTween(t._startAt,B);for(t._pt=0,y=P&&s(y)||y&&!P,i=0;i<S.length;i++){if(h=(o=S[i])._gsap||Y(S)[i]._gsap,t._ptLookup[i]=d={},ut[h.id]&&da(),c=A===S?i:A.indexOf(o),l&&!1!==(f=new l).init(o,p||r,t,c,A)&&(t._pt=a=new ee(t._pt,o,f.name,0,1,f.render,f,0,f.priority),f._props.forEach(function(t){d[t]=a}),f.priority&&(u=1)),!l||p)for(n in r)ht[n]&&(f=Lb(n,r,t,c,o,A))?f.priority&&(u=1):d[n]=a=Lt.call(t,o,n,"get",r[n],c,A,0,_.stringFilter);t._op&&t._op[i]&&t.kill(o,t._op[i]),z&&t._pt&&(It=t,F.killTweensOf(o,d,"started"),It=0),t._pt&&y&&(ut[h.id]=1)}u&&te(t),t._onInit&&t._onInit(t)}t._from=!E&&!!_.runBackwards,t._onUpdate=T,t._initted=!!t.parent},Yt=function _parseFuncOrString(t,e,r,i,a){return o(t)?t.call(e,r,i,a):n(t)&&~t.indexOf("random(")?_a(t):t},Nt=ct+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",Ut=(Nt+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Ht=function(A){function Tween(t,e,i,n){var a;"number"==typeof e&&(i.duration=e,e=i,i=null);var o,h,l,f,d,c,_,m,g=(a=A.call(this,n?e:ma(e),i)||this).vars,v=g.duration,y=g.delay,T=g.immediateRender,b=g.stagger,w=g.overwrite,x=g.keyframes,k=g.defaults,P=g.scrollTrigger,C=g.yoyoEase,S=a.parent,D=(W(t)?p(t[0]):"length"in e)?[t]:yt(t);if(a._targets=D.length?Y(D):M("GSAP target "+t+" not found. https://greensock.com",!U.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=w,x||b||u(v)||u(y)){if(e=a.vars,(o=a.timeline=new Bt({data:"nested",defaults:k||{}})).kill(),o.parent=_assertThisInitialized(a),x)ha(o.vars.defaults,{ease:"none"}),x.forEach(function(t){return o.to(D,t,">")});else{if(f=D.length,_=b?Ra(b):O,r(b))for(d in b)~Nt.indexOf(d)&&((m=m||{})[d]=b[d]);for(h=0;h<f;h++){for(d in l={},e)Ut.indexOf(d)<0&&(l[d]=e[d]);l.stagger=0,C&&(l.yoyoEase=C),m&&pt(l,m),c=D[h],l.duration=+Yt(v,_assertThisInitialized(a),h,c,D),l.delay=(+Yt(y,_assertThisInitialized(a),h,c,D)||0)-a._delay,!b&&1===f&&l.delay&&(a._delay=y=l.delay,a._start+=y,l.delay=0),o.to(c,l,_(h,c,D))}o.duration()?v=y=0:a.timeline=0}v||a.duration(v=o.duration())}else a.timeline=0;return!0===w&&(It=_assertThisInitialized(a),F.killTweensOf(D),It=0),S&&ya(S,_assertThisInitialized(a)),(T||!v&&!x&&a._start===aa(S._time)&&s(T)&&function _hasNoPausedAncestors(t){return!t||t._ts&&_hasNoPausedAncestors(t.parent)}(_assertThisInitialized(a))&&"nested"!==S.data)&&(a._tTime=-B,a.render(Math.max(0,-y))),P&&Aa(_assertThisInitialized(a),P),a}_inheritsLoose(Tween,A);var t=Tween.prototype;return t.render=function render(t,e,r){var i,n,a,s,o,u,h,l,f,d=this._time,c=this._tDur,p=this._dur,_=c-B<t&&0<=t?c:t<B?0:t;if(p){if(_!==this._tTime||!t||r||this._startAt&&this._zTime<0!=t<0){if(i=_,l=this.timeline,this._repeat){if(s=p+this._rDelay,(p<(i=aa(_%s))||c===_)&&(i=p),(a=~~(_/s))&&a===_/s&&(i=p,a--),(u=this._yoyo&&1&a)&&(f=this._yEase,i=p-i),o=_t(this._tTime,s),i===d&&!r&&this._initted)return this;a!==o&&(l&&this._yEase&&zb(l,u),!this.vars.repeatRefresh||u||this._lock||(this._lock=r=1,this.render(aa(s*a),!0).invalidate()._lock=0))}if(!this._initted){if(Ba(this,i,r,e))return this._tTime=0,this;if(p!==this._dur)return this.render(t,e,r)}for(this._tTime=_,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(f||this._ease)(i/p),this._from&&(this.ratio=h=1-h),!i||d||e||bt(this,"onStart"),n=this._pt;n;)n.r(h,n.d),n=n._next;l&&l.render(t<0?t:!i&&u?-B:l._dur*h,e,r)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,r),bt(this,"onUpdate")),this._repeat&&a!==o&&this.vars.onRepeat&&!e&&this.parent&&bt(this,"onRepeat"),_!==this._tDur&&_||this._tTime!==_||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),!t&&p||!(_===this._tDur&&0<this._ts||!_&&this._ts<0)||qa(this,1),e||t<0&&!d||!_&&!d||(bt(this,_===c?"onComplete":"onReverseComplete",!0),!this._prom||_<c&&0<this.timeScale()||this._prom()))}}else!function _renderZeroDurationTween(t,e,r,i){var n,a,s=t.ratio,o=e<0||!e&&s&&!t._start&&t._zTime>B&&!t._dp._lock||t._ts<0||t._dp._ts<0?0:1,u=t._rDelay,h=0;if(u&&t._repeat&&(h=gt(0,t._tDur,e),_t(h,u)!==(a=_t(t._tTime,u))&&(s=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),t._initted||!Ba(t,e,i,r))if(o!==s||i||t._zTime===B||!e&&t._zTime){for(a=t._zTime,t._zTime=e||(r?B:0),r=r||e&&!a,t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,r||bt(t,"onStart"),n=t._pt;n;)n.r(o,n.d),n=n._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!r&&bt(t,"onUpdate"),h&&t._repeat&&!r&&t.parent&&bt(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&qa(t,1),r||(bt(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,r);return this},t.targets=function targets(){return this._targets},t.invalidate=function invalidate(){return this._pt=this._op=this._startAt=this._onUpdate=this._act=this._lazy=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),A.prototype.invalidate.call(this)},t.kill=function kill(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e)&&(this._lazy=0,this.parent))return eb(this);if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,It&&!0!==It.vars.overwrite)._first||eb(this),this.parent&&r!==this.timeline.totalDuration()&&Ea(this,this._dur*this.timeline._tDur/r),this}var i,a,s,o,u,h,l,f=this._targets,d=t?yt(t):f,c=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function _arraysMatch(t,e){for(var r=t.length,i=r===e.length;i&&r--&&t[r]===e[r];);return r<0}(f,d))return eb(this);for(i=this._op=this._op||[],"all"!==e&&(n(e)&&(u={},_(e,function(t){return u[t]=1}),e=u),e=function _addAliasesToVars(t,e){var r,i,n,a,s=t[0]?Z(t[0]).harness:0,o=s&&s.aliases;if(!o)return e;for(i in r=pt({},e),o)if(i in r)for(n=(a=o[i].split(",")).length;n--;)r[a[n]]=r[i];return r}(f,e)),l=f.length;l--;)if(~d.indexOf(f[l]))for(u in a=c[l],"all"===e?(i[l]=e,o=a,s={}):(s=i[l]=i[l]||{},o=e),o)(h=a&&a[u])&&("kill"in h.d&&!0!==h.d.kill(u)||pa(this,h,"_pt"),delete a[u]),"all"!==s&&(s[u]=1);return this._initted&&!this._pt&&p&&eb(this),this},Tween.to=function to(t,e,r){return new Tween(t,e,r)},Tween.from=function from(t,e){return new Tween(t,ca(arguments,1))},Tween.delayedCall=function delayedCall(t,e,r,i){return new Tween(e,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:e,onReverseComplete:e,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},Tween.fromTo=function fromTo(t,e,r){return new Tween(t,ca(arguments,2))},Tween.set=function set(t,e){return e.duration=0,e.repeatDelay||(e.repeat=0),new Tween(t,e)},Tween.killTweensOf=function killTweensOf(t,e,r){return F.killTweensOf(t,e,r)},Tween}(Rt);ha(Ht.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),_("staggerTo,staggerFrom,staggerFromTo",function(r){Ht[r]=function(){var t=new Bt,e=vt.call(arguments,0);return e.splice("staggerFromTo"===r?5:4,0,0),t[r].apply(t,e)}});function Wb(t,e,r){return t.setAttribute(e,r)}function cc(t,e,r,i){i.mSet(t,e,i.m.call(i.tween,r,i.mt),i)}var Xt=function _setterPlain(t,e,r){return t[e]=r},Vt=function _setterFunc(t,e,r){return t[e](r)},jt=function _setterFuncWithParam(t,e,r,i){return t[e](i.fp,r)},Zt=function _getSetter(t,e){return o(t[e])?Vt:q(t[e])&&t.setAttribute?Wb:Xt},Kt=function _renderPlain(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4,e)},Qt=function _renderBoolean(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Wt=function _renderComplexString(t,e){var r=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;r;)i=r.p+(r.m?r.m(r.s+r.c*t):Math.round(1e4*(r.s+r.c*t))/1e4)+i,r=r._next;i+=e.c}e.set(e.t,e.p,i,e)},Gt=function _renderPropTweens(t,e){for(var r=e._pt;r;)r.r(t,r.d),r=r._next},$t=function _addPluginModifier(t,e,r,i){for(var n,a=this._pt;a;)n=a._next,a.p===i&&a.modifier(t,e,r),a=n},Jt=function _killPropTweensOf(t){for(var e,r,i=this._pt;i;)r=i._next,i.p===t&&!i.op||i.op===t?pa(this,i,"_pt"):i.dep||(e=1),i=r;return!e},te=function _sortPropTweensByPriority(t){for(var e,r,i,n,a=t._pt;a;){for(e=a._next,r=i;r&&r.pr>a.pr;)r=r._next;(a._prev=r?r._prev:n)?a._prev._next=a:i=a,(a._next=r)?r._prev=a:n=a,a=e}t._pt=i},ee=(PropTween.prototype.modifier=function modifier(t,e,r){this.mSet=this.mSet||this.set,this.set=cc,this.m=t,this.mt=r,this.tween=e},PropTween);function PropTween(t,e,r,i,n,a,s,o,u){this.t=e,this.s=i,this.c=n,this.p=r,this.r=a||Kt,this.d=s||this,this.set=o||Xt,this.pr=u||0,(this._next=t)&&(t._prev=this)}_(ct+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return st[t]=1}),at.TweenMax=at.TweenLite=Ht,at.TimelineLite=at.TimelineMax=Bt,F=new Bt({sortChildren:!1,defaults:R,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),U.stringFilter=pb;var re={registerPlugin:function registerPlugin(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e.forEach(function(t){return function _createPlugin(t){var e=(t=!t.name&&t.default||t).name,r=o(t),i=e&&!r&&t.init?function(){this._props=[]}:t,n={init:O,render:Gt,add:Lt,kill:Jt,modifier:$t,rawVars:0},a={targetTest:0,get:0,getSetter:Zt,aliases:{},register:0};if(Pt(),t!==i){if(ht[e])return;ha(i,ha(la(t,n),a)),pt(i.prototype,pt(n,la(t,a))),ht[i.prop=e]=i,t.targetTest&&(dt.push(i),st[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}N(e,i),t.register&&t.register(ie,i,ee)}(t)})},timeline:function timeline(t){return new Bt(t)},getTweensOf:function getTweensOf(t,e){return F.getTweensOf(t,e)},getProperty:function getProperty(i,t,e,r){n(i)&&(i=yt(i)[0]);var a=Z(i||{}).get,s=e?ga:fa;return"native"===e&&(e=""),i?t?s((ht[t]&&ht[t].get||a)(i,t,e,r)):function(t,e,r){return s((ht[t]&&ht[t].get||a)(i,t,e,r))}:i},quickSetter:function quickSetter(r,e,i){if(1<(r=yt(r)).length){var n=r.map(function(t){return ie.quickSetter(t,e,i)}),a=n.length;return function(t){for(var e=a;e--;)n[e](t)}}r=r[0]||{};var s=ht[e],o=Z(r),u=o.harness&&(o.harness.aliases||{})[e]||e,h=s?function(t){var e=new s;c._pt=0,e.init(r,i?t+i:t,c,0,[r]),e.render(1,e),c._pt&&Gt(1,c)}:o.set(r,u);return s?h:function(t){return h(r,u,i?t+i:t,o,1)}},isTweening:function isTweening(t){return 0<F.getTweensOf(t,!0).length},defaults:function defaults(t){return t&&t.ease&&(t.ease=zt(t.ease,R.ease)),ka(R,t||{})},config:function config(t){return ka(U,t||{})},registerEffect:function registerEffect(t){var n=t.name,i=t.effect,e=t.plugins,a=t.defaults,s=t.extendTimeline;(e||"").split(",").forEach(function(t){return t&&!ht[t]&&!at[t]&&M(n+" effect requires "+t+" plugin.")}),lt[n]=function(t,e,r){return i(yt(t),ha(e||{},a),r)},s&&(Bt.prototype[n]=function(t,e,i){return this.add(lt[n](t,r(e)?e:(i=e)&&{},this),i)})},registerEase:function registerEase(t,e){Ct[t]=zt(e)},parseEase:function parseEase(t,e){return arguments.length?zt(t,e):Ct},getById:function getById(t){return F.getById(t)},exportRoot:function exportRoot(t,e){void 0===t&&(t={});var r,i,n=new Bt(t);for(n.smoothChildTiming=s(t.smoothChildTiming),F.remove(n),n._dp=0,n._time=n._tTime=F._time,r=F._first;r;)i=r._next,!e&&!r._dur&&r instanceof Ht&&r.vars.onComplete===r._targets[0]||za(n,r,r._start-r._delay),r=i;return za(F,n,0),n},utils:{wrap:function wrap(e,t,r){var i=t-e;return W(e)?Ya(e,wrap(0,e.length),t):Ia(r,function(t){return(i+(t-e)%i)%i+e})},wrapYoyo:function wrapYoyo(e,t,r){var i=t-e,n=2*i;return W(e)?Ya(e,wrapYoyo(0,e.length-1),t):Ia(r,function(t){return e+(i<(t=(n+(t-e)%n)%n||0)?n-t:t)})},distribute:Ra,random:Ua,snap:Ta,normalize:function normalize(t,e,r){return Tt(t,e,0,1,r)},getUnit:Ka,clamp:function clamp(e,r,t){return Ia(t,function(t){return gt(e,r,t)})},splitColor:kb,toArray:yt,mapRange:Tt,pipe:function pipe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(t){return e.reduce(function(t,e){return e(t)},t)}},unitize:function unitize(e,r){return function(t){return e(parseFloat(t))+(r||Ka(t))}},interpolate:function interpolate(e,r,t,i){var a=isNaN(e+r)?0:function(t){return(1-t)*e+t*r};if(!a){var s,o,u,h,l,f=n(e),d={};if(!0===t&&(i=1)&&(t=null),f)e={p:e},r={p:r};else if(W(e)&&!W(r)){for(u=[],h=e.length,l=h-2,o=1;o<h;o++)u.push(interpolate(e[o-1],e[o]));h--,a=function func(t){t*=h;var e=Math.min(l,~~t);return u[e](t-e)},t=r}else i||(e=pt(W(e)?[]:{},e));if(!u){for(s in r)Lt.call(d,e,s,"get",r[s]);a=function func(t){return Gt(t,d)||(f?e.p:e)}}}return Ia(t,a)},shuffle:Qa},install:K,effects:lt,ticker:Mt,updateRoot:Bt.updateRoot,plugins:ht,globalTimeline:F,core:{PropTween:ee,globals:N,Tween:Ht,Timeline:Bt,Animation:Rt,getCache:Z,_removeLinkedListItem:pa}};_("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return re[t]=Ht[t]}),Mt.add(Bt.updateRoot),c=re.to({},{duration:0});function gc(t,e){for(var r=t._pt;r&&r.p!==e&&r.op!==e&&r.fp!==e;)r=r._next;return r}function ic(t,a){return{name:t,rawVars:1,init:function init(t,i,e){e._onInit=function(t){var e,r;if(n(i)&&(e={},_(i,function(t){return e[t]=1}),i=e),a){for(r in e={},i)e[r]=a(i[r]);i=e}!function _addModifiers(t,e){var r,i,n,a=t._targets;for(r in e)for(i=a.length;i--;)(n=(n=t._ptLookup[i][r])&&n.d)&&(n._pt&&(n=gc(n,r)),n&&n.modifier&&n.modifier(e[r],t,a[i],r))}(t,i)}}}}var ie=re.registerPlugin({name:"attr",init:function init(t,e,r,i,n){var a,s;for(a in e)(s=this.add(t,"setAttribute",(t.getAttribute(a)||0)+"",e[a],i,n,0,0,a))&&(s.op=a),this._props.push(a)}},{name:"endArray",init:function init(t,e){for(var r=e.length;r--;)this.add(t,r,t[r]||0,e[r])}},ic("roundProps",Sa),ic("modifiers"),ic("snap",Ta))||re;Ht.version=Bt.version=ie.version="3.3.4",f=1,t()&&Pt();function Tc(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)}function Uc(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)}function Vc(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)}function Wc(t,e){var r=e.s+e.c*t;e.set(e.t,e.p,~~(r+(r<0?-.5:.5))+e.u,e)}function Xc(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)}function Yc(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)}function Zc(t,e,r){return t.style[e]=r}function $c(t,e,r){return t.style.setProperty(e,r)}function _c(t,e,r){return t._gsap[e]=r}function ad(t,e,r){return t._gsap.scaleX=t._gsap.scaleY=r}function bd(t,e,r,i,n){var a=t._gsap;a.scaleX=a.scaleY=r,a.renderTransform(n,a)}function cd(t,e,r,i,n){var a=t._gsap;a[e]=r,a.renderTransform(n,a)}function gd(t,e){var r=ae.createElementNS?ae.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ae.createElement(t);return r.style?r:ae.createElement(t)}function hd(t,e,r){var i=getComputedStyle(t);return i[e]||i.getPropertyValue(e.replace(Fe,"-$1").toLowerCase())||i.getPropertyValue(e)||!r&&hd(t,Ne(e)||e,1)||""}function kd(){(function _windowExists(){return"undefined"!=typeof window})()&&window.document&&(ne=window,ae=ne.document,se=ae.documentElement,ue=gd("div")||{style:{}},he=gd("div"),Le=Ne(Le),qe=Ne(qe),ue.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",fe=!!Ne("perspective"),oe=1)}function ld(t){var e,r=gd("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,n=this.nextSibling,a=this.style.cssText;if(se.appendChild(r),r.appendChild(this),this.style.display="block",t)try{e=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=ld}catch(t){}else this._gsapBBox&&(e=this._gsapBBox());return i&&(n?i.insertBefore(this,n):i.appendChild(this)),se.removeChild(r),this.style.cssText=a,e}function md(t,e){for(var r=e.length;r--;)if(t.hasAttribute(e[r]))return t.getAttribute(e[r])}function nd(e){var r;try{r=e.getBBox()}catch(t){r=ld.call(e,!0)}return r&&(r.width||r.height)||e.getBBox===ld||(r=ld.call(e,!0)),!r||r.width||r.x||r.y?r:{x:+md(e,["x","cx","x1"])||0,y:+md(e,["y","cy","y1"])||0,width:0,height:0}}function od(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!nd(t))}function pd(t,e){if(e){var r=t.style;e in De&&(e=Le),r.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),r.removeProperty(e.replace(Fe,"-$1").toLowerCase())):r.removeAttribute(e)}}function qd(t,e,r,i,n,a){var s=new ee(t._pt,e,r,0,1,a?Yc:Xc);return(t._pt=s).b=i,s.e=n,t._props.push(r),s}function sd(t,e,r,i){var n,a,s,o,u=parseFloat(r)||0,h=(r+"").trim().substr((u+"").length)||"px",l=ue.style,f=Re.test(e),d="svg"===t.tagName.toLowerCase(),c=(d?"client":"offset")+(f?"Width":"Height"),p="px"===i,_="%"===i;return i===h||!u||Ue[i]||Ue[h]?u:("px"===h||p||(u=sd(t,e,r,"px")),o=t.getCTM&&od(t),_&&(De[e]||~e.indexOf("adius"))?aa(u/(o?t.getBBox()[f?"width":"height"]:t[c])*100):(l[f?"width":"height"]=100+(p?h:i),a=~e.indexOf("adius")||"em"===i&&t.appendChild&&!d?t:t.parentNode,o&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==ae&&a.appendChild||(a=ae.body),(s=a._gsap)&&_&&s.width&&f&&s.time===Mt.time?aa(u/s.width*100):(!_&&"%"!==h||(l.position=hd(t,"position")),a===t&&(l.position="static"),a.appendChild(ue),n=ue[c],a.removeChild(ue),l.position="absolute",f&&_&&((s=Z(a)).time=Mt.time,s.width=a[c]),aa(p?n*u/100:n&&u?100/n*u:0))))}function td(t,e,r,i){var n;return oe||kd(),e in Ie&&"transform"!==e&&~(e=Ie[e]).indexOf(",")&&(e=e.split(",")[0]),De[e]&&"transform"!==e?(n=Ze(t,i),n="transformOrigin"!==e?n[e]:Ke(hd(t,qe))+" "+n.zOrigin+"px"):(n=t.style[e])&&"auto"!==n&&!i&&!~(n+"").indexOf("calc(")||(n=Xe[e]&&Xe[e](t,e,r)||hd(t,e)||$(t,e)||("opacity"===e?1:0)),r&&!~(n+"").indexOf(" ")?sd(t,e,n,r)+r:n}function ud(t,e,r,i){if(!r||"none"===r){var n=Ne(e,t,1),a=n&&hd(t,n,1);a&&a!==r&&(e=n,r=a)}var s,o,u,h,l,f,d,c,p,_,m,g,v=new ee(this._pt,t.style,e,0,1,Wt),y=0,T=0;if(v.b=r,v.e=i,r+="","auto"===(i+="")&&(t.style[e]=i,i=hd(t,e)||i,t.style[e]=r),pb(s=[r,i]),i=s[1],u=(r=s[0]).match(tt)||[],(i.match(tt)||[]).length){for(;o=tt.exec(i);)d=o[0],p=i.substring(y,o.index),l?l=(l+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(l=1),d!==(f=u[T++]||"")&&(h=parseFloat(f)||0,m=f.substr((h+"").length),(g="="===d.charAt(1)?+(d.charAt(0)+"1"):0)&&(d=d.substr(2)),c=parseFloat(d),_=d.substr((c+"").length),y=tt.lastIndex-_.length,_||(_=_||U.units[e]||m,y===i.length&&(i+=_,v.e+=_)),m!==_&&(h=sd(t,e,f,_)||0),v._pt={_next:v._pt,p:p||1===T?p:",",s:h,c:g?g*c:c-h,m:l&&l<4?Math.round:0});v.c=y<i.length?i.substring(y,i.length):""}else v.r="display"===e&&"none"===i?Yc:Xc;return it.test(i)&&(v.e=0),this._pt=v}function wd(t){var e=t.split(" "),r=e[0],i=e[1]||"50%";return"top"!==r&&"bottom"!==r&&"left"!==i&&"right"!==i||(t=r,r=i,i=t),e[0]=He[r]||r,e[1]=He[i]||i,e.join(" ")}function xd(t,e){if(e.tween&&e.tween._time===e.tween._dur){var r,i,n,a=e.t,s=a.style,o=e.u,u=a._gsap;if("all"===o||!0===o)s.cssText="",i=1;else for(n=(o=o.split(",")).length;-1<--n;)r=o[n],De[r]&&(i=1,r="transformOrigin"===r?qe:Le),pd(a,r);i&&(pd(a,Le),u&&(u.svg&&a.removeAttribute("transform"),Ze(a,1),u.uncache=1))}}function Bd(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t}function Cd(t){var e=hd(t,Le);return Bd(e)?Ve:e.substr(7).match(J).map(aa)}function Dd(t,e){var r,i,n,a,s=t._gsap||Z(t),o=t.style,u=Cd(t);return s.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(u=[(n=t.transform.baseVal.consolidate().matrix).a,n.b,n.c,n.d,n.e,n.f]).join(",")?Ve:u:(u!==Ve||t.offsetParent||t===se||s.svg||(n=o.display,o.display="block",(r=t.parentNode)&&t.offsetParent||(a=1,i=t.nextSibling,se.appendChild(t)),u=Cd(t),n?o.display=n:pd(t,"display"),a&&(i?r.insertBefore(t,i):r?r.appendChild(t):se.removeChild(t))),e&&6<u.length?[u[0],u[1],u[4],u[5],u[12],u[13]]:u)}function Ed(t,e,r,i,n,a){var s,o,u,h=t._gsap,l=n||Dd(t,!0),f=h.xOrigin||0,d=h.yOrigin||0,c=h.xOffset||0,p=h.yOffset||0,_=l[0],m=l[1],g=l[2],v=l[3],y=l[4],T=l[5],b=e.split(" "),w=parseFloat(b[0])||0,x=parseFloat(b[1])||0;r?l!==Ve&&(o=_*v-m*g)&&(u=w*(-m/o)+x*(_/o)-(_*T-m*y)/o,w=w*(v/o)+x*(-g/o)+(g*T-v*y)/o,x=u):(w=(s=nd(t)).x+(~b[0].indexOf("%")?w/100*s.width:w),x=s.y+(~(b[1]||b[0]).indexOf("%")?x/100*s.height:x)),i||!1!==i&&h.smooth?(y=w-f,T=x-d,h.xOffset=c+(y*_+T*g)-y,h.yOffset=p+(y*m+T*v)-T):h.xOffset=h.yOffset=0,h.xOrigin=w,h.yOrigin=x,h.smooth=!!i,h.origin=e,h.originIsAbsolute=!!r,t.style[qe]="0px 0px",a&&(qd(a,h,"xOrigin",f,w),qd(a,h,"yOrigin",d,x),qd(a,h,"xOffset",c,h.xOffset),qd(a,h,"yOffset",p,h.yOffset)),t.setAttribute("data-svg-origin",w+" "+x)}function Hd(t,e,r){var i=Ka(e);return aa(parseFloat(e)+parseFloat(sd(t,"x",r+"px",i)))+i}function Od(t,e,r,i,a,s){var o,u,h=360,l=n(a),f=parseFloat(a)*(l&&~a.indexOf("rad")?Ae:1),d=s?f*s:f-i,c=i+d+"deg";return l&&("short"===(o=a.split("_")[1])&&(d%=h)!==d%180&&(d+=d<0?h:-h),"cw"===o&&d<0?d=(d+36e9)%h-~~(d/h)*h:"ccw"===o&&0<d&&(d=(d-36e9)%h-~~(d/h)*h)),t._pt=u=new ee(t._pt,e,r,i,d,Uc),u.e=c,u.u="deg",t._props.push(r),u}function Pd(t,e,r){var i,n,a,s,o,u,h,l=he.style,f=r._gsap;for(n in l.cssText=getComputedStyle(r).cssText+";position:absolute;display:block;",l[Le]=e,ae.body.appendChild(he),i=Ze(he,1),De)(a=f[n])!==(s=i[n])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(n)<0&&(o=Ka(a)!==(h=Ka(s))?sd(r,n,a,h):parseFloat(a),u=parseFloat(s),t._pt=new ee(t._pt,f,n,o,u-o,Tc),t._pt.u=h||0,t._props.push(n));ae.body.removeChild(he)}var ne,ae,se,oe,ue,he,le,fe,de=Ct.Power0,ce=Ct.Power1,pe=Ct.Power2,_e=Ct.Power3,me=Ct.Power4,ge=Ct.Linear,ve=Ct.Quad,ye=Ct.Cubic,Te=Ct.Quart,be=Ct.Quint,we=Ct.Strong,xe=Ct.Elastic,ke=Ct.Back,Oe=Ct.SteppedEase,Me=Ct.Bounce,Pe=Ct.Sine,Ce=Ct.Expo,Se=Ct.Circ,De={},Ae=180/Math.PI,ze=Math.PI/180,Ee=Math.atan2,Fe=/([A-Z])/g,Re=/(?:left|right|width|margin|padding|x)/i,Be=/[\s,\(]\S/,Ie={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Le="transform",qe=Le+"Origin",Ye="O,Moz,ms,Ms,Webkit".split(","),Ne=function _checkPropPrefix(t,e,r){var i=(e||ue).style,n=5;if(t in i&&!r)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);n--&&!(Ye[n]+t in i););return n<0?null:(3===n?"ms":0<=n?Ye[n]:"")+t},Ue={deg:1,rad:1,turn:1},He={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Xe={clearProps:function clearProps(t,e,r,i,n){if("isFromStart"!==n.data){var a=t._pt=new ee(t._pt,e,r,0,0,xd);return a.u=i,a.pr=-10,a.tween=n,t._props.push(r),1}}},Ve=[1,0,0,1,0,0],je={},Ze=function _parseTransform(t,e){var r=t._gsap||new Ft(t);if("x"in r&&!e&&!r.uncache)return r;var i,n,a,s,o,u,h,l,f,d,c,p,_,m,g,v,y,T,b,w,x,k,O,M,P,C,S,D,A,z,E,F,R=t.style,B=r.scaleX<0,I="deg",L=hd(t,qe)||"0";return i=n=a=u=h=l=f=d=c=0,s=o=1,r.svg=!(!t.getCTM||!od(t)),m=Dd(t,r.svg),r.svg&&(M=!r.uncache&&t.getAttribute("data-svg-origin"),Ed(t,M||L,!!M||r.originIsAbsolute,!1!==r.smooth,m)),p=r.xOrigin||0,_=r.yOrigin||0,m!==Ve&&(T=m[0],b=m[1],w=m[2],x=m[3],i=k=m[4],n=O=m[5],6===m.length?(s=Math.sqrt(T*T+b*b),o=Math.sqrt(x*x+w*w),u=T||b?Ee(b,T)*Ae:0,(f=w||x?Ee(w,x)*Ae+u:0)&&(o*=Math.cos(f*ze)),r.svg&&(i-=p-(p*T+_*w),n-=_-(p*b+_*x))):(F=m[6],z=m[7],S=m[8],D=m[9],A=m[10],E=m[11],i=m[12],n=m[13],a=m[14],h=(g=Ee(F,A))*Ae,g&&(M=k*(v=Math.cos(-g))+S*(y=Math.sin(-g)),P=O*v+D*y,C=F*v+A*y,S=k*-y+S*v,D=O*-y+D*v,A=F*-y+A*v,E=z*-y+E*v,k=M,O=P,F=C),l=(g=Ee(-w,A))*Ae,g&&(v=Math.cos(-g),E=x*(y=Math.sin(-g))+E*v,T=M=T*v-S*y,b=P=b*v-D*y,w=C=w*v-A*y),u=(g=Ee(b,T))*Ae,g&&(M=T*(v=Math.cos(g))+b*(y=Math.sin(g)),P=k*v+O*y,b=b*v-T*y,O=O*v-k*y,T=M,k=P),h&&359.9<Math.abs(h)+Math.abs(u)&&(h=u=0,l=180-l),s=aa(Math.sqrt(T*T+b*b+w*w)),o=aa(Math.sqrt(O*O+F*F)),g=Ee(k,O),f=2e-4<Math.abs(g)?g*Ae:0,c=E?1/(E<0?-E:E):0),r.svg&&(M=t.getAttribute("transform"),r.forceCSS=t.setAttribute("transform","")||!Bd(hd(t,Le)),M&&t.setAttribute("transform",M))),90<Math.abs(f)&&Math.abs(f)<270&&(B?(s*=-1,f+=u<=0?180:-180,u+=u<=0?180:-180):(o*=-1,f+=f<=0?180:-180)),r.x=((r.xPercent=i&&Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)?0:i)+"px",r.y=((r.yPercent=n&&Math.round(t.offsetHeight/2)===Math.round(-n)?-50:0)?0:n)+"px",r.z=a+"px",r.scaleX=aa(s),r.scaleY=aa(o),r.rotation=aa(u)+I,r.rotationX=aa(h)+I,r.rotationY=aa(l)+I,r.skewX=f+I,r.skewY=d+I,r.transformPerspective=c+"px",(r.zOrigin=parseFloat(L.split(" ")[2])||0)&&(R[qe]=Ke(L)),r.xOffset=r.yOffset=0,r.force3D=U.force3D,r.renderTransform=r.svg?tr:fe?Je:Qe,r.uncache=0,r},Ke=function _firstTwoOnly(t){return(t=t.split(" "))[0]+" "+t[1]},Qe=function _renderNon3DTransforms(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Je(t,e)},We="0deg",Ge="0px",$e=") ",Je=function _renderCSSTransforms(t,e){var r=e||this,i=r.xPercent,n=r.yPercent,a=r.x,s=r.y,o=r.z,u=r.rotation,h=r.rotationY,l=r.rotationX,f=r.skewX,d=r.skewY,c=r.scaleX,p=r.scaleY,_=r.transformPerspective,m=r.force3D,g=r.target,v=r.zOrigin,y="",T="auto"===m&&t&&1!==t||!0===m;if(v&&(l!==We||h!==We)){var b,w=parseFloat(h)*ze,x=Math.sin(w),k=Math.cos(w);w=parseFloat(l)*ze,b=Math.cos(w),a=Hd(g,a,x*b*-v),s=Hd(g,s,-Math.sin(w)*-v),o=Hd(g,o,k*b*-v+v)}_!==Ge&&(y+="perspective("+_+$e),(i||n)&&(y+="translate("+i+"%, "+n+"%) "),!T&&a===Ge&&s===Ge&&o===Ge||(y+=o!==Ge||T?"translate3d("+a+", "+s+", "+o+") ":"translate("+a+", "+s+$e),u!==We&&(y+="rotate("+u+$e),h!==We&&(y+="rotateY("+h+$e),l!==We&&(y+="rotateX("+l+$e),f===We&&d===We||(y+="skew("+f+", "+d+$e),1===c&&1===p||(y+="scale("+c+", "+p+$e),g.style[Le]=y||"translate(0, 0)"},tr=function _renderSVGTransforms(t,e){var r,i,n,a,s,o=e||this,u=o.xPercent,h=o.yPercent,l=o.x,f=o.y,d=o.rotation,c=o.skewX,p=o.skewY,_=o.scaleX,m=o.scaleY,g=o.target,v=o.xOrigin,y=o.yOrigin,T=o.xOffset,b=o.yOffset,w=o.forceCSS,x=parseFloat(l),k=parseFloat(f);d=parseFloat(d),c=parseFloat(c),(p=parseFloat(p))&&(c+=p=parseFloat(p),d+=p),d||c?(d*=ze,c*=ze,r=Math.cos(d)*_,i=Math.sin(d)*_,n=Math.sin(d-c)*-m,a=Math.cos(d-c)*m,c&&(p*=ze,s=Math.tan(c-p),n*=s=Math.sqrt(1+s*s),a*=s,p&&(s=Math.tan(p),r*=s=Math.sqrt(1+s*s),i*=s)),r=aa(r),i=aa(i),n=aa(n),a=aa(a)):(r=_,a=m,i=n=0),(x&&!~(l+"").indexOf("px")||k&&!~(f+"").indexOf("px"))&&(x=sd(g,"x",l,"px"),k=sd(g,"y",f,"px")),(v||y||T||b)&&(x=aa(x+v-(v*r+y*n)+T),k=aa(k+y-(v*i+y*a)+b)),(u||h)&&(s=g.getBBox(),x=aa(x+u/100*s.width),k=aa(k+h/100*s.height)),s="matrix("+r+","+i+","+n+","+a+","+x+","+k+")",g.setAttribute("transform",s),w&&(g.style[Le]=s)};_("padding,margin,Width,Radius",function(e,r){var t="Right",i="Bottom",n="Left",o=(r<3?["Top",t,i,n]:["Top"+n,"Top"+t,i+t,i+n]).map(function(t){return r<2?e+t:"border"+t+e});Xe[1<r?"border"+e:e]=function(e,t,r,i,n){var a,s;if(arguments.length<4)return a=o.map(function(t){return td(e,t,r)}),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(i+"").split(" "),s={},o.forEach(function(t,e){return s[t]=a[e]=a[e]||a[(e-1)/2|0]}),e.init(t,s,n)}});var er,rr,ir,nr={name:"css",register:kd,targetTest:function targetTest(t){return t.style&&t.nodeType},init:function init(t,e,r,i,n){var a,s,o,u,h,l,f,d,c,p,_,m,g,v,y,T=this._props,b=t.style;for(f in oe||kd(),e)if("autoRound"!==f&&(s=e[f],!ht[f]||!Lb(f,e,r,i,t,n)))if(h=typeof s,l=Xe[f],"function"===h&&(h=typeof(s=s.call(r,i,t,n))),"string"===h&&~s.indexOf("random(")&&(s=_a(s)),l)l(this,t,f,s,r)&&(y=1);else if("--"===f.substr(0,2))this.add(b,"setProperty",getComputedStyle(t).getPropertyValue(f)+"",s+"",i,n,0,0,f);else{if(a=td(t,f),u=parseFloat(a),(p="string"===h&&"="===s.charAt(1)?+(s.charAt(0)+"1"):0)&&(s=s.substr(2)),o=parseFloat(s),f in Ie&&("autoAlpha"===f&&(1===u&&"hidden"===td(t,"visibility")&&o&&(u=0),qd(this,b,"visibility",u?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==f&&"transform"!==f&&~(f=Ie[f]).indexOf(",")&&(f=f.split(",")[0])),_=f in De)if(m||((g=t._gsap).renderTransform||Ze(t),v=!1!==e.smoothOrigin&&g.smooth,(m=this._pt=new ee(this._pt,b,Le,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===f)this._pt=new ee(this._pt,g,"scaleY",g.scaleY,p?p*o:o-g.scaleY),T.push("scaleY",f),f+="X";else{if("transformOrigin"===f){s=wd(s),g.svg?Ed(t,s,0,v,0,this):((c=parseFloat(s.split(" ")[2])||0)!==g.zOrigin&&qd(this,g,"zOrigin",g.zOrigin,c),qd(this,b,f,Ke(a),Ke(s)));continue}if("svgOrigin"===f){Ed(t,s,1,v,0,this);continue}if(f in je){Od(this,g,f,u,s,p);continue}if("smoothOrigin"===f){qd(this,g,"smooth",g.smooth,s);continue}if("force3D"===f){g[f]=s;continue}if("transform"===f){Pd(this,s,t);continue}}else f in b||(f=Ne(f)||f);if(_||(o||0===o)&&(u||0===u)&&!Be.test(s)&&f in b)(d=(a+"").substr((u+"").length))!==(c=(s+"").substr(((o=o||0)+"").length)||(f in U.units?U.units[f]:d))&&(u=sd(t,f,a,c)),this._pt=new ee(this._pt,_?g:b,f,u,p?p*o:o-u,"px"!==c||!1===e.autoRound||_?Tc:Wc),this._pt.u=c||0,d!==c&&(this._pt.b=a,this._pt.r=Vc);else if(f in b)ud.call(this,t,f,a,s);else{if(!(f in t)){L(f,s);continue}this.add(t,f,t[f],s,i,n)}T.push(f)}y&&te(this)},get:td,aliases:Ie,getSetter:function getSetter(t,e,r){var i=Ie[e];return i&&i.indexOf(",")<0&&(e=i),e in De&&e!==qe&&(t._gsap.x||td(t,"x"))?r&&le===r?"scale"===e?ad:_c:(le=r||{})&&("scale"===e?bd:cd):t.style&&!q(t.style[e])?Zc:~e.indexOf("-")?$c:Zt(t,e)},core:{_removeProperty:pd,_getMatrix:Dd}};ie.utils.checkPrefix=Ne,ir=_((er="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(rr="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){De[t]=1}),_(rr,function(t){U.units[t]="deg",je[t]=1}),Ie[ir[13]]=er+","+rr,_("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");Ie[e[1]]=ir[e[0]]}),_("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){U.units[t]="px"}),ie.registerPlugin(nr);var ar=ie.registerPlugin(nr)||ie,sr=ar.core.Tween;e.Back=ke,e.Bounce=Me,e.CSSPlugin=nr,e.Circ=Se,e.Cubic=ye,e.Elastic=xe,e.Expo=Ce,e.Linear=ge,e.Power0=de,e.Power1=ce,e.Power2=pe,e.Power3=_e,e.Power4=me,e.Quad=ve,e.Quart=Te,e.Quint=be,e.Sine=Pe,e.SteppedEase=Oe,e.Strong=we,e.TimelineLite=Bt,e.TimelineMax=Bt,e.TweenLite=Ht,e.TweenMax=sr,e.default=ar,e.gsap=ar;if (typeof(window)==="undefined"||window!==e){Object.defineProperty(e,"__esModule",{value:!0})} else {delete e.default}});

</script>
<script>/*! howler.js v2.2.4 | (c) 2013-2020, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var o=this||n;if(e=parseFloat(e),o.ctx||_(),void 0!==e&&e>=0&&e<=1){if(o._volume=e,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var t=0;t<o._howls.length;t++)if(!o._howls[t]._webAudio)for(var r=o._howls[t]._getSoundIds(),a=0;a<r.length;a++){var u=o._howls[t]._soundById(r[a]);u&&u._node&&(u._node.volume=u._volume*e)}return o}return o._volume},mute:function(e){var o=this||n;o.ctx||_(),o._muted=e,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(e?0:o._volume,n.ctx.currentTime);for(var t=0;t<o._howls.length;t++)if(!o._howls[t]._webAudio)for(var r=o._howls[t]._getSoundIds(),a=0;a<r.length;a++){var u=o._howls[t]._soundById(r[a]);u&&u._node&&(u._node.muted=!!e||u._muted)}return o},stop:function(){for(var e=this||n,o=0;o<e._howls.length;o++)e._howls[o].stop();return e},unload:function(){for(var e=this||n,o=e._howls.length-1;o>=0;o--)e._howls[o].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,_()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx?e.ctx.state||"suspended":"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{var o=new Audio;void 0===o.oncanplaythrough&&(e._canPlayEvent="canplay")}catch(n){e.noAudio=!0}else e.noAudio=!0;try{var o=new Audio;o.muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,o=null;try{o="undefined"!=typeof Audio?new Audio:null}catch(n){return e}if(!o||"function"!=typeof o.canPlayType)return e;var t=o.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",a=r.match(/OPR\/(\d+)/g),u=a&&parseInt(a[0].split("/")[1],10)<33,d=-1!==r.indexOf("Safari")&&-1===r.indexOf("Chrome"),i=r.match(/Version\/(.*?) /),_=d&&i&&parseInt(i[1],10)<15;return e._codecs={mp3:!(u||!t&&!o.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!t,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(_||!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(_||!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||n;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var o=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var t=new Audio;t._unlocked=!0,e._releaseHtml5Audio(t)}catch(n){e.noAudio=!0;break}for(var r=0;r<e._howls.length;r++)if(!e._howls[r]._webAudio)for(var a=e._howls[r]._getSoundIds(),u=0;u<a.length;u++){var d=e._howls[r]._soundById(a[u]);d&&d._node&&!d._node._unlocked&&(d._node._unlocked=!0,d._node.load())}e._autoResume();var i=e.ctx.createBufferSource();i.buffer=e._scratchBuffer,i.connect(e.ctx.destination),void 0===i.start?i.noteOn(0):i.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),i.onended=function(){i.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),e}},_obtainHtml5Audio:function(){var e=this||n;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var o=(new Audio).play();return o&&"undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var o=this||n;return e._unlocked&&o._html5AudioPool.push(e),o},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var o=0;o<e._howls.length;o++)if(e._howls[o]._webAudio)for(var t=0;t<e._howls[o]._sounds.length;t++)if(!e._howls[o]._sounds[t]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var n=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(n,n)}},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then(function(){e.state="running";for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,o=function(e){var n=this;if(!e.src||0===e.src.length)return void console.error("An array of source files must be passed with any new Howl.");n.init(e)};o.prototype={init:function(e){var o=this;return n.ctx||_(),o._autoplay=e.autoplay||!1,o._format="string"!=typeof e.format?e.format:[e.format],o._html5=e.html5||!1,o._muted=e.mute||!1,o._loop=e.loop||!1,o._pool=e.pool||5,o._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,o._rate=e.rate||1,o._sprite=e.sprite||{},o._src="string"!=typeof e.src?e.src:[e.src],o._volume=void 0!==e.volume?e.volume:1,o._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=e.onend?[{fn:e.onend}]:[],o._onfade=e.onfade?[{fn:e.onfade}]:[],o._onload=e.onload?[{fn:e.onload}]:[],o._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],o._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],o._onpause=e.onpause?[{fn:e.onpause}]:[],o._onplay=e.onplay?[{fn:e.onplay}]:[],o._onstop=e.onstop?[{fn:e.onstop}]:[],o._onmute=e.onmute?[{fn:e.onmute}]:[],o._onvolume=e.onvolume?[{fn:e.onvolume}]:[],o._onrate=e.onrate?[{fn:e.onrate}]:[],o._onseek=e.onseek?[{fn:e.onseek}]:[],o._onunlock=e.onunlock?[{fn:e.onunlock}]:[],o._onresume=[],o._webAudio=n.usingWebAudio&&!o._html5,void 0!==n.ctx&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&"none"!==o._preload&&o.load(),o},load:function(){var e=this,o=null;if(n.noAudio)return void e._emit("loaderror",null,"No audio support.");"string"==typeof e._src&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var u,d;if(e._format&&e._format[r])u=e._format[r];else{if("string"!=typeof(d=e._src[r])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}u=/^data:audio\/([^;,]+);/i.exec(d),u||(u=/\.([^.]+)$/.exec(d.split("?",1)[0])),u&&(u=u[1].toLowerCase())}if(u||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),u&&n.codecs(u)){o=e._src[r];break}}return o?(e._src=o,e._state="loading","https:"===window.location.protocol&&"http:"===o.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new t(e),e._webAudio&&a(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")},play:function(e,o){var t=this,r=null;if("number"==typeof e)r=e,e=null;else{if("string"==typeof e&&"loaded"===t._state&&!t._sprite[e])return null;if(void 0===e&&(e="__default",!t._playLock)){for(var a=0,u=0;u<t._sounds.length;u++)t._sounds[u]._paused&&!t._sounds[u]._ended&&(a++,r=t._sounds[u]._id);1===a?e=null:r=null}}var d=r?t._soundById(r):t._inactiveSound();if(!d)return null;if(r&&!e&&(e=d._sprite||"__default"),"loaded"!==t._state){d._sprite=e,d._ended=!1;var i=d._id;return t._queue.push({event:"play",action:function(){t.play(i)}}),i}if(r&&!d._paused)return o||t._loadQueue("play"),d._id;t._webAudio&&n._autoResume();var _=Math.max(0,d._seek>0?d._seek:t._sprite[e][0]/1e3),s=Math.max(0,(t._sprite[e][0]+t._sprite[e][1])/1e3-_),l=1e3*s/Math.abs(d._rate),c=t._sprite[e][0]/1e3,f=(t._sprite[e][0]+t._sprite[e][1])/1e3;d._sprite=e,d._ended=!1;var p=function(){d._paused=!1,d._seek=_,d._start=c,d._stop=f,d._loop=!(!d._loop&&!t._sprite[e][2])};if(_>=f)return void t._ended(d);var m=d._node;if(t._webAudio){var v=function(){t._playLock=!1,p(),t._refreshBuffer(d);var e=d._muted||t._muted?0:d._volume;m.gain.setValueAtTime(e,n.ctx.currentTime),d._playStart=n.ctx.currentTime,void 0===m.bufferSource.start?d._loop?m.bufferSource.noteGrainOn(0,_,86400):m.bufferSource.noteGrainOn(0,_,s):d._loop?m.bufferSource.start(0,_,86400):m.bufferSource.start(0,_,s),l!==1/0&&(t._endTimers[d._id]=setTimeout(t._ended.bind(t,d),l)),o||setTimeout(function(){t._emit("play",d._id),t._loadQueue()},0)};"running"===n.state&&"interrupted"!==n.ctx.state?v():(t._playLock=!0,t.once("resume",v),t._clearTimer(d._id))}else{var h=function(){m.currentTime=_,m.muted=d._muted||t._muted||n._muted||m.muted,m.volume=d._volume*n.volume(),m.playbackRate=d._rate;try{var r=m.play();if(r&&"undefined"!=typeof Promise&&(r instanceof Promise||"function"==typeof r.then)?(t._playLock=!0,p(),r.then(function(){t._playLock=!1,m._unlocked=!0,o?t._loadQueue():t._emit("play",d._id)}).catch(function(){t._playLock=!1,t._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),d._ended=!0,d._paused=!0})):o||(t._playLock=!1,p(),t._emit("play",d._id)),m.playbackRate=d._rate,m.paused)return void t._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||d._loop?t._endTimers[d._id]=setTimeout(t._ended.bind(t,d),l):(t._endTimers[d._id]=function(){t._ended(d),m.removeEventListener("ended",t._endTimers[d._id],!1)},m.addEventListener("ended",t._endTimers[d._id],!1))}catch(e){t._emit("playerror",d._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===m.src&&(m.src=t._src,m.load());var y=window&&window.ejecta||!m.readyState&&n._navigator.isCocoonJS;if(m.readyState>=3||y)h();else{t._playLock=!0,t._state="loading";var g=function(){t._state="loaded",h(),m.removeEventListener(n._canPlayEvent,g,!1)};m.addEventListener(n._canPlayEvent,g,!1),t._clearTimer(d._id)}}return d._id},pause:function(e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"pause",action:function(){n.pause(e)}}),n;for(var o=n._getSoundIds(e),t=0;t<o.length;t++){n._clearTimer(o[t]);var r=n._soundById(o[t]);if(r&&!r._paused&&(r._seek=n.seek(o[t]),r._rateSeek=0,r._paused=!0,n._stopFade(o[t]),r._node))if(n._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),n._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||n._emit("pause",r?r._id:null)}return n},stop:function(e,n){var o=this;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"stop",action:function(){o.stop(e)}}),o;for(var t=o._getSoundIds(e),r=0;r<t.length;r++){o._clearTimer(t[r]);var a=o._soundById(t[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,o._stopFade(t[r]),a._node&&(o._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),o._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&o._clearSound(a._node))),n||o._emit("stop",a._id))}return o},mute:function(e,o){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"mute",action:function(){t.mute(e,o)}}),t;if(void 0===o){if("boolean"!=typeof e)return t._muted;t._muted=e}for(var r=t._getSoundIds(o),a=0;a<r.length;a++){var u=t._soundById(r[a]);u&&(u._muted=e,u._interval&&t._stopFade(u._id),t._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,n.ctx.currentTime):u._node&&(u._node.muted=!!n._muted||e),t._emit("mute",u._id))}return t},volume:function(){var e,o,t=this,r=arguments;if(0===r.length)return t._volume;if(1===r.length||2===r.length&&void 0===r[1]){t._getSoundIds().indexOf(r[0])>=0?o=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),o=parseInt(r[1],10));var a;if(!(void 0!==e&&e>=0&&e<=1))return a=o?t._soundById(o):t._sounds[0],a?a._volume:0;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"volume",action:function(){t.volume.apply(t,r)}}),t;void 0===o&&(t._volume=e),o=t._getSoundIds(o);for(var u=0;u<o.length;u++)(a=t._soundById(o[u]))&&(a._volume=e,r[2]||t._stopFade(o[u]),t._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(e,n.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=e*n.volume()),t._emit("volume",a._id));return t},fade:function(e,o,t,r){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(e,o,t,r)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),o=Math.min(Math.max(0,parseFloat(o)),1),t=parseFloat(t),a.volume(e,r);for(var u=a._getSoundIds(r),d=0;d<u.length;d++){var i=a._soundById(u[d]);if(i){if(r||a._stopFade(u[d]),a._webAudio&&!i._muted){var _=n.ctx.currentTime,s=_+t/1e3;i._volume=e,i._node.gain.setValueAtTime(e,_),i._node.gain.linearRampToValueAtTime(o,s)}a._startFadeInterval(i,e,o,t,u[d],void 0===r)}}return a},_startFadeInterval:function(e,n,o,t,r,a){var u=this,d=n,i=o-n,_=Math.abs(i/.01),s=Math.max(4,_>0?t/_:t),l=Date.now();e._fadeTo=o,e._interval=setInterval(function(){var r=(Date.now()-l)/t;l=Date.now(),d+=i*r,d=Math.round(100*d)/100,d=i<0?Math.max(o,d):Math.min(o,d),u._webAudio?e._volume=d:u.volume(d,e._id,!0),a&&(u._volume=d),(o<n&&d<=o||o>n&&d>=o)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,u.volume(o,e._id),u._emit("fade",e._id))},s)},_stopFade:function(e){var o=this,t=o._soundById(e);return t&&t._interval&&(o._webAudio&&t._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(t._interval),t._interval=null,o.volume(t._fadeTo,e),t._fadeTo=null,o._emit("fade",e)),o},loop:function(){var e,n,o,t=this,r=arguments;if(0===r.length)return t._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(o=t._soundById(parseInt(r[0],10)))&&o._loop;e=r[0],t._loop=e}else 2===r.length&&(e=r[0],n=parseInt(r[1],10));for(var a=t._getSoundIds(n),u=0;u<a.length;u++)(o=t._soundById(a[u]))&&(o._loop=e,t._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=e,e&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop,t.playing(a[u])&&(t.pause(a[u],!0),t.play(a[u],!0)))));return t},rate:function(){var e,o,t=this,r=arguments;if(0===r.length)o=t._sounds[0]._id;else if(1===r.length){var a=t._getSoundIds(),u=a.indexOf(r[0]);u>=0?o=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));var d;if("number"!=typeof e)return d=t._soundById(o),d?d._rate:t._rate;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"rate",action:function(){t.rate.apply(t,r)}}),t;void 0===o&&(t._rate=e),o=t._getSoundIds(o);for(var i=0;i<o.length;i++)if(d=t._soundById(o[i])){t.playing(o[i])&&(d._rateSeek=t.seek(o[i]),d._playStart=t._webAudio?n.ctx.currentTime:d._playStart),d._rate=e,t._webAudio&&d._node&&d._node.bufferSource?d._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):d._node&&(d._node.playbackRate=e);var _=t.seek(o[i]),s=(t._sprite[d._sprite][0]+t._sprite[d._sprite][1])/1e3-_,l=1e3*s/Math.abs(d._rate);!t._endTimers[o[i]]&&d._paused||(t._clearTimer(o[i]),t._endTimers[o[i]]=setTimeout(t._ended.bind(t,d),l)),t._emit("rate",d._id)}return t},seek:function(){var e,o,t=this,r=arguments;if(0===r.length)t._sounds.length&&(o=t._sounds[0]._id);else if(1===r.length){var a=t._getSoundIds(),u=a.indexOf(r[0]);u>=0?o=parseInt(r[0],10):t._sounds.length&&(o=t._sounds[0]._id,e=parseFloat(r[0]))}else 2===r.length&&(e=parseFloat(r[0]),o=parseInt(r[1],10));if(void 0===o)return 0;if("number"==typeof e&&("loaded"!==t._state||t._playLock))return t._queue.push({event:"seek",action:function(){t.seek.apply(t,r)}}),t;var d=t._soundById(o);if(d){if(!("number"==typeof e&&e>=0)){if(t._webAudio){var i=t.playing(o)?n.ctx.currentTime-d._playStart:0,_=d._rateSeek?d._rateSeek-d._seek:0;return d._seek+(_+i*Math.abs(d._rate))}return d._node.currentTime}var s=t.playing(o);s&&t.pause(o,!0),d._seek=e,d._ended=!1,t._clearTimer(o),t._webAudio||!d._node||isNaN(d._node.duration)||(d._node.currentTime=e);var l=function(){s&&t.play(o,!0),t._emit("seek",o)};if(s&&!t._webAudio){var c=function(){t._playLock?setTimeout(c,0):l()};setTimeout(c,0)}else l()}return t},playing:function(e){var n=this;if("number"==typeof e){var o=n._soundById(e);return!!o&&!o._paused}for(var t=0;t<n._sounds.length;t++)if(!n._sounds[t]._paused)return!0;return!1},duration:function(e){var n=this,o=n._duration,t=n._soundById(e);return t&&(o=n._sprite[t._sprite][1]/1e3),o},state:function(){return this._state},unload:function(){for(var e=this,o=e._sounds,t=0;t<o.length;t++)o[t]._paused||e.stop(o[t]._id),e._webAudio||(e._clearSound(o[t]._node),o[t]._node.removeEventListener("error",o[t]._errorFn,!1),o[t]._node.removeEventListener(n._canPlayEvent,o[t]._loadFn,!1),o[t]._node.removeEventListener("ended",o[t]._endFn,!1),n._releaseHtml5Audio(o[t]._node)),delete o[t]._node,e._clearTimer(o[t]._id);var a=n._howls.indexOf(e);a>=0&&n._howls.splice(a,1);var u=!0;for(t=0;t<n._howls.length;t++)if(n._howls[t]._src===e._src||e._src.indexOf(n._howls[t]._src)>=0){u=!1;break}return r&&u&&delete r[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,n,o,t){var r=this,a=r["_on"+e];return"function"==typeof n&&a.push(t?{id:o,fn:n,once:t}:{id:o,fn:n}),r},off:function(e,n,o){var t=this,r=t["_on"+e],a=0;if("number"==typeof n&&(o=n,n=null),n||o)for(a=0;a<r.length;a++){var u=o===r[a].id;if(n===r[a].fn&&u||!n&&u){r.splice(a,1);break}}else if(e)t["_on"+e]=[];else{var d=Object.keys(t);for(a=0;a<d.length;a++)0===d[a].indexOf("_on")&&Array.isArray(t[d[a]])&&(t[d[a]]=[])}return t},once:function(e,n,o){var t=this;return t.on(e,n,o,1),t},_emit:function(e,n,o){for(var t=this,r=t["_on"+e],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==n&&"load"!==e||(setTimeout(function(e){e.call(this,n,o)}.bind(t,r[a].fn),0),r[a].once&&t.off(e,r[a].fn,r[a].id));return t._loadQueue(e),t},_loadQueue:function(e){var n=this;if(n._queue.length>0){var o=n._queue[0];o.event===e&&(n._queue.shift(),n._loadQueue()),e||o.action()}return n},_ended:function(e){var o=this,t=e._sprite;if(!o._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(o._ended.bind(o,e),100),o;var r=!(!e._loop&&!o._sprite[t][2]);if(o._emit("end",e._id),!o._webAudio&&r&&o.stop(e._id,!0).play(e._id),o._webAudio&&r){o._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=1e3*(e._stop-e._start)/Math.abs(e._rate);o._endTimers[e._id]=setTimeout(o._ended.bind(o,e),a)}return o._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,o._clearTimer(e._id),o._cleanBuffer(e._node),n._autoSuspend()),o._webAudio||r||o.stop(e._id,!0),o},_clearTimer:function(e){var n=this;if(n._endTimers[e]){if("function"!=typeof n._endTimers[e])clearTimeout(n._endTimers[e]);else{var o=n._soundById(e);o&&o._node&&o._node.removeEventListener("ended",n._endTimers[e],!1)}delete n._endTimers[e]}return n},_soundById:function(e){for(var n=this,o=0;o<n._sounds.length;o++)if(e===n._sounds[o]._id)return n._sounds[o];return null},_inactiveSound:function(){var e=this;e._drain();for(var n=0;n<e._sounds.length;n++)if(e._sounds[n]._ended)return e._sounds[n].reset();return new t(e)},_drain:function(){var e=this,n=e._pool,o=0,t=0;if(!(e._sounds.length<n)){for(t=0;t<e._sounds.length;t++)e._sounds[t]._ended&&o++;for(t=e._sounds.length-1;t>=0;t--){if(o<=n)return;e._sounds[t]._ended&&(e._webAudio&&e._sounds[t]._node&&e._sounds[t]._node.disconnect(0),e._sounds.splice(t,1),o--)}}},_getSoundIds:function(e){var n=this;if(void 0===e){for(var o=[],t=0;t<n._sounds.length;t++)o.push(n._sounds[t]._id);return o}return[e]},_refreshBuffer:function(e){var o=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=r[o._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),o},_cleanBuffer:function(e){var o=this,t=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return o;if(n._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}return e.bufferSource=null,o},_clearSound:function(e){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var t=function(e){this._parent=e,this.init()};t.prototype={init:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._rate=o._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,o._sounds.push(e),e.create(),e},create:function(){var e=this,o=e._parent,t=n._muted||e._muted||e._parent._muted?0:e._volume;return o._webAudio?(e._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(t,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):n.noAudio||(e._node=n._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=o._src,e._node.preload=!0===o._preload?"auto":o._preload,e._node.volume=t*n.volume(),e._node.load()),e},reset:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._rate=o._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,o=e._parent;o._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(o._sprite).length&&(o._sprite={__default:[0,1e3*o._duration]}),"loaded"!==o._state&&(o._state="loaded",o._emit("load"),o._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,n=e._parent;n._duration===1/0&&(n._duration=Math.ceil(10*e._node.duration)/10,n._sprite.__default[1]===1/0&&(n._sprite.__default[1]=1e3*n._duration),n._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var r={},a=function(e){var n=e._src;if(r[n])return e._duration=r[n].duration,void i(e);if(/^data:[^;]+;base64,/.test(n)){for(var o=atob(n.split(",")[1]),t=new Uint8Array(o.length),a=0;a<o.length;++a)t[a]=o.charCodeAt(a);d(t.buffer,e)}else{var _=new XMLHttpRequest;_.open(e._xhr.method,n,!0),_.withCredentials=e._xhr.withCredentials,_.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(n){_.setRequestHeader(n,e._xhr.headers[n])}),_.onload=function(){var n=(_.status+"")[0];if("0"!==n&&"2"!==n&&"3"!==n)return void e._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");d(_.response,e)},_.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete r[n],e.load())},u(_)}},u=function(e){try{e.send()}catch(n){e.onerror()}},d=function(e,o){var t=function(){o._emit("loaderror",null,"Decoding audio data failed.")},a=function(e){e&&o._sounds.length>0?(r[o._src]=e,i(o,e)):t()};"undefined"!=typeof Promise&&1===n.ctx.decodeAudioData.length?n.ctx.decodeAudioData(e).then(a).catch(t):n.ctx.decodeAudioData(e,a,t)},i=function(e,n){n&&!e._duration&&(e._duration=n.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},_=function(){if(n.usingWebAudio){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),o=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),t=o?parseInt(o[1],10):null;if(e&&t&&t<9){var r=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!r&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};"function"==typeof define&&define.amd&&define([],function(){return{Howler:n,Howl:o}}),"undefined"!=typeof exports&&(exports.Howler=n,exports.Howl=o),"undefined"!=typeof global?(global.HowlerGlobal=e,global.Howler=n,global.Howl=o,global.Sound=t):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=o,window.Sound=t)}();
/*! Spatial Plugin */
!function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var t=n._howls.length-1;t>=0;t--)n._howls[t].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,t){var r=this;return r.ctx&&r.ctx.listener?(n="number"!=typeof n?r._pos[1]:n,t="number"!=typeof t?r._pos[2]:t,"number"!=typeof e?r._pos:(r._pos=[e,n,t],void 0!==r.ctx.listener.positionX?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(e,n,t,r,o,i){var a=this;if(!a.ctx||!a.ctx.listener)return a;var p=a._orientation;return n="number"!=typeof n?p[1]:n,t="number"!=typeof t?p[2]:t,r="number"!=typeof r?p[3]:r,o="number"!=typeof o?p[4]:o,i="number"!=typeof i?p[5]:i,"number"!=typeof e?p:(a._orientation=[e,n,t,r,o,i],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,n,t,r,o,i),a)},Howl.prototype.init=function(e){return function(n){var t=this;return t._orientation=n.orientation||[1,0,0],t._stereo=n.stereo||null,t._pos=n.pos||null,t._pannerAttr={coneInnerAngle:void 0!==n.coneInnerAngle?n.coneInnerAngle:360,coneOuterAngle:void 0!==n.coneOuterAngle?n.coneOuterAngle:360,coneOuterGain:void 0!==n.coneOuterGain?n.coneOuterGain:0,distanceModel:void 0!==n.distanceModel?n.distanceModel:"inverse",maxDistance:void 0!==n.maxDistance?n.maxDistance:1e4,panningModel:void 0!==n.panningModel?n.panningModel:"HRTF",refDistance:void 0!==n.refDistance?n.refDistance:1,rolloffFactor:void 0!==n.rolloffFactor?n.rolloffFactor:1},t._onstereo=n.onstereo?[{fn:n.onstereo}]:[],t._onpos=n.onpos?[{fn:n.onpos}]:[],t._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,t){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(n,t)}}),r;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof n)return r._stereo;r._stereo=n,r._pos=[n,0,0]}for(var i=r._getSoundIds(t),a=0;a<i.length;a++){var p=r._soundById(i[a]);if(p){if("number"!=typeof n)return p._stereo;p._stereo=n,p._pos=[n,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",p._panner&&p._panner.pan||e(p,o),"spatial"===o?void 0!==p._panner.positionX?(p._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(n,0,0):p._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),r._emit("stereo",p._id)}}return r},Howl.prototype.pos=function(n,t,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"pos",action:function(){i.pos(n,t,r,o)}}),i;if(t="number"!=typeof t?0:t,r="number"!=typeof r?-.5:r,void 0===o){if("number"!=typeof n)return i._pos;i._pos=[n,t,r]}for(var a=i._getSoundIds(o),p=0;p<a.length;p++){var s=i._soundById(a[p]);if(s){if("number"!=typeof n)return s._pos;s._pos=[n,t,r],s._node&&(s._panner&&!s._panner.pan||e(s,"spatial"),void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):s._panner.setPosition(n,t,r)),i._emit("pos",s._id)}}return i},Howl.prototype.orientation=function(n,t,r,o){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"orientation",action:function(){i.orientation(n,t,r,o)}}),i;if(t="number"!=typeof t?i._orientation[1]:t,r="number"!=typeof r?i._orientation[2]:r,void 0===o){if("number"!=typeof n)return i._orientation;i._orientation=[n,t,r]}for(var a=i._getSoundIds(o),p=0;p<a.length;p++){var s=i._soundById(a[p]);if(s){if("number"!=typeof n)return s._orientation;s._orientation=[n,t,r],s._node&&(s._panner||(s._pos||(s._pos=i._pos||[0,0,-.5]),e(s,"spatial")),void 0!==s._panner.orientationX?(s._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),s._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),s._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):s._panner.setOrientation(n,t,r)),i._emit("orientation",s._id)}}return i},Howl.prototype.pannerAttr=function(){var n,t,r,o=this,i=arguments;if(!o._webAudio)return o;if(0===i.length)return o._pannerAttr;if(1===i.length){if("object"!=typeof i[0])return r=o._soundById(parseInt(i[0],10)),r?r._pannerAttr:o._pannerAttr;n=i[0],void 0===t&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==n.pannerAttr.coneInnerAngle?n.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==n.pannerAttr.coneOuterAngle?n.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==n.pannerAttr.coneOuterGain?n.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==n.pannerAttr.distanceModel?n.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==n.pannerAttr.maxDistance?n.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==n.pannerAttr.refDistance?n.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==n.pannerAttr.rolloffFactor?n.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==n.pannerAttr.panningModel?n.pannerAttr.panningModel:o._panningModel})}else 2===i.length&&(n=i[0],t=parseInt(i[1],10));for(var a=o._getSoundIds(t),p=0;p<a.length;p++)if(r=o._soundById(a[p])){var s=r._pannerAttr;s={coneInnerAngle:void 0!==n.coneInnerAngle?n.coneInnerAngle:s.coneInnerAngle,coneOuterAngle:void 0!==n.coneOuterAngle?n.coneOuterAngle:s.coneOuterAngle,coneOuterGain:void 0!==n.coneOuterGain?n.coneOuterGain:s.coneOuterGain,distanceModel:void 0!==n.distanceModel?n.distanceModel:s.distanceModel,maxDistance:void 0!==n.maxDistance?n.maxDistance:s.maxDistance,refDistance:void 0!==n.refDistance?n.refDistance:s.refDistance,rolloffFactor:void 0!==n.rolloffFactor?n.rolloffFactor:s.rolloffFactor,panningModel:void 0!==n.panningModel?n.panningModel:s.panningModel};var c=r._panner;c||(r._pos||(r._pos=o._pos||[0,0,-.5]),e(r,"spatial"),c=r._panner),c.coneInnerAngle=s.coneInnerAngle,c.coneOuterAngle=s.coneOuterAngle,c.coneOuterGain=s.coneOuterGain,c.distanceModel=s.distanceModel,c.maxDistance=s.maxDistance,c.refDistance=s.refDistance,c.rolloffFactor=s.rolloffFactor,c.panningModel=s.panningModel}return o},Sound.prototype.init=function(e){return function(){var n=this,t=n._parent;n._orientation=t._orientation,n._stereo=t._stereo,n._pos=t._pos,n._pannerAttr=t._pannerAttr,e.call(this),n._stereo?t.stereo(n._stereo):n._pos&&t.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,t=n._parent;return n._orientation=t._orientation,n._stereo=t._stereo,n._pos=t._pos,n._pannerAttr=t._pannerAttr,n._stereo?t.stereo(n._stereo):n._pos?t.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,t._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var e=function(e,n){n=n||"spatial","spatial"===n?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}();</script>
<script>

/////////////////////////////////////////
// main visibility API function 
// check if current tab is active or not
var vis = (function(){
    var stateKey, 
        eventKey, 
        keys = {
                hidden: "visibilitychange",
                webkitHidden: "webkitvisibilitychange",
                mozHidden: "mozvisibilitychange",
                msHidden: "msvisibilitychange"
    };
    for (stateKey in keys) {
        if (stateKey in document) {
            eventKey = keys[stateKey];
            break;
        }
    }
    return function(c) {
        if (c) document.addEventListener(eventKey, c);
        return !document[stateKey];
    }
})();


/////////////////////////////////////////
// check if current tab is active or not
vis(function(){
					
    if(vis()){	
        
        // the setTimeout() is used due to a delay 
        // before the tab gains focus again, very important!
	      setTimeout(function(){ 
          
            // tween resume() code goes here	
            visibleResume();
            

          
        },300);		
												
    } else {
	
        // tween pause() code goes here	
        visiblePause();
        

    }
});


/////////////////////////////////////////
// check if browser window has focus		
var notIE = (document.documentMode === undefined),
    isChromium = window.chrome;
      
if (notIE && !isChromium) {

   

} else {
    
    // checks for IE and Chromium versions
    if (window.addEventListener) {

        // bind focus event
        window.addEventListener("focus", function (event) {
          
            setTimeout(function(){                 
                 
                 // tween resume() code goes here
                 //visibleResume();
              

              
            },300);

        }, false);

        // bind blur event
        window.addEventListener("blur", function (event) {

            // tween pause() code goes
            visiblePause();
          

        }, false);

    } else {

        // bind focus event
        window.attachEvent("focus", function (event) {

            setTimeout(function(){                 

                 // tween resume() code goes here
                 //visibleResume();
               

              
            },300);

        });

        // bind focus event
        window.attachEvent("blur", function (event) {

            // tween pause() code goes here
            visiblePause();
          


        });
    }
}</script>
<script>var Utils,Elements,previousTime,canvasX,canvasY,sound,music,assetLib,preAssetLib,delta,prevGameState,panel,background,aLevelUps,levelBonusScore,bonusScore,panelFrame,oLogoBut,tableTop,userBat,enemyBat,aSeasonFlags,aSeasonFlagsRender,startTouchY,aEffects,gameType,aProgressButs,curTournLevelId,isSpecialGame,lastUnlockedChar,curTime,hitFirstShot,bottleGameState,batShop,prevGameplayState,aBalls,awardPanel,__extends=this&&this.__extends||function(){var e=function(t,a){return(e=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}();!function(e){var t=function(){function e(e,t,a,s,i,r){void 0===r&&(r=!0),this.oAssetData={},this.assetsLoaded=0,this.textData={},this.spinnerRot=0,this.totalAssets=t.length,this.showBar=r;for(var o=0;o<t.length;o++)-1!=t[o].file.indexOf(".json")?this.loadJSON(t[o]):this.loadImage(t[o]);r&&(this.oLoaderImgData=preAssetLib.getData("loader"),this.oLoadSpinnerImgData=preAssetLib.getData("loadSpinner"))}return e.prototype.render=function(){ctx.fillStyle="rgba(0, 0, 0, 1)",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="#FFFFFF",ctx.fillRect(canvas.width/2-150,canvas.height/2+20,300/this.totalAssets*this.assetsLoaded,30),ctx.drawImage(this.oLoaderImgData.img,canvas.width/2-this.oLoaderImgData.img.width/2,canvas.height/2-this.oLoaderImgData.img.height/2),this.spinnerRot+=3*delta,ctx.save(),ctx.translate(canvas.width/2-38,canvas.height/2-16),ctx.scale(.7+Math.sin(2*this.spinnerRot)/10,.7+Math.sin(2*this.spinnerRot)/10),ctx.rotate(this.spinnerRot),ctx.drawImage(this.oLoadSpinnerImgData.img,-this.oLoadSpinnerImgData.img.width/2,-this.oLoadSpinnerImgData.img.height/2),ctx.restore(),this.displayNumbers()},e.prototype.displayNumbers=function(){ctx.textAlign="left",ctx.font="bold 40px arial",ctx.fillStyle="#ffffff",ctx.fillText(Math.round(this.assetsLoaded/this.totalAssets*100)+"%",canvas.width/2-0,canvas.height/2-1)},e.prototype.loadExtraAssets=function(e,t){this.showBar=!1,this.totalAssets=t.length,this.assetsLoaded=0,this.loadedCallback=e;for(var a=0;a<t.length;a++)-1!=t[a].file.indexOf(".json")?this.loadJSON(t[a]):this.loadImage(t[a])},e.prototype.loadJSON=function(e){var t=this,a=new XMLHttpRequest;a.open("GET",e.file,!0),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(t.textData[e.id]=JSON.parse(a.responseText),++t.assetsLoaded,t.checkLoadComplete())},a.send(null)},e.prototype.loadImage=function(e){var t=this,a=new Image;a.onload=function(){t.oAssetData[e.id]={},t.oAssetData[e.id].img=a,t.oAssetData[e.id].oData={};var s=t.getSpriteSize(e.file);0!=s[0]?(t.oAssetData[e.id].oData.spriteWidth=s[0],t.oAssetData[e.id].oData.spriteHeight=s[1]):(t.oAssetData[e.id].oData.spriteWidth=t.oAssetData[e.id].img.width,t.oAssetData[e.id].oData.spriteHeight=t.oAssetData[e.id].img.height),e.oAnims&&(t.oAssetData[e.id].oData.oAnims=e.oAnims),e.oAtlasData?t.oAssetData[e.id].oData.oAtlasData=e.oAtlasData:t.oAssetData[e.id].oData.oAtlasData={none:{x:0,y:0,width:t.oAssetData[e.id].oData.spriteWidth,height:t.oAssetData[e.id].oData.spriteHeight}},++t.assetsLoaded,t.checkLoadComplete()},a.src=e.file},e.prototype.getSpriteSize=function(e){for(var t=[],a="",s="",i=0,r=e.lastIndexOf("."),o=!0;o;)r--,0==i&&this.isNumber(e.charAt(r))?a=e.charAt(r)+a:0==i&&a.length>0&&"x"==e.charAt(r)?(r--,i=1,s=e.charAt(r)+s):1==i&&this.isNumber(e.charAt(r))?s=e.charAt(r)+s:1==i&&s.length>0&&"_"==e.charAt(r)?(o=!1,t=[parseInt(s),parseInt(a)]):(o=!1,t=[0,0]);return t},e.prototype.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.prototype.checkLoadComplete=function(){this.assetsLoaded==this.totalAssets&&this.loadedCallback()},e.prototype.onReady=function(e){this.loadedCallback=e},e.prototype.getImg=function(e){return this.oAssetData[e].img},e.prototype.getData=function(e){return this.oAssetData[e]},e}();e.AssetLoader=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a,s){this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.frameInc=0,this.animType="loop",this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.alpha=1,this.oImgData=e,this.oAnims=this.oImgData.oData.oAnims,this.fps=t,this.radius=a,this.animId=s,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2)}return e.prototype.updateAnimation=function(e){this.frameInc+=this.fps*e},e.prototype.changeImgData=function(e,t){this.oImgData=e,this.oAnims=this.oImgData.oData.oAnims,this.animId=t,this.centreX=Math.round(this.oImgData.oData.spriteWidth/2),this.centreY=Math.round(this.oImgData.oData.spriteHeight/2),this.resetAnim()},e.prototype.resetAnim=function(){this.frameInc=0},e.prototype.setFrame=function(e){this.fixedFrame=e},e.prototype.setAnimType=function(e,t,a){switch(void 0===a&&(a=!0),this.animId=t,this.animType=e,a&&this.resetAnim(),e){case"loop":break;case"once":this.maxIdx=this.oAnims[this.animId].length-1}},e.prototype.render=function(e){if(e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY),e.globalAlpha=this.alpha,null!=this.animId){var t=this.oAnims[this.animId].length,a=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][a%t];var s=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&a>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][t-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,s,i,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.centreX+this.offsetX,-this.centreY+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),e.restore()},e.prototype.renderSimple=function(e){if(null!=this.animId){var t=this.oAnims[this.animId].length,a=Math.floor(this.frameInc);this.curFrame=this.oAnims[this.animId][a%t];var s=this.curFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.curFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;if("once"==this.animType&&a>this.maxIdx){this.fixedFrame=this.oAnims[this.animId][t-1],this.animId=null,null!=this.animEndedFunc&&this.animEndedFunc();var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight}}else var s=this.fixedFrame*this.oImgData.oData.spriteWidth%this.oImgData.img.width,i=Math.floor(this.fixedFrame/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,s,i,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,this.x-(this.centreX-this.offsetX)*this.scaleX,this.y-(this.centreY-this.offsetY)*this.scaleY,this.oImgData.oData.spriteWidth*this.scaleX,this.oImgData.oData.spriteHeight*this.scaleY)},e}();e.AnimSprite=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a){void 0===a&&(a=0),this.x=0,this.y=0,this.rotation=0,this.radius=10,this.removeMe=!1,this.offsetX=0,this.offsetY=0,this.scaleX=1,this.scaleY=1,this.oImgData=e,this.radius=t,this.setFrame(a)}return e.prototype.setFrame=function(e){this.frameNum=e},e.prototype.render=function(e){e.save(),e.translate(this.x,this.y),e.rotate(this.rotation),e.scale(this.scaleX,this.scaleY);var t=this.frameNum*this.oImgData.oData.spriteWidth%this.oImgData.img.width,a=Math.floor(this.frameNum/(this.oImgData.img.width/this.oImgData.oData.spriteWidth))*this.oImgData.oData.spriteHeight;e.drawImage(this.oImgData.img,t,a,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight,-this.oImgData.oData.spriteWidth/2+this.offsetX,-this.oImgData.oData.spriteHeight/2+this.offsetY,this.oImgData.oData.spriteWidth,this.oImgData.oData.spriteHeight),e.restore()},e}();e.BasicSprite=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t){var a=this;this.prevHitTime=0,this.pauseIsOn=!1,this.isDown=!1,this.sensitiveLevel=2,this.aSensitiveRates=[.25,.5,1,1.5,2],this.pointerLockState=0,this.isBugBrowser=t,this.keyDownEvtFunc=function(e){a.keyDown(e)},this.keyUpEvtFunc=function(e){a.keyUp(e)},document.addEventListener("mousemove",function(e){a.mouseX=e.pageX*=canvasScale,a.mouseY=e.pageY*=canvasScale,!isMobile&&(userBat&&(userBat.targX=a.mouseX,userBat.targY=a.mouseY),batShop&&"batShop"==gameState&&batShop.glowBut(a.mouseX,a.mouseY))},!1),e.addEventListener("contextmenu",function(e){return e.preventDefault()}),e.addEventListener("touchstart",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitDown(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchend",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitUp(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchcancel",function(e){for(var t=0;t<e.changedTouches.length;t++)a.hitCancel(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier)},!1),e.addEventListener("touchmove",function(e){for(var t=0;t<e.changedTouches.length;t++)a.move(e,e.changedTouches[t].pageX*canvasScale,e.changedTouches[t].pageY*canvasScale,e.changedTouches[t].identifier,!0)},!1),e.addEventListener("wheel",function(e){a.wheelScroll(e,e.deltaY)},!1),e.addEventListener("mousedown",function(e){a.isDown=!0,a.hitDown(e,a.mouseX,a.mouseY,1)},!1),e.addEventListener("mouseup",function(e){a.isDown=!1,a.hitUp(e,a.mouseX,a.mouseY,1)},!1),e.addEventListener("mousemove",function(e){a.move(e,a.mouseX,a.mouseY,1,a.isDown)},!1),e.addEventListener("mouseout",function(e){2!=e.button&&(clearButtonOvers(),a.isDown=!1,a.hitUp(e,Math.abs(a.mouseX),Math.abs(a.mouseY),1))},!1),this.aHitAreas=[],this.aKeys=[]}return e.prototype.pointerLockOn=function(){},e.prototype.pointerLockOff=function(){},e.prototype.wheelScroll=function(e,t){e.preventDefault(),e.stopPropagation(),"batShop"==gameState&&(batShop.targY-=t)},e.prototype.hitDown=function(e,t,a,s){if(e.preventDefault(),e.stopPropagation(),hasFocus||visibleResume(),!this.pauseIsOn){for(var i=new Date().getTime(),r=0;r<this.aHitAreas.length;r++)if(this.aHitAreas[r].rect){var o=canvas.width*this.aHitAreas[r].align[0],n=canvas.height*this.aHitAreas[r].align[1];if(t>o+this.aHitAreas[r].area[0]&&a>n+this.aHitAreas[r].area[1]&&t<o+this.aHitAreas[r].area[2]&&a<n+this.aHitAreas[r].area[3]){if(this.aHitAreas[r].aTouchIdentifiers.push(s),this.aHitAreas[r].oData.hasLeft=!1,this.aHitAreas[r].oData.isUp=!1,!this.aHitAreas[r].oData.isDown){if(this.aHitAreas[r].oData.isDown=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].oData.button=e.button,i-this.prevHitTime<500&&("game"!=gameState||"pause"==this.aHitAreas[r].id)&&isBugBrowser)return;this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData)}break}}this.prevHitTime=i}},e.prototype.hitUp=function(e,t,a,s){if(ios9FirstTouch||(playSound("silence"),ios9FirstTouch=!0),!this.pauseIsOn){e.preventDefault(),e.stopPropagation();for(var i=0;i<this.aHitAreas.length;i++)if(this.aHitAreas[i].rect){var r=canvas.width*this.aHitAreas[i].align[0],o=canvas.height*this.aHitAreas[i].align[1];if(t>r+this.aHitAreas[i].area[0]&&a>o+this.aHitAreas[i].area[1]&&t<r+this.aHitAreas[i].area[2]&&a<o+this.aHitAreas[i].area[3]){for(var n=0;n<this.aHitAreas[i].aTouchIdentifiers.length;n++)this.aHitAreas[i].aTouchIdentifiers[n]==s&&(this.aHitAreas[i].aTouchIdentifiers.splice(n,1),n-=1);0==this.aHitAreas[i].aTouchIdentifiers.length&&(this.aHitAreas[i].oData.isDown=!1),this.aHitAreas[i].oData.isUp=!0,this.aHitAreas[i].oData.multiTouch&&(this.aHitAreas[i].oData.x=t,this.aHitAreas[i].oData.y=a,this.aHitAreas[i].oData.button=e.button,this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData));break}}}},e.prototype.hitCancel=function(e,t,a,s){e.preventDefault(),e.stopPropagation();for(var i=0;i<this.aHitAreas.length;i++)this.aHitAreas[i].oData.isDown&&(this.aHitAreas[i].oData.isDown=!1,this.aHitAreas[i].aTouchIdentifiers=[],this.aHitAreas[i].oData.multiTouch&&(this.aHitAreas[i].oData.x=t,this.aHitAreas[i].oData.y=a,this.aHitAreas[i].callback(this.aHitAreas[i].id,this.aHitAreas[i].oData)))},e.prototype.move=function(e,t,a,s,i){if(!isMobile&&(userBat&&(userBat.targX=t*canvasScale,userBat.targY=a*canvasScale),batShop&&"batShop"==gameState&&batShop.glowBut(t*canvasScale,a*canvasScale)),!this.pauseIsOn&&i){for(var r=0;r<this.aHitAreas.length;r++)if(this.aHitAreas[r].rect){var o=canvas.width*this.aHitAreas[r].align[0],n=canvas.height*this.aHitAreas[r].align[1];if(t>o+this.aHitAreas[r].area[0]&&a>n+this.aHitAreas[r].area[1]&&t<o+this.aHitAreas[r].area[2]&&a<n+this.aHitAreas[r].area[3])this.aHitAreas[r].oData.hasLeft=!1,this.aHitAreas[r].oData.isDraggable&&!this.aHitAreas[r].oData.isDown&&(this.aHitAreas[r].oData.isDown=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].aTouchIdentifiers.push(s),this.aHitAreas[r].oData.multiTouch&&this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData)),this.aHitAreas[r].oData.isDraggable&&(this.aHitAreas[r].oData.isBeingDragged=!0,this.aHitAreas[r].oData.x=t,this.aHitAreas[r].oData.y=a,this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData),this.aHitAreas[r]&&(this.aHitAreas[r].oData.isBeingDragged=!1));else if(this.aHitAreas[r].oData.isDown&&!this.aHitAreas[r].oData.hasLeft){for(var l=0;l<this.aHitAreas[r].aTouchIdentifiers.length;l++)this.aHitAreas[r].aTouchIdentifiers[l]==s&&(this.aHitAreas[r].aTouchIdentifiers.splice(l,1),l-=1);0==this.aHitAreas[r].aTouchIdentifiers.length&&(this.aHitAreas[r].oData.hasLeft=!0,this.aHitAreas[r].oData.isBeingDragged||(this.aHitAreas[r].oData.isDown=!1),this.aHitAreas[r].oData.multiTouch&&this.aHitAreas[r].callback(this.aHitAreas[r].id,this.aHitAreas[r].oData))}}}},e.prototype.keyDown=function(e){for(var t=0;t<this.aKeys.length;t++)e.keyCode==this.aKeys[t].keyCode&&(e.preventDefault(),this.aKeys[t].oData.isDown=!0,this.aKeys[t].callback(this.aKeys[t].id,this.aKeys[t].oData))},e.prototype.keyUp=function(e){for(var t=0;t<this.aKeys.length;t++)e.keyCode==this.aKeys[t].keyCode&&(e.preventDefault(),this.aKeys[t].oData.isDown=!1,this.aKeys[t].callback(this.aKeys[t].id,this.aKeys[t].oData))},e.prototype.checkKeyFocus=function(){window.focus(),this.aKeys.length>0&&(window.removeEventListener("keydown",this.keyDownEvtFunc,!1),window.removeEventListener("keyup",this.keyUpEvtFunc,!1),window.addEventListener("keydown",this.keyDownEvtFunc,!1),window.addEventListener("keyup",this.keyUpEvtFunc,!1))},e.prototype.addKey=function(e,t,a,s){null==a&&(a={}),this.aKeys.push({id:e,callback:t,oData:a,keyCode:s}),this.checkKeyFocus()},e.prototype.removeKey=function(e){for(var t=0;t<this.aKeys.length;t++)this.aKeys[t].id==e&&(this.aKeys.splice(t,1),t-=1)},e.prototype.addHitArea=function(e,t,a,s,i,r){void 0===r&&(r=!1),null==a&&(a={}),r&&this.removeHitArea(e),i.scale||(i.scale=1),i.align||(i.align=[0,0]);var o,n=[];switch(s){case"image":o=[i.aPos[0]-i.oImgData.oData.oAtlasData[i.id].width/2*i.scale,i.aPos[1]-i.oImgData.oData.oAtlasData[i.id].height/2*i.scale,i.aPos[0]+i.oImgData.oData.oAtlasData[i.id].width/2*i.scale,i.aPos[1]+i.oImgData.oData.oAtlasData[i.id].height/2*i.scale],this.aHitAreas.push({id:e,aTouchIdentifiers:n,callback:t,oData:a,rect:!0,area:o,align:i.align});break;case"rect":this.aHitAreas.push({id:e,aTouchIdentifiers:n,callback:t,oData:a,rect:!0,area:i.aRect,align:i.align})}},e.prototype.removeHitArea=function(e){for(var t=0;t<this.aHitAreas.length;t++)this.aHitAreas[t].id==e&&(this.aHitAreas.splice(t,1),t-=1)},e.prototype.resetAll=function(){for(var e=0;e<this.aHitAreas.length;e++)this.aHitAreas[e].oData.isDown=!1,this.aHitAreas[e].oData.isBeingDragged=!1,this.aHitAreas[e].aTouchIdentifiers=[];this.isDown=!1},e}();e.UserInput=t}(Utils||(Utils={})),function(e){var t=function(){function e(e){this.updateFreq=10,this.updateInc=0,this.frameAverage=0,this.display=1,this.log="",this.render=function(e){this.frameAverage+=this.delta/this.updateFreq,++this.updateInc>=this.updateFreq&&(this.updateInc=0,this.display=this.frameAverage,this.frameAverage=0),e.textAlign="left",ctx.font="10px Helvetica",e.fillStyle="#333333",e.beginPath(),e.rect(0,this.canvasHeight-15,40,15),e.closePath(),e.fill(),e.fillStyle="#ffffff",e.fillText(Math.round(1e3/(1e3*this.display))+" fps "+this.log,5,this.canvasHeight-5)},this.canvasHeight=e}return e.prototype.update=function(e){this.delta=e},e}();e.FpsMeter=t}(Utils||(Utils={})),function(e){var t=function(){function e(){this.bgId=0,this.inc=0}return e.prototype.setRandom=function(){var e=this.bgId;for(this.bgId=Math.floor(5*Math.random());e==this.bgId;)this.bgId=Math.floor(5*Math.random());4==gameVariation&&(this.bgId=Math.floor(4*Math.random())+1)},e.prototype.render=function(){(0==gameplayState||0==gameVariation)&&(this.bgId=Math.floor(curLevel/levelsPerWorld)%5),this.oImgData=assetLib.getData("bg"+this.bgId);var e=Math.max(canvas.width,canvas.height)/900;ctx.drawImage(this.oImgData.img,0,0,this.oImgData.img.width,this.oImgData.img.height,canvas.width/2-this.oImgData.img.width/2*e,canvas.height/2-this.oImgData.img.height/2*e,this.oImgData.img.height*e,this.oImgData.img.height*e)},e}();e.Background=t}(Elements||(Elements={})),function(e){var t=function(){function t(e,t){this.timer=.3,this.endTime=0,this.posY=0,this.incY=0,this.flareRot=0,this.cupFlipInc=0,this.userCardScale=1,this.enemyCardScale=1,this.userBatX=0,this.userBatY=0,this.enemyBatX=0,this.enemyBatY=0,this.ballX=0,this.ballY=0,this.ballHeight=0,this.flashInc=0,this.promptOffScreen=!1,this.starsY=0,this.starsX=0,this.levelCompleteInc=0,this.batRotation=0,this.batScale=1,this.batSpin=1,this.scoreSideY0=0,this.scoreSideY1=0,this.bugTimeY=1,this.adBlockInc=1,this.congratsInc=1,this.congratsId=0,this.mapState=0,this.mapInc=1,this.mapScale=1,this.mapPinScale=0,this.mapPos=0,this.linkTextId=0,this.shareButOn=!1,this.disconnectInc=0,this.pvpStartInc=1,this.oSplashLogoImgData=assetLib.getData("splashLogo"),this.oUiElementsImgData=assetLib.getData("uiElements"),this.oGameElementsImgData=assetLib.getData("gameElements"),this.oUiButsImgData=assetLib.getData("uiButs"),this.oSpecialSpinnerImgData=assetLib.getData("specialSpinner"),this.oTopFlareImgData=assetLib.getData("flare"),this.panelType=e,this.aButs=t,this.cupFlipInc=0}return t.prototype.update=function(){this.incY+=10*delta},t.prototype.clipboardCallback=function(e){0==e?this.linkTextId=2:1==e&&(this.linkTextId=1)},t.prototype.showDisconnect=function(e){var t=this;this.adBlocktween&&this.adBlocktween.kill(),this.errorText=e,this.disconnectInc=0,this.adBlocktween=TweenLite.to(this,.5,{disconnectInc:1,ease:"Cubic.easeOut",onComplete:function(){t.adBlocktween=TweenLite.to(t,.5,{disconnectInc:0,delay:3,ease:"Cubic.easeIn"})}})},t.prototype.adBlockInfo=function(){1!=this.adBlockInc&&(ctx.fillStyle="rgba(100, 0, 0, 1)",ctx.fillRect(canvas.width/2-260,canvas.height-60+100*this.adBlockInc,520,50),addText(0,40,500,"center",canvas.width/2,canvas.height-25+100*this.adBlockInc,"adBlock","#FFFFFF"))},t.prototype.showAdBlockMessage=function(){var e=this;this.adBlocktween&&this.adBlocktween.kill(),this.adBlockInc=1,this.adBlocktween=TweenLite.to(this,.5,{adBlockInc:0,ease:"Cubic.easeOut",onComplete:function(){e.adBlocktween=TweenLite.to(e,.5,{adBlockInc:1,delay:3,ease:"Cubic.easeIn"})}})},t.prototype.showPvpStartMessage=function(){var e=this;this.pvpStartInc=1,TweenLite.to(this,.3,{pvpStartInc:0,ease:"Cubic.easeOut",onComplete:function(){TweenLite.to(e,.3,{pvpStartInc:1,delay:.5,ease:"Cubic.easeIn"})}})},t.prototype.mapIntro=function(){var t=this;this.mapState=0,this.mapScale=2,this.mapPos=0,playSound("worldComplete",.3),TweenLite.to(this,.5,{mapScale:1,ease:"Cubic.easeOut",onComplete:function(){playSound("arcadeWin",1),t.mapState=1,t.mapPinScale=0;for(var a=0;a<200;a++){var s=new e.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(s)}TweenLite.to(t,1,{mapScale:1.6,mapPos:1,ease:"Cubic.easeInOut",onComplete:function(){}}),TweenLite.to(t,.5,{mapPinScale:1,ease:"Back.easeOut",onComplete:function(){playSound("hitTarget",.6),addMapButs(),t.mapState=2}})}})},t.prototype.congratsUpdate=function(){1!=this.congratsInc&&(addText(0,100,canvas.width-100,"center",canvas.width/2,.9*canvas.height+100*this.congratsInc+2,"congrats"+this.congratsId,"#D700FF"),addText(0,100,canvas.width-100,"center",canvas.width/2,.9*canvas.height+100*this.congratsInc,"congrats"+this.congratsId,"#FFFFFF"))},t.prototype.showCongrats=function(){var e=this;this.congratsTween&&this.congratsTween.kill(),tableTop.tweenColours(),this.congratsInc=1,this.congratsId=Math.floor(20*Math.random()),this.congratsTween=TweenLite.to(this,.25,{congratsInc:0,ease:"Cubic.easeOut",onComplete:function(){e.congratsTween=TweenLite.to(e,.25,{congratsInc:1,delay:1,ease:"Cubic.easeIn"})}})},t.prototype.startTween=function(){this.posY=500,TweenLite.to(this,.5,{posY:0,ease:"Back.easeOut"}),this.butsY=500,TweenLite.to(this,.3,{butsY:0,ease:"Cubic.easeOut"})},t.prototype.startGameTween=function(){this.starsTween&&this.starsTween.kill(),this.starsY=1,this.scoreSideY0=1,this.scoreSideY1=1,this.starsTween=TweenLite.to(this,.5,{starsY:0,scoreSideY0:0,scoreSideY1:0,ease:"Back.easeOut"})},t.prototype.tweenStars=function(e){var t=this;this.starsTween&&this.starsTween.kill(),e?this.starsTween=TweenLite.to(this,.1,{starsY:-.4,ease:"Cubic.easeOut",onComplete:function(){t.starsTween=TweenLite.to(t,.6,{starsY:0,ease:"Bounce.easeOut",onComplete:function(){}})}}):(this.starsX=-.3,this.starsTween=TweenLite.to(this,1,{starsX:0,ease:"Elastic.easeOut"}))},t.prototype.tweenTargetGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),Math.round(curTargetScore/2)>0&&(this.aWinGems=[],this.winGemTarg=Math.round(curTargetScore/2),this.winGemCount=this.winGemTarg+30,setTimeout(function(){playSound("gemTweenOut")},800))},t.prototype.tweenBugGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),Math.ceil(bugScore/4)>0&&(this.aWinGems=[],this.winGemTarg=Math.ceil(bugScore/4),this.winGemCount=this.winGemTarg+30,setTimeout(function(){playSound("gemTweenOut")},800))},t.prototype.addBugTime=function(){var e=this;bugTime=Math.max(bugTime-bugBonusTime,0),this.bugTimeTween&&this.bugTimeTween.kill(),this.bugTimeY=1,this.bugTimeTween=TweenLite.to(this,.5,{bugTimeY:0,ease:"Cubic.easeOut",onComplete:function(){e.bugTimeTween=TweenLite.to(e,.5,{bugTimeY:-1,delay:1,ease:"Cubic.easeIn",onComplete:function(){e.bugTimeY=1}})}})},t.prototype.tweenPvpGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],userScore>enemyScore?this.winGemTarg=userScore+25:this.winGemTarg=enemyScore,setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenCustomGameComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],userSets>enemySets?this.winGemTarg=50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():this.winGemTarg=25,setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenTargetGameScore=function(){this.starsTween&&this.starsTween.kill(),this.starsY=1,this.starsTween=TweenLite.to(this,.5,{starsY:0,ease:"Bounce.easeOut"})},t.prototype.tweenCustomGameScore=function(e){var t;this.starsTween&&this.starsTween.kill(),this["scoreSideY"+e]=1,this.starsTween=TweenLite.to(this,.5,((t={})["scoreSideY"+e]=0,t.ease="Bounce.easeOut",t))},t.prototype.tweenLevelComplete=function(){if(this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.aWinGems=[],(curLevel+1)%levelsPerWorld==0){this.winGemTarg=aPointScores[1];for(var e=Math.floor((curLevel+1)/levelsPerWorld),t=0;t<aBatData.length;t++)if(aBatData[t].unlockWorld==e){batUnlockedId=t;break}}else this.winGemTarg=aPointScores[0];setTimeout(function(){playSound("gemTweenOut")},800),this.winGemCount=this.winGemTarg+30},t.prototype.tweenWorldComplete=function(){this.levelCompleteTween&&this.levelCompleteTween.kill(),this.levelCompleteInc=1,this.levelCompleteTween=TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}}),this.batScale=3,TweenLite.to(this,1.5,{batScale:1.5,ease:"Back.easeIn",onComplete:function(){}})},t.prototype.tweenGem=function(){TweenLite.to(this,.5,{levelCompleteInc:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.startTut=function(){var e=this;this.userBatX=-50,this.userBatY=85,this.enemyBatX=0,this.enemyBatY=-130,this.ballX=0,this.ballY=19,TweenLite.to(this,.55,{delay:.35,userBatX:50,userBatY:-60,ease:"Back.easeOut",onComplete:function(){e.movePlayerBat(0)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:50,ease:"Back.easeOut",onComplete:function(){}}),this.ballHeight=30,TweenLite.to(this,.55,{delay:.5,ballX:30,ballY:-100,ease:"Linear.easeNone",onComplete:function(){}}),TweenLite.to(this,.6,{delay:.6,ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})},t.prototype.movePlayerBat=function(e){var t=this;switch(e){case 0:TweenLite.to(this,.5,{userBatX:130,userBatY:85,ease:"Quad.easeInOut",onComplete:function(){t.movePlayerBat(1)}}),TweenLite.to(this,.65,{delay:.25,ballX:75,ballY:50,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballX:-20,ballY:-100,ease:"Quad.easeOut",onComplete:function(){}})}}),TweenLite.to(this,.65,{delay:.25,ballHeight:40,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})}});break;case 1:TweenLite.to(this,.5,{delay:.3,userBatX:-30,userBatY:-60,ease:"Back.easeOut",onComplete:function(){t.movePlayerBat(2)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:-30,ease:"Back.easeOut",onComplete:function(){}});break;case 2:TweenLite.to(this,.5,{userBatX:-130,userBatY:85,ease:"Quad.easeInOut",onComplete:function(){t.movePlayerBat(3)}}),TweenLite.to(this,.65,{delay:.25,ballX:-75,ballY:50,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballX:20,ballY:-100,ease:"Quad.easeOut",onComplete:function(){}})}}),TweenLite.to(this,.65,{delay:.25,ballHeight:40,ease:"Quad.easeIn",onComplete:function(){TweenLite.to(t,.65,{ballHeight:-30,ease:"Quad.easeIn",onComplete:function(){}})}});break;case 3:TweenLite.to(this,.5,{delay:.3,userBatX:30,userBatY:-60,ease:"Back.easeOut",onComplete:function(){t.movePlayerBat(0)}}),TweenLite.to(this,.5,{delay:.8,enemyBatX:30,ease:"Back.easeOut",onComplete:function(){}})}},t.prototype.switchBut=function(e,t,a,s,i){void 0===s&&(s=null),void 0===i&&(i=null);for(var r=null,o=0;o<this.aButs.length;o++)this.aButs[o].id==e&&(this.aButs[o].id=t,this.aButs[o].idOver=a,r=this.aButs[o],s&&(this.aButs[o].aPos=s),i&&(this.aButs[o].align=i));return r},t.prototype.removeBut=function(e){for(var t=0;t<this.aButs.length;t++)this.aButs[t].id==e&&(this.aButs.splice(t,1),t-=1)},t.prototype.render=function(t){var a=this;switch(void 0===t&&(t=!0),t||this.addButs(),gameState){case"splash":break;case"network":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);var s=0,i="#000000",r="#FFFFFF";1==this.linkTextId&&(addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2-30,"waiting","#FFFFFF"),addText(1,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+20,"join","#FFFF00"),Math.sin(this.incY)>0&&(s=1),r="#000000",i="#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"shareHeader"+s);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2,canvas.height/2-250,o.bWidth,o.bHeight);var n=netLib.shareURL;""==n&&(n=assetLib.textData.langText.creating[curLang]);var l=Math.min(getDirectWidth(1,40,n),canvas.width-200)+40;if(ctx.fillStyle=r,ctx.fillRect(canvas.width/2-l/2,canvas.height/2+70-12,l,60),ctx.strokeStyle=i,ctx.lineWidth=2,ctx.strokeRect(canvas.width/2-l/2,canvas.height/2+70-12,l,60),addDirectText(1,40,canvas.width-200,"center",canvas.width/2,canvas.height/2+100,n,i),0==this.linkTextId)addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+40,"invite","#FFFFFF"),this.shareButOn&&addText(0,26,140,"center",canvas.width/2,canvas.height/2+320+this.butsY,"copyLink","#FFFFFF");else if(1==this.linkTextId){addText(0,50,canvas.width-200,"left",canvas.width/2-100,canvas.height/2+250,"linkSuccess","#00F981");var o=getSpriteData(assetLib.getData("uiElements"),"shareTick");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-100-60,canvas.height/2+250-40,o.bWidth,o.bHeight)}else 2==this.linkTextId&&addText(0,50,canvas.width-200,"center",canvas.width/2,canvas.height/2+70,"linkError","#FF5501");break;case"credits":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,80+this.butsY,"settings","#FFFFFF"),addText(0,23,canvas.width-100,"center",canvas.width/2,canvas.height-170+this.butsY,"createdBy","#ffffff");var m=assetLib.getData("info");ctx.drawImage(m.img,0,0,m.img.width,m.img.height,canvas.width/2-m.img.width/2,canvas.height-120-m.img.height/2+this.butsY,m.img.width,m.img.height),addText(0,23,canvas.width-110,"right",canvas.width-95,canvas.height-15+this.butsY,"reset","#ffffff");var h=.3*canvas.height;addText(0,50,canvas.width-100,"center",canvas.width/2,h+this.butsY,"careerSetting0","#FFFFFF"),addDirectText(0,50,canvas.width-100,"center",.5*canvas.width,h+this.butsY+81,this.twoDigit(saveDataHandler.getCareerGames()),"#FFFC01"),addText(0,50,canvas.width-100,"center",canvas.width/2,h+this.butsY+170,"careerSetting1","#FFFFFF"),addDirectText(0,50,canvas.width-100,"center",.5*canvas.width,h+this.butsY+81+170,this.twoDigit(saveDataHandler.getCareerSets()),"#FFFC01"),addDirectText(0,23,canvas.width/2,"center",canvas.width/2,canvas.height-15+this.butsY,"v2.0.1","#ffffff");break;case"resetConfirm":ctx.fillStyle="rgba(0, 0, 0, 0.65)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,60,canvas.width-100,"center",canvas.width/2,canvas.height/2-100+this.butsY,"resetConfirm0","#FFFFFF"),addText(0,40,canvas.width-100,"center",canvas.width/2,canvas.height/2-40+this.butsY,"resetConfirm1","#FCEA02");break;case"game":if(gameplayState>=3){var s=0;0==gameVariation?3==gameplayState||4==gameplayState?s=0:(5==gameplayState||6==gameplayState)&&(s=1):(1==gameVariation||2==gameVariation||3==gameVariation||4==gameVariation)&&(s=2);var d=assetLib.getData("fadeBg"+s);ctx.save(),ctx.globalAlpha=1-this.levelCompleteInc,ctx.translate(canvas.width/2,canvas.height/2),canvas.width>canvas.height?ctx.scale(canvas.width/canvas.height,1):ctx.scale(1,canvas.height/canvas.width),ctx.scale(1.62,1.62),ctx.rotate(.05*this.incY),ctx.drawImage(d.img,0,0,d.img.width,d.img.height,-d.img.width/2,-d.img.height/2,d.img.width,d.img.height),ctx.restore()}if(3==gameplayState||4==gameplayState){var u,c,g,p,$,v,h=Math.max(onScreenY-200,60)+120,I=this.twoDigit(curLevel+1);addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY),getText("level",0)+" "+I+" "+getText("complete",0),"#2E24B4"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY),getText("level",0)+" "+I+" "+getText("complete",0),"#FFFFFF");for(var b=0;b<5;b++){c=curLevel%levelsPerWorld>=b&&b==levelsPerWorld-1?curLevel%levelsPerWorld==b&&Math.sin(this.incY)>0?3:2:b==levelsPerWorld-1?2:curLevel%levelsPerWorld>=b?curLevel%levelsPerWorld==b&&Math.sin(this.incY)>0?0:1:0;var o=getSpriteData(assetLib.getData("uiElements"),"progressCup"+c),_=canvas.width/2+110*b-(levelsPerWorld/2-.5)*110;if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2,h+120-o.bHeight+200*this.levelCompleteInc,o.bWidth,o.bHeight),b<levelsPerWorld-1){var o=getSpriteData(assetLib.getData("uiElements"),"progressLine0");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2+55,h+120-o.bHeight-20+200*this.levelCompleteInc,o.bWidth,o.bHeight)}I=this.twoDigit(Math.floor(curLevel/levelsPerWorld)*levelsPerWorld+1+b),addDirectText(0,40,110,"center",_,h+160+200*this.levelCompleteInc,I,"#FFFFFF")}(curLevel+1)%levelsPerWorld==0?(g=this.twoDigit(aPointScores[1]),p=aPointScores[1]):(g=this.twoDigit(aPointScores[0]),p=aPointScores[0]),rewardGemTotal=2*p,addDirectText(0,150,canvas.width/2,"left",canvas.width/2-10,h+260+200*this.levelCompleteInc+45,g,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-85-o.bWidth/2*(1+.05*Math.sin(this.incY)),h-o.bHeight/2*(1-.05*Math.sin(this.incY))+250+200*this.levelCompleteInc,o.bWidth*(1+.05*Math.sin(this.incY)),o.bHeight*(1-.05*Math.sin(this.incY))),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-85,y:h+250+200*this.levelCompleteInc,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initLevelCompleteButs()}if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+250+200*this.levelCompleteInc,1*Math.random()+1,300,360*Math.random()*radian,20,1,200);aEffects.push(S)}4==gameplayState&&(this.incY,anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0?Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"batUnlocked","#FFFFFF"):(Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"nextLevel","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF")))}else if(5==gameplayState||6==gameplayState){var h=Math.max(onScreenY-200,60)+120,y=Math.floor((curLevel+1)/levelsPerWorld),I=this.twoDigit(y);addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY),getText("world",0)+" "+I+" "+getText("complete",0),"#0BFF3C"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY),getText("world",0)+" "+I+" "+getText("complete",0),"#FFFFFF");var u=Math.min((canvas.height-500)/400,1);if(this.renderBat(batUnlockedId,canvas.width/2,h+270*u,u*this.batScale),Math.random()>.5){var S=new e.Particle(canvas.width/2,h+270*u,1*Math.random()+1,300,360*Math.random()*radian,20,1,100);aEffects.push(S)}6==gameplayState&&(addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),addText(0,40,canvas.width,"center",canvas.width/2,h+60+200*this.levelCompleteInc,"batUnlocked","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"nextLevel","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,40,100,"center",canvas.width-90,canvas.height-290,"new","#FFFFFF"))}else if(gameplayState>=7&&gameplayState<9){var h=Math.max(onScreenY-200,60)+30;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}if(addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc,"targetsHit","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175,this.twoDigit(curTargetScore),"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175,this.twoDigit(curTargetScore),"#FFFFFF"),curTargetScore>localTargetHighscore?addText(0,50,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340,"newBest","#FFFC01"):(addText(0,30,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340-25,"best","#FFFC01"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340+38,this.twoDigit(saveDataHandler.getBestTargetScore()),"#FFFC01")),Math.round(curTargetScore/2)>0){addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY),this.twoDigit(Math.round(curTargetScore/2)),"#FFFFFF");var $,v,o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY),o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initTargetGameEndButs()}}8==gameplayState&&(Math.round(curTargetScore/2)>0?(rewardGemTotal=2*Math.round(curTargetScore/2),Math.sin(this.incY)>0&&rewardButHit):addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"tryAgain","#FFFFFF"))}else if(gameplayState>=9&&gameplayState<11){var F,$,v,h=Math.max(onScreenY-200,60)+120;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}userSets>enemySets?addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youWon","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youLost","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175-30,userSets+"-"+enemySets,"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175-30,userSets+"-"+enemySets,"#FFFFFF"),rankChange>0?addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+300,getText("rank",0)+" +"+rankChange,"#FFFC01"):rankChange<0&&addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+300,getText("rank",0)+" "+rankChange,"#A34522"),F=userSets>enemySets?50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():25,addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY)-30,this.twoDigit(F),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY)-30,o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initCustomGameEndButs()}10==gameplayState&&(rewardGemTotal=userSets>enemySets?(50+10*saveDataHandler.getSeason()+saveDataHandler.getRound())*2:50,this.incY,addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"next","#FFFFFF"))}else if(gameplayState>=11&&gameplayState<13){var h=Math.max(onScreenY-200,60)+30;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}if(addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc,"bugsHit","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175,this.twoDigit(bugScore),"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175,this.twoDigit(bugScore),"#FFFFFF"),bugScore>localTargetHighscore?addText(0,50,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340,"newBest","#FFFC01"):(addText(0,30,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340-25,"best","#FFFC01"),addDirectText(0,75,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+340+38,this.twoDigit(saveDataHandler.getBestBugScore()),"#FFFC01")),Math.ceil(bugScore/4)>0){addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY),this.twoDigit(Math.ceil(bugScore/4)),"#FFFFFF");var $,v,o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY),o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initBugGameEndButs()}}12==gameplayState&&(Math.ceil(bugScore/4)>0?(rewardGemTotal=2*Math.ceil(bugScore/4),Math.sin(this.incY)>0&&rewardButHit):addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"arcadeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"pvpBut","#FFFFFF"),Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"tryAgain","#FFFFFF"))}else if(gameplayState>=13&&gameplayState<15){var F,$,v,h=Math.max(onScreenY-200,60)+120;if(Math.random()>.5){var S=new e.Particle(canvas.width/2,h+100,1*Math.random()+1,300,360*Math.random()*radian,20,1,125);aEffects.push(S)}userScore>enemyScore?addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youWon","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,h+200*this.levelCompleteInc-30,"youLost","#FFFFFF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+3+5*Math.sin(this.incY)+175-30,userScore+"-"+enemyScore,"#F658FF"),addDirectText(0,200,canvas.width-100,"center",canvas.width/2,h+200*this.levelCompleteInc+5*Math.sin(this.incY)+175-30,userScore+"-"+enemyScore,"#FFFFFF"),F=userScore>enemyScore?userScore+25:enemyScore,addDirectText(0,75,canvas.width/2,"left",canvas.width/2,h+200*this.levelCompleteInc+200+50+5*Math.sin(this.incY)-30,this.twoDigit(F),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth,h+200*this.levelCompleteInc+190+5*Math.sin(this.incY)-30,o.bWidth,o.bHeight),this.winGemCount-=35*delta,this.winGemCount<this.winGemTarg&&this.winGemCount>0){this.winGemTarg-=1;var B={x:canvas.width/2-25,y:h+200*this.levelCompleteInc+190+25,inc:1};this.aWinGems.push(B),$=.5*this.winGemCount,v=125+200*Math.random(),TweenLite.to(B,.25,{x:B.x+v*Math.cos($),y:B.y+v*Math.sin($),ease:"Quad.easeOut",onCompleteParams:[B],onComplete:function(e){D=a.twoDigit(gems),TweenLite.to(e,.5,{x:canvas.width-getDirectWidth(0,75,D)-95+27,y:canvas.height-80+25,inc:0,ease:"Quad.easeIn",onComplete:function(){gems++,playSound("gem"+Math.floor(5*Math.random()),.3)}})}})}for(var b=0;b<this.aWinGems.length;b++)if(this.aWinGems[b].inc>0){var o=getSpriteData(assetLib.getData("uiElements"),"bigGem");u=.5+.5*this.aWinGems[b].inc,ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,this.aWinGems[b].x-o.bWidth/2,this.aWinGems[b].y-o.bHeight/2,o.bWidth*u,o.bHeight*u)}else{for(var f=360*Math.random()*radian,w=0;w<5;w++){var S=new e.Particle(this.aWinGems[b].x,this.aWinGems[b].y,1*Math.random()+1,300,f+72*w*radian,20,1,50);aEffects.push(S)}this.aWinGems.splice(b,1),b-=1,this.aWinGems.length<=0&&initPvpGameEndButs()}14==gameplayState&&Math.sin(this.incY)>0&&addText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,"playAgain","#FFFFFF")}var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20+this.butsY,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80+this.butsY,o.bWidth,o.bHeight),0==gameplayState||0==gameVariation&&1==gameplayState){addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(curLevel+1),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallCup");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight)}if(0==gameplayState){saveDataHandler.getLevel()>0?canvas.width/canvas.height<.6?(addText(0,26,140,"center",canvas.width/2+160,canvas.height-250+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2+320,canvas.height-250+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2-160,canvas.height-250+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2,canvas.height-250+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",canvas.width/2,canvas.height-250+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",canvas.width/2-320,canvas.height-250+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width/2+320,canvas.height-250-90+this.butsY,"pvpBut","#FFFFFF")):(addText(0,26,140,"center",canvas.width-90,canvas.height-390+90+this.butsY,"awardsBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"batCollectionBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-390+90+this.butsY,"challengeBut","#FFFFFF"),addText(0,26,140,"center",90,canvas.height-210+90+this.butsY,"careerBut","#FFFFFF"),addDirectText(0,26,140,"center",90,canvas.height-210+90+this.butsY+23,"rank "+this.twoDigit(saveDataHandler.getRank()),"#FFFC01"),addText(0,26,140,"center",90,canvas.height-570+90+this.butsY,"bugGameBut","#FFFFFF"),addText(0,26,140,"center",canvas.width-90,canvas.height-570+90+this.butsY,"pvpBut","#FFFFFF")):canvas.width/canvas.height<.6?addText(0,26,140,"center",canvas.width/2+320,canvas.height-250+90+this.butsY,"pvpBut","#FFFFFF"):addText(0,26,140,"center",canvas.width-90,canvas.height-210+90+this.butsY,"pvpBut","#FFFFFF"),ctx.beginPath(),ctx.arc(canvas.width/2,onScreenY+340,12*this.incY%75.7+25,0,2*Math.PI,!1),ctx.lineWidth=Math.max((75.7-12*this.incY%75.7)*.2,1),ctx.strokeStyle="#FFFFFF",ctx.stroke();var o=getSpriteData(assetLib.getData("uiElements"),"startFinger");ctx.save(),ctx.translate(canvas.width/2+180,onScreenY+320),ctx.rotate(.5*Math.abs(Math.sin(.5*this.incY))-100*radian),ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,-o.bWidth/2,-(.75*o.bHeight),o.bWidth,o.bHeight),ctx.restore(),this.disconnectInc>0&&(addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc)+3,this.errorText,"#000000"),Math.sin(this.incY)>0?addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc),this.errorText,"#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,canvas.height*(.2*this.disconnectInc),this.errorText,"#FFFF00"))}else if(gameplayState<5&&0==gameVariation)for(var b=0;b<levelStarTarg;b++){var s=0;curLevelStars>b&&(s=1);var o=getSpriteData(assetLib.getData("uiElements"),"star"+s);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2+70*b-70*(levelStarTarg/2-.5)-100*this.starsX,Math.max(onScreenY-200,60)-o.bWidth/2-100*this.starsY,o.bWidth,o.bHeight)}if(1==gameVariation&&1==gameplayState){addText(0,30,canvas.width/2,"left",24,canvas.height-85+this.butsY,"best","#FFFFFF"),addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(localTargetHighscore),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"targetIcon");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight),addDirectText(0,120,canvas.width/2,"center",canvas.width/2,Math.max(onScreenY-170,100)-10*this.starsY,this.twoDigit(curTargetScore),"#FFFFFF")}else if(2==gameVariation&&1==gameplayState){var o=getSpriteData(assetLib.getData("uiElements"),"setsBg");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-o.bWidth/2,Math.max(onScreenY-170,100)-10*this.starsY-83,o.bWidth,o.bHeight),addDirectText(0,120,canvas.width/2,"right",canvas.width/2-50,Math.max(onScreenY-170,100)-10*this.scoreSideY0,userScore.toString(),"#FFFFFF"),addDirectText(0,50,canvas.width/2,"center",canvas.width/2-21,Math.max(onScreenY-170,100)-10*this.starsY-41,userSets.toString(),"#FFFC01"),addDirectText(0,120,canvas.width/2,"left",canvas.width/2+50,Math.max(onScreenY-170,100)-10*this.scoreSideY1,enemyScore.toString(),"#FFFFFF"),addDirectText(0,50,canvas.width/2,"center",canvas.width/2+21,Math.max(onScreenY-170,100)-10*this.starsY-41,enemySets.toString(),"#FFFC01");var o=getSpriteData(assetLib.getData("flags"),"flag"+aSeasonFlags[saveDataHandler.getRound()].id),u=1;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,65-o.bWidth/2*u,canvas.height-65-o.bHeight/2*u,o.bWidth*u,o.bHeight*u)}else if(4==gameVariation&&1==gameplayState){ctx.save(),ctx.translate(canvas.width/2+20,Math.max(onScreenY-170,100)-83+45-10*this.scoreSideY0),ctx.scale(.31,.31),ctx.rotate(45*radian);var x,H=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,A=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,T=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,G=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,H,A,T,G,-T/2,-G/2,T,G),ctx.restore(),ctx.save(),ctx.translate(canvas.width/2-20,Math.max(onScreenY-170,100)-83+45-10*this.scoreSideY0),ctx.scale(.31,.31),ctx.rotate(-45*radian);var H=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].x,A=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].y,T=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].width,G=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+curBat]].height;if(ctx.drawImage(this.oGameElementsImgData.img,H,A,T,G,-T/2,-G/2,T,G),ctx.restore(),addDirectText(0,120,canvas.width/2,"right",canvas.width/2-65,Math.max(onScreenY-170,100)-10*this.scoreSideY0,userScore.toString(),"#FFFFFF"),addDirectText(0,120,canvas.width/2,"left",canvas.width/2+65,Math.max(onScreenY-170,100)-10*this.scoreSideY1,enemyScore.toString(),"#FFFFFF"),saveDataHandler.getPvpWins()>0){x=getDirectWidth(0,120,userScore.toString());var o=getSpriteData(assetLib.getData("uiElements"),"crown");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2-75-x-+getDirectWidth(0,55,saveDataHandler.getPvpWins().toString())/2-o.bWidth/2,Math.max(onScreenY-170,100)-83-10*this.scoreSideY0,o.bWidth,o.bHeight),addDirectText(0,55,canvas.width/2,"right",canvas.width/2-75-x,Math.max(onScreenY-170,100)-10-10*this.scoreSideY0,saveDataHandler.getPvpWins().toString(),"#FFFF00")}if(opPvpWins>0){x=getDirectWidth(0,120,enemyScore.toString());var o=getSpriteData(assetLib.getData("uiElements"),"crown");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2+75+x+getDirectWidth(0,55,opPvpWins.toString())/2-o.bWidth/2,Math.max(onScreenY-170,100)-83-10*this.scoreSideY0,o.bWidth,o.bHeight),addDirectText(0,55,canvas.width/2,"left",canvas.width/2+75+x,Math.max(onScreenY-170,100)-10-10*this.scoreSideY0,opPvpWins.toString(),"#FFFF00")}this.pvpStartInc<1&&(addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc+3,"gameOn","#000000"),Math.sin(2*this.incY)>0?addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc,"gameOn","#FFFF00"):addText(0,100,canvas.width-200,"center",canvas.width/2,tableTop.netY+75-500*this.pvpStartInc,"gameOn","#FFFFFF")),addDirectText(1,30,canvas.width/2,"left",10,canvas.height-20,"Ping: "+getText("latency"+this.getLatencyStatus(netLib.peer.latency.average),1)+" ("+Math.round(netLib.peer.latency.average)+"ms)","#FFFFFF")}else if(3==gameVariation&&1==gameplayState){if(addText(0,30,canvas.width/2,"left",24,canvas.height-85+this.butsY,"best","#FFFFFF"),addDirectText(0,120,canvas.width/2,"right",canvas.width/2+30,Math.max(onScreenY-170,100)-10*this.starsY,this.twoDigit(bugScore),"#FFFFFF"),bugTime<bugTimeTarg&&(bugTime+=delta)>=bugTimeTarg&&initBugGameEnd(),bugTime<bugTimeTarg-5||Math.sin(this.incY)>0){var o=getSpriteData(assetLib.getData("uiElements"),"stopWatch");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width/2+45,Math.max(onScreenY-170,100)-83,o.bWidth,o.bHeight);var x=canvas.width/2+45+35.5,k=Math.max(onScreenY-170,100)-83+46.5;ctx.fillStyle="#FFFFFF",ctx.beginPath(),ctx.moveTo(x,k),ctx.arc(x,k,25,-.5*Math.PI,2*Math.PI/bugTimeTarg*bugTime-.5*Math.PI),ctx.lineTo(x,k),ctx.fill()}addDirectText(0,75,canvas.width/2,"left",90,canvas.height-20+this.butsY,this.twoDigit(localTargetHighscore),"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"bugIcon");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,24,canvas.height-77+this.butsY,o.bWidth,o.bHeight),this.bugTimeY<1&&addDirectText(0,50,canvas.width/2,"left",canvas.width/2+125,Math.max(onScreenY-170,100)-23+100*this.bugTimeY,"+"+bugBonusTime+" SECS","#FFFFFF")}1==netLib.connectState&&(ctx.fillStyle="rgba(0, 0, 0, 0.75)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height+3,"connecting","#000000"),Math.sin(this.incY)>0?addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height,"connecting","#FFFFFF"):addText(0,75,canvas.width-350,"center",canvas.width/2,.5*canvas.height,"connecting","#FFFF00"));break;case"batShop":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,75,canvas.width-350,"center",canvas.width/2,75,"batCollection","#FFFFFF");var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80,o.bWidth,o.bHeight);break;case"awards":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);for(var b=0;b<16;b++){var s=16;1==saveDataHandler.getAwardState(b)&&(s=b);var o=getSpriteData(assetLib.getData("awards"),"award"+s),_=canvas.width/2-285+b%4*190,h=canvas.height/2+70-400+199*Math.floor(b/4)+this.posY,u=.9;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2*u,h-o.bHeight/2*u,o.bWidth*u,o.bHeight*u);for(var C=getMultiLineTextByChars("awardInfo"+b,16,1),w=0;w<C.length;w++)addDirectText(1,25,200,"center",_,h+93+25*w,C[w],"#FFFFFF")}break;case"mapScreen":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height);var o=getSpriteData(assetLib.getData("uiElements"),"map"),E=o.bWidth/2,Y=aFlags[aSeasonFlags[saveDataHandler.getRound()].id].x,L=aFlags[aSeasonFlags[saveDataHandler.getRound()].id].y,u=Math.min(1,canvas.width/o.bWidth)*this.mapScale,_=canvas.width/2-Y*u*this.mapPos*E,h=.5*canvas.height-L*u*this.mapPos*E+800/canvas.height*70*this.mapPos;ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_-o.bWidth/2*u,h-o.bHeight/2*u,o.bWidth*u,o.bHeight*u),ctx.strokeStyle="#FFFFFF",ctx.lineWidth=5*u,ctx.setLineDash([10*u,5*u]),ctx.lineCap="butt";for(var b=1;b<aSeasonFlags.length;b++){var P=_+aFlags[aSeasonFlags[b-1].id].x*E*u,W=h+aFlags[aSeasonFlags[b-1].id].y*E*u,O=_+aFlags[aSeasonFlags[b].id].x*E*u,X=h+aFlags[aSeasonFlags[b].id].y*E*u;b<=saveDataHandler.getRound()&&(ctx.beginPath(),ctx.moveTo(P,W),ctx.quadraticCurveTo(P+(O-P)/2,W+(X-W)/2-100*u,O,X),ctx.stroke())}ctx.setLineDash([]);for(var b=0;b<aSeasonFlagsRender.length;b++){var M,V=1,R=0;aSeasonFlagsRender[b].aSeasonFlagsIndex<saveDataHandler.getRound()?M=2:aSeasonFlagsRender[b].aSeasonFlagsIndex>saveDataHandler.getRound()?M=1:0==this.mapState?M=1:this.mapState>0&&(M=0,V=this.mapPinScale,R=29);var o=getSpriteData(assetLib.getData("uiElements"),"pin"+M);if(ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E-o.bWidth/2*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-o.bHeight*V+R)*u,o.bWidth*u*V,o.bHeight*u*V),0==M){var o=getSpriteData(assetLib.getData("flags"),"flag"+aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id);ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E-(o.bWidth/2+43)*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-(o.bHeight/2+91)*V)*u,o.bWidth*u*V,o.bHeight*u*V),addText(0,28*u*V,canvas.width-350,"center",_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E+43*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-95*V)*u,"rank","#333333"),addDirectText(0,37*u*V,canvas.width-350,"center",_+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].x*E+43*V)*u,h+(aFlags[aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].id].y*E-65*V)*u,this.twoDigit(aSeasonFlags[aSeasonFlagsRender[b].aSeasonFlagsIndex].rank),"#333333")}}if(2==this.mapState&&(Math.sin(this.incY)>0&&(addDirectText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY+3,getText("playRound",0)+" "+(saveDataHandler.getRound()+1),"#333333"),addDirectText(0,50,canvas.width-100,"center",canvas.width/2,.7*canvas.height+200+this.butsY,getText("playRound",0)+" "+(saveDataHandler.getRound()+1),"#FFFFFF")),Math.random()>.5)){var S=new e.Particle(canvas.width/2,.45*canvas.height,1*Math.random()+1,300,360*Math.random()*radian,20,1,200);aEffects.push(S)}addDirectText(0,75,canvas.width-350,"center",canvas.width/2,78,getText("season",0)+" "+(saveDataHandler.getSeason()+1),"#333333"),addDirectText(0,75,canvas.width-350,"center",canvas.width/2,75,getText("season",0)+" "+(saveDataHandler.getSeason()+1),"#FFFFFF"),addText(0,35,canvas.width-350,"center",canvas.width/2,123,"rank","#333333"),addText(0,35,canvas.width-350,"center",canvas.width/2,120,"rank","#FFFC01"),addDirectText(0,50,canvas.width-350,"center",canvas.width/2,166,this.twoDigit(saveDataHandler.getRank()),"#333333"),addDirectText(0,50,canvas.width-350,"center",canvas.width/2,163,this.twoDigit(saveDataHandler.getRank()),"#FFFC01");var D=this.twoDigit(gems);addDirectText(0,75,canvas.width/2,"right",canvas.width-25,canvas.height-20+this.butsY,D,"#FFFFFF");var o=getSpriteData(assetLib.getData("uiElements"),"smallGem");ctx.drawImage(o.img,o.bX,o.bY,o.bWidth,o.bHeight,canvas.width-getDirectWidth(0,75,D)-95,canvas.height-80+this.butsY,o.bWidth,o.bHeight);break;case"pause":ctx.fillStyle="rgba(0, 0, 0, 0.5)",ctx.fillRect(0,0,canvas.width,canvas.height),addText(0,40,canvas.width/2,"center",canvas.width/2,canvas.height/2-110+110+this.butsY,"continue","#FFFFFF"),addText(0,40,canvas.width/2,"center",canvas.width/2,canvas.height/2+110+110+this.butsY,"quit","#FFFFFF")}this.congratsUpdate(),t&&this.addButs()},t.prototype.getLatencyStatus=function(e){return e<=50?0:e<=100?1:e<=180?2:e<=230?3:4},t.prototype.renderPointer=function(){},t.prototype.renderBat=function(e,t,a,s){void 0===s&&(s=1),this.batRotation=5*Math.sin(.05*this.incY),this.batSpin=Math.sin(.5*this.incY),ctx.save(),ctx.translate(t,a),ctx.rotate(this.batRotation),ctx.scale(s*this.batSpin,s);var i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].x,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].y,o=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].width,n=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+e]].height;ctx.drawImage(this.oGameElementsImgData.img,i,r,o,n,-o/2,-n/2,o,n),ctx.restore()},t.prototype.twoDigit=function(e){var t=e.toString();return t.length<2&&(t="0"+t),t},t.prototype.flare=function(e,t,a,s,i){this.flareRot+=delta/2,ctx.save(),ctx.translate(e,t),ctx.scale(a,s),ctx.rotate(this.flareRot);var r=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].x,o=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].y,n=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].width,l=this.oUiElementsImgData.oData.oAtlasData[oImageIds["flare"+i]].height;ctx.drawImage(this.oUiElementsImgData.img,r,o,n,l,-n/2,-l/2,n,l),ctx.rotate(-(2*this.flareRot)),ctx.drawImage(this.oUiElementsImgData.img,r,o,n,l,-n/2,-l/2,n,l),ctx.restore()},t.prototype.addButs=function(){for(var e=!1,t=0;t<this.aButs.length;t++)if(this.aButs[t].isOver){e=!0;break}for(var t=0;t<this.aButs.length;t++){var a,s,i,r,o=0,n=0;0!=this.incY&&this.aButs[t].flash&&(n=this.aButs[t].isOver?3*Math.sin((this.incY+2.5*t)*2):3*Math.sin(this.incY+2.5*t)),this.aButs[t].scale||(this.aButs[t].scale=1),a=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].x,s=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].y,i=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].width,r=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].id].height;var l=canvas.width*this.aButs[t].align[0],m=canvas.height*this.aButs[t].align[1];this.aButs[t].noTween||(o=m+this.aButs[t].aPos[1]>.1*canvas.height?this.butsY:-this.butsY),this.aButs[t].aOverData=[l+this.aButs[t].aPos[0]-i/2*this.aButs[t].scale-n/2,m+this.aButs[t].aPos[1]-r/2*this.aButs[t].scale+o+n/2,l+this.aButs[t].aPos[0]+i/2*this.aButs[t].scale-n/2,m+this.aButs[t].aPos[1]+r/2*this.aButs[t].scale+o+n/2],this.aButs[t].isOver&&this.aButs[t].flash&&(ctx.save(),ctx.translate(l+this.aButs[t].aPos[0],m+this.aButs[t].aPos[1]),ctx.scale(.65+n/50,.65+n/50),ctx.globalAlpha=1,ctx.rotate(this.incY/7),ctx.drawImage(this.oTopFlareImgData.img,-this.oTopFlareImgData.img.width/2,-this.oTopFlareImgData.img.height/2),ctx.restore()),ctx.drawImage(this.aButs[t].oImgData.img,a,s,i,r,this.aButs[t].aOverData[0],this.aButs[t].aOverData[1],i*this.aButs[t].scale+n,r*this.aButs[t].scale-n),(this.aButs[t].isOver||this.aButs[t].flash)&&(ctx.save(),this.aButs[t].isOver?ctx.globalAlpha=1:e?ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0)/2:ctx.globalAlpha=Math.max(Math.sin(this.incY/2),0),a=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].x,s=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].y,i=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].width,r=this.aButs[t].oImgData.oData.oAtlasData[this.aButs[t].idOver].height,ctx.drawImage(this.aButs[t].oImgData.img,a,s,i,r,this.aButs[t].aOverData[0],this.aButs[t].aOverData[1],i*this.aButs[t].scale+n,r*this.aButs[t].scale-n),ctx.restore()),this.aButs[t].id==oImageIds.rewardMultiplyBut&&addDirectText(0,50,125,"center",this.aButs[t].aOverData[0]+125,this.aButs[t].aOverData[1]+153,"+"+this.twoDigit(rewardGemTotal),"#FFFFFF")}},t}();e.Panel=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.inc=0,this.startX=0,this.startY=0,this.startRotation=0,this.startInc=0,this.incY=0,this.celebrateY=0,this.flipInc=0,this.flipX=Math.PI,this.flipY=1,this.tutState=0,this.tutY=0,this.prevTutY=0,this.tutInc=0,this.oGameElementsImgData=assetLib.getData("gameElements"),this.targX=canvas.width/2,this.targY=canvas.height-150,this.batSpreadX=1,this.batSpreadY=1,this.batSpreadMultiplier=.03,this.reset()}return e.prototype.reset=function(){this.celebrateY=0,this.flipInc=0},e.prototype.levelComplete=function(){this.autotween&&this.autotween.kill(),this.startY=this.y,setTimeout(function(){initLevelComplete()},1e3),this.flip()},e.prototype.flip=function(){var e;this.incY=0,e=0==this.flipInc?720:this.flipInc%2==0?360:0,this.flipInc++,this.autotween=TweenLite.to(this,1,{incY:180*radian,rotation:e*radian,x:canvas.width/2,y:onScreenY+355,ease:"none",onComplete:function(){}})},e.prototype.startHit=function(){var e=this;this.x=this.prevX=this.startX=canvas.width/2,this.y=this.prevY=this.startY=onScreenY+355,this.rotation=this.startRotation=0,this.startInc=1,TweenLite.to(this,.1,{startY:onScreenY+200,ease:"Cubic.easeOut",onComplete:function(){e.y=e.prevY=e.startY,TweenLite.to(e,.5,{startInc:0,ease:"Cubic.easeInOut"})}})},e.prototype.successFlip=function(){var e=this;this.flipTween&&this.flipTween.kill(),this.flipX=Math.PI,this.flipTween=TweenLite.to(this,1,{flipX:4*Math.PI,ease:"Quad.easeOut",onComplete:function(){e.flipX=Math.PI}})},e.prototype.update=function(){0==gameplayState?(this.inc+=delta,this.x=canvas.width/2+30*Math.sin(3*this.inc),this.y=onScreenY+355+10*Math.sin(10*this.inc),this.rotation=.1*Math.sin(3*this.inc)):gameplayState>=2?(this.celebrateY=-300*Math.sin(this.incY),this.maxY=onScreenY+200/tableTop.segs*(.28*tableTop.segs)*(1+tableTop.offsetY/3)+50*tableTop.offsetY,this.scale=.44+(this.y-this.maxY)/550):1==gameplayState&&(this.maxY=onScreenY+200/tableTop.segs*(.28*tableTop.segs)*(1+tableTop.offsetY/3)+50*tableTop.offsetY,this.prevX=this.x,this.prevY=this.y,this.x=this.startX*this.startInc+this.targX*(1-this.startInc),this.y=this.startY*this.startInc+Math.max(this.targY,this.maxY)*(1-this.startInc),this.rotation=Math.max(Math.min((this.x-canvas.width/2)/200,90*radian),-90*radian),this.scale=.44+(this.y-this.maxY)/550,1==this.tutState&&(this.tutInc+=delta,this.tutInc>3&&(this.tutState=2,this.tutInc=0)))},e.prototype.getHitData=function(e,t){var a=Math.max(Math.min((this.prevY-this.y)/delta,4500)/4500,0);this.hitY=(1-a)*.4;var s=(this.x-this.prevX)/delta/2e3;return this.hitX=Math.max(Math.min(s+e,1-Math.min(.2*e,0)),-1-Math.max(.2*e,0)),{x:this.hitX,y:this.hitY,speed:(.3+.3/.4*(.4-this.hitY))*.9,spin:0}},e.prototype.render=function(){if(1==gameplayState&&2==this.tutState&&(this.tutInc+=delta,ctx.save(),this.prevTutY=this.tutY,this.tutY=Math.abs(Math.sin(5*this.tutInc)),this.prevTutY<this.tutY)){var e=Math.max(this.y-aBalls[curBallId].y+100,200);ctx.translate(this.x+(canvas.width/2-this.x)*this.tutY*.3,this.y-(20-this.celebrateY)*this.scale-this.tutY*e),ctx.scale(this.scale*(1-.3*this.tutY),this.scale*Math.min(1-(this.y-.5*canvas.height)/(.5*canvas.height)*.3,1)*(1-.3*this.tutY)),ctx.rotate(this.rotation),ctx.globalAlpha=1-this.tutY*this.tutY;var t=0,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.restore()}ctx.save(),ctx.translate(this.x,this.y-(20-this.celebrateY)*this.scale),ctx.scale(this.scale,this.scale*Math.min(1-(this.y-.5*canvas.height)/(.5*canvas.height)*.3,1)),ctx.rotate(this.rotation);var o=curBat,t=0;o>=49&&(t=o);var a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["batBehind"+t]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.rotate(-this.rotation),ctx.translate(0,Math.min(7*Math.max((this.y-.5*canvas.height)/(.5*canvas.height),0),7)),ctx.rotate(this.rotation);var a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].x,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].y,i=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].width,r=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+o]].height;ctx.drawImage(this.oGameElementsImgData.img,a,s,i,r,-i/2*(1-Math.abs(Math.sin(this.flipX))),-r/3,i*(1-Math.abs(Math.sin(this.flipX))),r),ctx.restore()},e}();e.UserBat=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.speedX=3e3,this.maxAcc=500,this.skillLevel=0,this.powerLevel=0,this.spinLevel=0,this.id=0,this.aEases=["Quad.easeInOut","Back.easeOut","Cubic.easeOut","Back.easeInOut"],this.trackBall=!0,this.slideInc=0,this.flailInc=0,this.inc=0,this.incY=0,this.celebrateY=0,this.firstShot=!0,this.scoreDiff=0,this.flipX=1,this.flipY=1,this.swipeOffsetX=0,this.scoreDiffMax=.25,this.oGameElementsImgData=assetLib.getData("gameElements"),this.x=canvas.width/2,this.targX=0,this.targY=0,this.accX=0}return e.prototype.setEnemyLevel=function(){if(0==gameVariation)this.skillLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/30,.8)+this.scoreDiff,0),1),this.powerLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/20,.8)+this.scoreDiff,0),1),this.spinLevel=Math.min(Math.max(.2*Math.random()+Math.min(curLevel/20,.8)+this.scoreDiff,0),1);else if(2==gameVariation){var e=(500-Math.min(aSeasonFlags[saveDataHandler.getRound()].rank,500))/500*.6;this.skillLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1),this.powerLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1),this.spinLevel=Math.min(Math.max(.2+.2*Math.random()+e+this.scoreDiff,0),1)}},e.prototype.reset=function(){this.celebrateY=0,this.scoreDiff=0},e.prototype.levelComplete=function(){this.autotween&&this.autotween.kill(),this.incY=0,this.autotween=TweenLite.to(this,2,{rotation:360*radian,incY:180*radian,scale:0,ease:"Quad.easeOut",onComplete:function(){}})},e.prototype.resetToCentre=function(){this.trackBall=!1,this.moveTween&&this.moveTween.kill(),this.targX=this.x-canvas.width/2,this.moveTween=TweenLite.to(this,1,{targX:0,targY:0,ease:"Quad.easeInOut",onComplete:function(){(0==gameVariation||2==gameVariation)&&"enemy"==aBalls[curBallId].lastHit&&aBalls[curBallId].enemyServe()}})},e.prototype.flail=function(){var e=this;this.flailInc=0;var t=1;aBalls[curBallId].x<this.x&&(t=-1),TweenLite.to(this,.5,{flailInc:t,ease:"Quad.easeInOut",onComplete:function(){TweenLite.to(e,.5,{flailInc:0,ease:"Quad.easeInOut"})}})},e.prototype.setBouncePos=function(e,t,a){var s=this;if(this.moveTween&&this.moveTween.kill(),(0==a||1*Math.random()<.25)&&1!=aBalls[curBallId].servingState){this.trackBall=!1;var i=0;1*Math.random()>.75+.25*this.skillLevel&&(i=100*Math.random()-50);var r=t*t*tableDepth*(1+tableTop.offsetY/2)/2,o=r*(tableTop.offsetX+.6*e)*num128*(1+tableTop.offsetY/2)+e*tableBackWidth/2+100*a;this.moveTween=TweenLite.to(this,.6*Math.random()+.5+(1-this.skillLevel)*.75,{delay:.2*Math.random(),targX:o+i,targY:r,ease:this.aEases[Math.floor(Math.random()*this.aEases.length)],onComplete:function(){"enemy"==aBalls[curBallId].lastHit&&(s.moveTween=TweenLite.to(s,.6*Math.random()+.5+(1-s.skillLevel)*.75,{delay:.6*Math.random()*(1+(1-s.skillLevel)*1),targX:200*Math.random()-100,targY:0,ease:"Quad.easeInOut"}))}})}else this.trackBall=!0,this.slideInc=0,this.moveTween=TweenLite.to(this,(.6*Math.random()+.5)*(1+(1-this.skillLevel)*1),{targY:0,ease:"Quad.easeInOut"})},e.prototype.successFlip=function(){var e=this;this.swipeTween&&this.swipeTween.kill(),this.flipX=1,this.swipeTween=TweenLite.to(this,.5,{flipX:-1,ease:"Bounce.easeInOut",onComplete:function(){e.flipX=1}})},e.prototype.hitSwipe=function(){var e,t,a=this;this.swipeTween&&this.swipeTween.kill(),this.swipeOffsetX=0,Math.random()>.5?(e=.8+.2*Math.random(),t=1):(e=1,t=.8+.2*Math.random()),this.swipeTween=TweenLite.to(this,.1,{swipeOffsetX:100*Math.random()-50,flipX:e,flipY:t,ease:"Cubic.easeOut",onComplete:function(){a.swipeTween=TweenLite.to(a,.5,{swipeOffsetX:0,flipX:1,flipY:1,ease:"Back.easeOut",onComplete:function(){}})}})},e.prototype.update=function(){0==gameplayState?(this.inc+=delta,this.y=this.targY+onScreenY+50*tableTop.offsetY-50,this.x=canvas.width/2+50*Math.sin(5*this.inc),this.rotation=.3*Math.sin(5*this.inc),this.scale=.4+(this.y-onScreenY)/300):2==gameplayState?this.celebrateY=-50*Math.sin(this.incY):1==gameplayState&&(this.y=this.targY+onScreenY+50*tableTop.offsetY-50,this.trackBall?(this.slideInc=(aBalls[curBallId].x-this.x)*(15*this.skillLevel+10),this.x+=this.slideInc*delta,"enemy"==aBalls[curBallId].lastHit&&(this.targX=this.x-canvas.width/2,this.moveTween=TweenLite.to(this,(.6*Math.random()+.5)*(1+(1-this.skillLevel)*1),{delay:.6*Math.random()*(1+(1-this.skillLevel)*1),targX:200*Math.random()-100,targY:0,ease:"Quad.easeInOut"}),this.trackBall=!1)):this.x=this.targX+canvas.width/2,this.rotation=(this.x-canvas.width/2)/200,this.scale=.4+(this.y-onScreenY)/300,this.x=Math.min(Math.max(this.x,canvas.width/2-250),canvas.width/2+250))},e.prototype.getHitData=function(e,t){0==aBalls[curBallId].servingState?(this.hitX=2*Math.random()-1,this.hitY=.2*Math.random()+.65):(this.hitX=(1.8*Math.random()-.9)*(1+.25*this.skillLevel),Math.random()>.8+.2*this.skillLevel&&(this.x>canvas.width/2+120||this.x<canvas.width/2-120)&&(this.x>canvas.width/2?this.hitX=1.3:this.hitX=-1.3),this.hitY=.4*Math.random()+.65);var a=0;this.hitY<.95&&(this.hitX>.1?a=-(.5*Math.random()+.5)*this.spinLevel:this.hitX<-.1&&(a=(.5*Math.random()+.5)*this.spinLevel));var s=.3+.3/.4*(this.hitY-.6)*(.25+.9*this.powerLevel);return this.hitSwipe(),{x:this.hitX,y:this.hitY,speed:s,spin:a}},e.prototype.render=function(){ctx.save(),ctx.translate(this.x+(tableTop.offsetX+1*this.flailInc)*tableTop.sideMultiplier,this.y+this.celebrateY),ctx.rotate(this.rotation+1*this.flailInc),ctx.scale(this.scale*this.flipX,this.scale*this.flipY);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,-a/2+this.swipeOffsetX,-s/3,a,s),ctx.restore()},e}();e.EnemyBat=t}(Elements||(Elements={})),function(e){var t=function(){function t(e){void 0===e&&(e="user"),this.x=0,this.y=0,this.height=0,this.tablePosY=.5,this.tablePosX=0,this.scale=0,this.lastHit="user",this.speed=.45,this.offTable=!1,this.pause=!1,this.spin=0,this.spinInc=0,this.servingState=0,this.canHit=!1,this.serveFlip=!0,this.offSide=!1,this.bounceX=0,this.bounceY=0,this.ballShortState=0,this.ballType=0,this.hitStop=!1,this.trailSegs=15,this.curBallState=0,this.hasHitNetPvP=!1,this.offTablePvp=!1,this.oGameElementsImgData=assetLib.getData("gameElements"),"enemy"==e&&(this.serveFlip=!1),this.resetServe(e)}return t.prototype.resetServe=function(e){var t=this;2!=gameplayState&&(this.servingState=0,this.canHit=!1,this.hasHitNetPvP=!1,this.offTablePvp=!1,this.hitStop=!1,this.lastHit=e,this.hasHitNet=!1,1==gameVariation&&"user"==this.lastHit?tableTop.newTargetPos(0):0==gameVariation||2==gameVariation?enemyBat.resetToCentre():3==gameVariation&&(this.lastHit="user"),tableTop.tweenToPos(0,1,this.speed,this.lastHit,this.spin),enemyBat.setEnemyLevel(),rallyHits=0,this.x=-100,this.bounceNum=0,this.ballShortState=0,this.offTable=!1,this.offSide=!1,"user"==this.lastHit?(this.tablePosX=0,this.tablePosY=.9,this.height=37.5,this.heightInc=0,this.aTrailPoints=[],this.tableVX=0,this.tableVY=0,userBat.tutInc=0,userBat.tutState=1):(this.tablePosX=0,this.tablePosY=.2,0==gameVariation||2==gameVariation||4==gameVariation?this.height=22.5:(1==gameVariation||3==gameVariation)&&(this.height=45),this.heightInc=0,this.aTrailPoints=[],userBat.tutState=0),0==gameplayState?(this.servePosInc=1,this.canHit=!0):(this.servePosInc=0,this.servePrepTween=TweenLite.to(this,.5,{servePosInc:1,ease:"Quad.easeOut",onComplete:function(){t.canHit=!0}})))},t.prototype.enemyServe=function(){0==gameVariation||2==gameVariation||3==gameVariation?this.setBouncePoint(enemyBat.getHitData(this.tablePosX,this.tablePosY)):1==gameVariation&&(playSound("botThrow",.5),this.servingState=2,this.setBouncePoint({x:1*Math.random()-.5,y:.8,speed:.3,spin:0}),tableTop.botTween&&tableTop.botTween.kill(),tableTop.botY=15,tableTop.botTween=TweenLite.to(tableTop,1,{botY:0,ease:"Elastic.easeOut",onComplete:function(){}}))},t.prototype.setBouncePoint=function(t){if(this.spin=.65*t.spin,this.spinInc=0,"enemy"==this.lastHit)this.targBounceX=t.x,this.targBounceY=t.y,this.speed=.5*t.speed,tableTop.tweenToPos(this.targBounceX,this.targBounceY,this.speed,this.lastHit,this.spin),tableTop.changeStopVert(!1),0==this.servingState?(this.servingState=1,this.heightInc=-(1.3*((-2400+6*this.height)*(.8-this.speed)*1.2))):0==gameVariation||2==gameVariation||3==gameVariation||4==gameVariation?this.heightInc=(-2400+6*this.height)*(.8-this.speed)*1.3:1==gameVariation&&(this.heightInc=(-2e3+6*this.height)*(.8-this.speed)*1.3);else{if(this.targBounceX=t.x,this.targBounceY=t.y,this.speed=.5*t.speed,.27==this.speed)for(var a=360*Math.random()*radian,s=0;s<8;s++){var i=new e.Particle(this.x,this.y,1,200*Math.random()+100,a+45*s*radian,1,.5);aEffects.push(i)}0==this.servingState?(this.servingState=1,this.heightInc=-(1.1*((-2400+6*this.height)*(.8-this.speed)*1.2))):this.heightInc=(-2400+6*this.height)*(.8-this.speed)*1.3,tableTop.tweenToPos(0,1,this.speed,this.lastHit,this.spin),(0==gameVariation||2==gameVariation||3==gameVariation)&&enemyBat.setBouncePos(this.targBounceX,this.targBounceY,this.spin)}this.tableVX=(this.targBounceX-this.tablePosX)/((1-this.speed)*1.1),this.tableVY=(this.targBounceY-this.tablePosY)/((1-this.speed)*1.1)},t.prototype.getTargetHitData=function(e,t){return{x:e/3,y:.75,speed:.3+.3/.4*(.75-.6)*.25,spin:0}},t.prototype.userServe=function(e){void 0===e&&(e=!1),this.bounceNum=0,this.lastHit="user",hitFirstShot=!0,userBat.tutState=0,playSound("hit"+Math.floor(6*Math.random())),e?0==gameVariation||2==gameVariation||3==gameVariation?this.setBouncePoint({x:1*Math.random()-.5,y:.25,speed:.3,spin:0}):1==gameVariation&&this.setBouncePoint({x:0,y:.25,speed:.3,spin:0}):this.setBouncePoint(userBat.getHitData(this.tablePosX,this.tablePosY)),4==gameVariation&&netLib.send(!0,"serveBounce",[Math.round(1e3*this.targBounceX)/1e3,Math.round((1-this.targBounceY)*1e3)/1e3,Math.round(2e3*this.speed)/1e3,Math.round(1e3*this.tablePosX)/1e3,Math.round(1e3*this.tablePosY)/1e3,Math.round(1e3*this.height)/1e3])},t.prototype.hitNetPvP=function(){playSound("hitNet"),this.tablePosY=.49,this.hasHitNet=!0,this.hasHitNetPvP=!1,this.tableVY*=-.5,this.tableVX*=.5,this.ballShortState=2,this.heightInc*=.2},t.prototype.update=function(){if(0==gameplayState)this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2,this.scale=.25+(this.y-onScreenY)/800;else if(gameplayState>=3)this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2,this.scale=.25+(this.y-onScreenY)/800;else if(1==gameplayState){if(0==this.servingState){if("user"==this.lastHit){this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=Math.min(Math.max((userBat.x-canvas.width/2)/450,-.95),.95),this.x=canvas.width/2+((this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier)+-((1-this.servePosInc)*500),this.scale=.25+(this.y-onScreenY)/800;var t=userBat.x-this.x,a=userBat.y-100*userBat.scale+130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)-(this.y-this.height*(3*this.scale)-16),s=Math.sqrt(t*t+a*a);this.canHit&&userBat.getHitData(this.tablePosX,this.tablePosY).y<.4&&s<130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)&&this.userServe()}else this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2)+(1-this.servePosInc)*100,this.tablePosX=0,4==gameVariation&&(this.tablePosX=Math.min(Math.max((enemyBat.x-canvas.width/2)/200,-.95),.95)),this.x=canvas.width/2+((this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier)+-((1-this.servePosInc)*500),this.scale=.25+(this.y-onScreenY)/800}else{if(this.offTable||("user"==this.lastHit?this.spinInc=Math.min(Math.max(this.spinInc+Math.pow(2.5*this.spin,3)*delta*(1-this.tablePosY),-3),3):this.spinInc=Math.min(Math.max(this.spinInc+Math.pow(2*this.spin,3)*delta*this.tablePosY,-2),2),this.tablePosX+=(this.tableVX+this.spinInc)*delta,this.tablePosY+=this.tableVY*delta),!this.offTable&&"user"==this.lastHit&&this.tablePosY<0&&4!=gameVariation&&(this.offTable=!0,this.offTableVX=(this.x-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].x)*10,this.offTableVY=(this.y-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].y)*10,this.offTableTween&&this.offTableTween.kill(),this.offTableTween=TweenLite.to(this,2,{offTableVX:0,offTableVY:0,ease:"Quad.easeOut"}),(0==gameVariation||2==gameVariation)&&enemyBat.flail(),(rallyHits>8||Math.random()>.8||0==saveDataHandler.getLevel()&&0==curLevelStars)&&(0==gameVariation||2==gameVariation))){userBat.successFlip(),panel.showCongrats(),playSound("hitTarget",.3),playSound("cheer"+Math.floor(6*Math.random()));for(var i=0;i<25;i++){var r=new e.Confetti(canvas.width/2+400*Math.random()-200,.9*canvas.height);aEffects.push(r)}}if(this.heightInc+=5700*delta,this.height-=this.heightInc*this.speed*delta,4==gameVariation&&this.hasHitNetPvP&&this.hitNetPvP(),1==this.ballShortState&&this.tablePosY<=.5&&"user"==this.lastHit&&(playSound("hitNet"),this.hasHitNet=!0,this.tableVY*=-.5,this.tableVX*=.5,this.ballShortState=2,this.heightInc*=.2,4==gameVariation&&netLib.send(!0,"hitNet")),3==gameVariation&&"user"==this.lastHit&&this.tablePosY<.5&&0==this.curBallState&&this.height<30&&tableTop.checkZombieHit(this.x,this.y),this.tablePosX>-1&&this.tablePosX<1&&this.tablePosY>0&&this.tablePosY<1&&this.height<=0&&!this.offSide){if(this.height=0,this.heightInc*=-.85,0==this.ballShortState?playSound("bounce"+Math.floor(6*Math.random())):this.height=-3,this.bounceNum++,this.bounceX=this.tablePosX,this.bounceY=this.tablePosY,tableTop.bounce(Math.max(Math.min(-this.heightInc/1500,1),.1)),"user"==this.lastHit&&this.tablePosY>.5&&this.servingState>1&&(this.spin=0,this.ballShortState=1),1==gameVariation&&"user"==this.lastHit&&this.tablePosY<.5&&0==this.curBallState){var o=this.x-tableTop.holeX,n=this.y-tableTop.holeY;o*o/((306*tableTop.holeScale+50*this.scale)*(306*tableTop.holeScale+50*this.scale))+n*n/((112*tableTop.holeScale+25*this.scale)*(112*tableTop.holeScale+25*this.scale))<=1?(tableTop.holeHit(),setTimeout(function(){var t=new e.Ball("enemy");aBalls.push(t),t.enemyServe()},1e3)):(tableTop.holeMiss(),userInput.removeHitArea("pause"),setTimeout(function(){playSound("targetGameEnd"),curTargetScore>10&&playSound("cheer"+Math.floor(6*Math.random())),initTargetGameEnd()},1e3)),this.curBallState=1}}else(this.tablePosX<-1||this.tablePosX>1)&&!this.offTable&&this.tablePosY<1&&this.height<=0&&(this.offSide||netLib.send(!0,"offSide"),this.offSide=!0);if(4==gameVariation&&this.tablePosY<0&&this.height<=0&&("user"==this.lastHit||this.hasHitNet?this.offTable=!0:this.offTable=!1),!this.offTablePvp&&"user"==this.lastHit&&this.tablePosY<0&&(this.offTablePvp=!0,this.offTableVX=(this.x-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].x)*10,this.offTableVY=(this.y-this.aTrailPoints[Math.max(this.aTrailPoints.length-5,0)].y)*10,this.offTableTween&&this.offTableTween.kill(),this.offTableTween=TweenLite.to(this,2,{offTableVX:0,offTableVY:0,ease:"Quad.easeOut"})),(this.offTable||this.offSide)&&this.height<=-200){if(1==this.curBallState){this.curBallState=2;return}"user"==this.lastHit?4!=gameVariation&&(0==this.bounceNum||this.hitStop||this.hasHitNet?updateScore("enemy"):1==this.servingState&&1==this.bounceNum?updateScore("enemy"):updateScore("user")):0==this.bounceNum||this.hasHitNet?(updateScore("user"),4==gameVariation&&netLib.send(!0,"ballOff",[0])):(updateScore("enemy"),4==gameVariation&&netLib.send(!0,"ballOff",[1])),"enemy"==this.lastHit||4!=gameVariation?this.nextServeChoice():this.servingState=-1;return}if((4==gameVariation||this.offTable)&&(4!=gameVariation||this.offTablePvp)?(this.x+=this.offTableVX*delta,this.y+=this.offTableVY*delta):(this.y=onScreenY+50*tableTop.offsetY+this.tablePosY*this.tablePosY*tableDepth*(1+tableTop.offsetY/2),this.x=canvas.width/2+(this.y-onScreenY)*(tableTop.offsetX+this.tablePosX*ballPosMultiplier)*num128*(1+tableTop.offsetY/2)+this.tablePosX*tableBackWidth/2+tableTop.offsetX*tableTop.sideMultiplier),this.scale=.25+(this.y-onScreenY)/800,this.aTrailPoints.push({x:this.x,y:this.y,height:this.height,scale:this.scale,power:(this.speed-.12)/.12}),this.aTrailPoints.length>this.trailSegs&&this.aTrailPoints.shift(),this.y>canvas.height){if(1==this.curBallState){this.curBallState=2;return}(0==gameVariation||2==gameVariation||4==gameVariation)&&(this.bounceNum>0||this.ballShortState>0?(updateScore("enemy"),4==gameVariation&&netLib.send(!0,"ballOff",[1])):(updateScore("user"),4==gameVariation&&netLib.send(!0,"ballOff",[0]))),this.nextServeChoice();return}var l=1+Math.min(Math.abs(userBat.prevX-userBat.x),225)*userBat.batSpreadMultiplier,m=1+Math.min(Math.abs(userBat.prevY-userBat.y),225)*userBat.batSpreadMultiplier;userBat.batSpreadX-=(userBat.batSpreadX-l)*.2,userBat.batSpreadY-=(userBat.batSpreadY-m)*.2;var t=userBat.x-this.x,a=userBat.y-100*userBat.scale+130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)-(this.y-this.height*(3*this.scale)-16),s=Math.sqrt(t*t+a*a);"enemy"==this.lastHit&&(2==this.servingState&&1==this.bounceNum||1==this.servingState&&2==this.bounceNum)&&this.tablePosY>.5&&s<130*userBat.scale*Math.max(userBat.batSpreadX,userBat.batSpreadY)&&(playSound("hit"+Math.floor(6*Math.random())),rallyHits++,this.servingState=2,this.bounceNum=0,this.lastHit="user",this.setBouncePoint(userBat.getHitData(this.tablePosX,this.tablePosY)),4==gameVariation&&netLib.send(!0,"hitBounce",[Math.round(1e3*this.targBounceX)/1e3,Math.round((1-this.targBounceY)*1e3)/1e3,Math.round(2e3*this.speed)/1e3,Math.round(1e3*this.tablePosX)/1e3,Math.round(1e3*this.tablePosY)/1e3,Math.round(1e3*this.height)/1e3])),0==gameVariation||2==gameVariation?"user"==this.lastHit&&(2==this.servingState&&1==this.bounceNum||1==this.servingState&&2==this.bounceNum)&&this.tablePosY<.5&&this.tablePosY>0&&enemyBat.x>this.x-70*enemyBat.scale&&enemyBat.x<this.x+70*enemyBat.scale&&enemyBat.y>this.y-this.height*(3*this.scale)-16-82*enemyBat.scale&&enemyBat.y<this.y-this.height*(3*this.scale)-16+82*enemyBat.scale&&(playSound("hit"+Math.floor(6*Math.random())),rallyHits++,this.servingState=2,this.bounceNum=0,this.lastHit="enemy",this.setBouncePoint(enemyBat.getHitData(this.tablePosX,this.tablePosY))):3==gameVariation&&"user"==this.lastHit&&(2==this.servingState||1==this.servingState)&&this.tablePosY<.1&&(playSound("hit"+Math.floor(6*Math.random())),this.servingState=2,this.bounceNum=0,this.lastHit="enemy",this.setBouncePoint({x:Math.max(Math.min(.75*this.tablePosX,.8),-.8),y:.8,speed:.3,spin:0}))}}},t.prototype.nextServeChoice=function(){((oGameData.userScore+oGameData.enemyScore)%2==0||oGameData.userScore>=10&&oGameData.enemyScore>=10)&&(this.serveFlip=!this.serveFlip),this.serveFlip&&1!=gameVariation?this.resetServe("user"):(this.resetServe("enemy"),1==gameVariation&&this.enemyServe())},t.prototype.render=function(){if(!(gameplayState>1)){if(this.tablePosX>-1&&this.tablePosX<1&&this.tablePosY>0&&this.tablePosY<1){ctx.save(),ctx.globalAlpha=Math.max(1-this.height/100,.25);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.ballShadow].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,this.x-a/2*this.scale,this.y-s/2*this.scale,a*this.scale,s*this.scale),ctx.restore()}"enemy"==this.lastHit&&0==this.ballShortState&&this.renderTrail();var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["ball"+this.ballType]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,this.x-a/2*this.scale,this.y-s/2*this.scale-this.height*(3*this.scale)-23,a*this.scale,s*this.scale),"user"==this.lastHit&&0==this.ballShortState&&this.renderTrail()}},t.prototype.renderTrail=function(){if(this.aTrailPoints.length>1&&this.scale>0)for(var e=0;e<this.aTrailPoints.length;e++)ctx.fillStyle="rgba(255, 255, 100,"+e/this.aTrailPoints.length*.3+")",ctx.beginPath(),ctx.arc(this.aTrailPoints[e].x,this.aTrailPoints[e].y-this.aTrailPoints[e].height*(3*this.aTrailPoints[e].scale)-23,20*this.scale,0,2*Math.PI),ctx.fill()},t}();e.Ball=t}(Elements||(Elements={})),function(e){var t=function(){function t(){this.segs=100,this.offsetX=0,this.offsetY=0,this.netY=0,this.segMultiplier=1,this.netHeight=0,this.id=0,this.sideMultiplier=100,this.bounceMarkScale=0,this.targetX=0,this.stopHeight=0,this.stopOffsetX=0,this.canChangeStop=!1,this.holeFixedScale=1,this.holeHitScale=0,this.blockOffsetY=0,this.tableHeight=352,this.edgeMultuplier=1.46,this.botY=0,this.zoomScale=0,this.zoomAlpha=0,this.targId=0,this.aZombies=[],this.zombieScale=90,this.aColours=["#00e9b2","#00ddd9","#00d2f5","#0bc4ff","#7ab2ff","#8babff","#a4a3ff","#c098ff","#e085ff","#ff70fd","#ff6dd4","#ff70b1","#ff7092","#ff6e71","#fc7954","#ff874c","#ff9644","#ffa53c","#ffb434","#ffc42e","#e4d026","#c5da2e","#a3e342","#7bea5c","#42f079","#42f079"],this.aBugColours=["#E6B763","#61F295","#CFE458","#FC8995","#F7E497","#F1394B","#DF7FAB","#80EEF3"],this.oGameElementsImgData=assetLib.getData("gameElements"),this.id=0,this.setTableCol()}return t.prototype.setZombieStart=function(){this.zombieBase={x:0,y:0,offsetX:0,offsetY:.25,energy:1,height:0},this.aZombies=[];for(var e=0;e<Math.min(bugWave+5,15);e++)this.aZombies.push(this.resetZombie(e))},t.prototype.resetZombie=function(e){var t={id:e,x:0,y:0,offsetX:0,offsetY:0,startX:2*Math.random()-1,startY:.3*Math.random()+.1,endX:1.6*Math.random()-.8,endY:.3*Math.random()+.1,energy:1,height:0,speed:.05*Math.random()+.05,scale:1,tweenScale:0,canHit:!0},a=TweenLite.to(t,.5,{tweenScale:1,ease:"Back.easeOut",onComplete:function(){}});return t.tween=a,t},t.prototype.checkZombieHit=function(t,a){for(var s=this,i=0;i<this.aZombies.length;i++){var r=t-this.aZombies[i].x,o=a-this.aZombies[i].y;if(this.aZombies[i].canHit&&r*r/(this.zombieScale*this.aZombies[i].scale*(this.zombieScale*this.aZombies[i].scale))+o*o/(.5*this.zombieScale*this.aZombies[i].scale*(.37*this.zombieScale*this.aZombies[i].scale))<=1){bugScore++;for(var n=30*radian,l=0;l<5;l++){var m=new e.Particle(this.aZombies[i].x,this.aZombies[i].y,.5*Math.random()+.75,200*Math.random()+200,n+30*l*radian+(10*Math.random()-5)*radian,15,1,25,this.aBugColours[this.aZombies[i].id%8]);aEffects.push(m)}panel.tweenTargetGameScore(),this.aZombies[i].canHit=!1,playSound("bugSplat"+Math.floor(5*Math.random()),.5*Math.random()+.3),this.aZombies[i].tween&&this.aZombies[i].tween.kill();var h=this.aZombies[i].id;this.aZombies[i].tween=TweenLite.to(this.aZombies[i],.25,{tweenScale:0,ease:"Cubic.easeOut",onCompleteParams:[this,h],onComplete:function(e,t){++bugWaveKilled>=Math.min(bugWave+5,15)&&(playSound("winSet",.3),playSound("cheer"+Math.floor(6*Math.random())),s.tweenColours(),bugWave++,bugWaveKilled=0,s.setZombieStart(),panel.addBugTime())}})}}},t.prototype.setTableCol=function(){0==gameplayState||0==gameVariation?this.colourId=Math.floor(curLevel)%this.aColours.length:this.colourId=Math.floor(Math.random()*this.aColours.length),this.gradientId=this.colourId},t.prototype.tweenColours=function(){this.fadeTween&&this.fadeTween.kill(),this.gradientId=this.colourId,this.fadeTween=TweenLite.to(this,.75,{gradientId:this.colourId+this.aColours.length,ease:"none"})},t.prototype.startBot=function(){this.botTween&&this.botTween.kill(),this.botY=50,this.botTween=TweenLite.to(this,.5,{botY:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.zoomTarget=function(){this.targetZoomTween&&this.targetZoomTween.kill(),this.zoomScale=this.holeScale,this.zoomX=this.holeX,this.zoomY=this.holeY,this.zoomAlpha=1,this.targetZoomTween=TweenLite.to(tableTop,.5,{zoomScale:3*this.zoomScale,zoomAlpha:0,ease:"Cubic.easeOut",onComplete:function(){}})},t.prototype.setTarget=function(){this.holeX=0,this.holeY=0,this.holeOffsetX=0,this.holeOffsetY=.3,this.holeTween&&this.holeTween.kill(),this.holeTween=TweenLite.to(this,.25,{holeOffsetX:0,holeOffsetY:.3,holeHitScale:Math.max(this.holeFixedScale*=.97,.35),ease:"Quad.easeInOut",onComplete:function(){}})},t.prototype.changeHolePos=function(){this.targId=0,this.holeTween=TweenLite.to(this,.25,{holeOffsetX:1.2*Math.random()-.6,holeOffsetY:.25*Math.random()+.2,holeHitScale:Math.max(this.holeFixedScale*=.97,.35),ease:"Quad.easeInOut",onComplete:function(){}})},t.prototype.holeHit=function(){var t=this;this.holeTween&&this.holeTween.kill(),playSound("hitTarget",.3),this.tweenColours(),curTargetScore++,saveDataHandler.setBestTargetScore(curTargetScore),panel.tweenTargetGameScore(),this.zoomTarget(),this.targId=1,curTargetScore>=10&&curTargetScore%5==0&&playSound("cheer"+Math.floor(6*Math.random())),this.holeTween=TweenLite.to(this,.25,{holeHitScale:0,ease:"Back.easeIn",onComplete:function(){t.changeHolePos()}});for(var a=30*radian,s=0;s<20;s++){var i=new e.Particle(aBalls[curBallId].x,aBalls[curBallId].y,.5*Math.random()+.75,200*Math.random()+200,a+120/19*s*radian,15,1,25);aEffects.push(i)}},t.prototype.holeMiss=function(){playSound("missTarget",.7),this.holeFixedScale=1,this.holeTween=TweenLite.to(this,.25,{holeHitScale:0,ease:"Back.easeIn",onComplete:function(){}}),tableTop.botTween&&tableTop.botTween.kill(),tableTop.botTween=TweenLite.to(tableTop,1,{botY:50,ease:"Bounce.easeOut",onComplete:function(){}})},t.prototype.changeStopVert=function(e){e?(this.stopTweenVert&&this.stopTweenVert.kill(),this.canChangeStop=!1,this.stopTweenVert=TweenLite.to(this,.2,{stopHeight:Math.floor(1.5*Math.random()),ease:"Quad.easeOut"})):(this.stopTweenVert&&this.stopTweenVert.kill(),this.canChangeStop=!0,this.stopTweenVert=TweenLite.to(this,.2,{stopHeight:1,stopOffsetX:1*Math.random()-.5,ease:"Quad.easeOut"}))},t.prototype.bounce=function(e){this.bounceMarkScale=e},t.prototype.tweenToPos=function(e,t,a,s,i){this.offsetTween&&this.offsetTween.kill();var r=0,o=0;(e>.3||e<-.3)&&(r=-e/1.75-i/2);var n=1;"enemy"==s&&(n=.75,o=(1-(t-.5)*2)*(.3-(a-.3))/.3),this.offsetTween=TweenLite.to(this,n,{offsetX:r,offsetY:o,ease:"Quad.easeOut"})},t.prototype.newTargetPos=function(e){var t;void 0===e&&(e=null),t=null==e?250*Math.random()-125:e,this.targetTween&&this.targetTween.kill(),this.targetTween=TweenLite.to(this,.75,{targetX:t,ease:"Quad.easeInOut"})},t.prototype.render=function(){var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].height;if(onScreenY=canvas.height<1.2*canvas.width?canvas.height/4:.35*canvas.height,this.genScale=1+this.offsetY/3,this.netY=onScreenY-e+this.tableHeight/this.segs*(.282*this.segs)*this.genScale+50*this.offsetY,this.netHeight=e*this.genScale,1==gameVariation){var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bot].height,i=onScreenY+50*this.offsetY;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*this.genScale+this.offsetX*(0*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier,i-100*this.genScale+this.botY*this.genScale,s*this.genScale,e*this.genScale)}if(3==gameVariation){var r=getSpriteData(assetLib.getData("bugs"),"bugBack"),o=canvas.width/2+this.offsetX*(0*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier,n=onScreenY+50*this.offsetY;ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,o-r.bWidth/2*this.genScale,n-.4*r.bHeight*this.genScale,r.bWidth*this.genScale,r.bHeight*this.genScale),addDirectText(0,50*this.genScale,canvas.width/2,"center",o,n-20*this.genScale,"WAVE "+panel.twoDigit(bugWave+1),"#FF7000")}var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableClip].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*(1+this.offsetY/3)+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*(1+this.offsetY/3)+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY+this.netHeight-3*(1+this.offsetY/3),s*(1+this.offsetY/3),e*(1+this.offsetY/3));var l=176*this.genScale,m=(543*.282+352)/2*this.genScale,h=447.5*this.genScale,i=onScreenY+50*this.offsetY,d=this.netY+this.netHeight,u=onScreenY+352*(1+this.offsetY/2)+50*this.offsetY,c=this.offsetX*this.sideMultiplier*this.edgeMultuplier,g=(this.offsetX*(.282*100)*3*this.genScale+this.offsetX*this.sideMultiplier)*this.edgeMultuplier,p=(300*this.offsetX*this.genScale+this.offsetX*this.sideMultiplier)*this.edgeMultuplier;ctx.fillStyle="#333333",ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c,i),ctx.lineTo(canvas.width/2+l+c,i),ctx.lineTo(canvas.width/2+h+p,u),ctx.lineTo(canvas.width/2-h+p,u),ctx.lineTo(canvas.width/2-l+c,i),ctx.closePath(),ctx.fill(),ctx.fillStyle="#FFFFFF",ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+h+p-6*this.genScale,u),ctx.lineTo(canvas.width/2-h+p+6*this.genScale,u),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.fill();var $=ctx.createLinearGradient(canvas.width/2,i+4*this.genScale,canvas.width/2,u-13*this.genScale);if($.addColorStop(0,this.aColours[Math.floor(this.gradientId)%this.aColours.length]),$.addColorStop(.5,this.aColours[Math.floor(this.gradientId+1)%this.aColours.length]),$.addColorStop(1,this.aColours[Math.floor(this.gradientId+2)%this.aColours.length]),ctx.fillStyle=$,ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+10*this.genScale,i+4*this.genScale),ctx.lineTo(canvas.width/2-2*this.genScale+c,i+4*this.genScale),ctx.lineTo(canvas.width/2-8*this.genScale+p,u-13*this.genScale),ctx.lineTo(canvas.width/2-h+p+40*this.genScale,u-13*this.genScale),ctx.lineTo(canvas.width/2-l+c+10*this.genScale,i+4*this.genScale),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.moveTo(canvas.width/2+2*this.genScale+c,i+4*this.genScale),ctx.lineTo(canvas.width/2+l+c-10*this.genScale,i+4*this.genScale),ctx.lineTo(canvas.width/2+h+p-40*this.genScale,u-13*this.genScale),ctx.lineTo(canvas.width/2+8*this.genScale+p,u-13*this.genScale),ctx.lineTo(canvas.width/2+2*this.genScale+c,i+4*this.genScale),ctx.closePath(),ctx.fill(),1==gameVariation){ctx.save(),ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+m+g-6*this.genScale,d),ctx.lineTo(canvas.width/2-m+g+6*this.genScale,d),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.clip();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["target"+this.targId]].height;this.holeY=onScreenY+50*this.offsetY+this.holeOffsetY*this.holeOffsetY*tableDepth*(1+this.offsetY/2),this.holeX=canvas.width/2+(this.holeY-onScreenY)*(this.offsetX+this.holeOffsetX*ballPosMultiplier)*.85*(1+this.offsetY/2)+this.holeOffsetX*tableBackWidth/2+this.offsetX*this.sideMultiplier,this.holeScale=this.genScale*(.3+.5*this.holeOffsetY)*this.holeHitScale,ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,this.holeX-s/2*this.holeScale,this.holeY-e/2*this.holeScale,s*this.holeScale,e*this.holeScale),ctx.restore()}if(3==gameVariation){this.aZombies=sortBy(this.aZombies,"y");for(var v=0;v<this.aZombies.length;v++){var r=getSpriteData(assetLib.getData("bugs"),"bug"+this.aZombies[v].id%8);this.aZombies[v].offsetX=this.aZombies[v].startX+(this.aZombies[v].endX-this.aZombies[v].startX)*(Math.sin(panel.incY*this.aZombies[v].speed+this.aZombies[v].id)+1)*.5,this.aZombies[v].offsetY=this.aZombies[v].startY+(this.aZombies[v].endY-this.aZombies[v].startY)*(Math.sin(panel.incY*this.aZombies[v].speed+this.aZombies[v].id)+1)*.5,this.aZombies[v].y=onScreenY+50*this.offsetY+this.aZombies[v].offsetY*this.aZombies[v].offsetY*tableDepth*(1+this.offsetY/2),this.aZombies[v].x=canvas.width/2+(this.aZombies[v].y-onScreenY)*(this.offsetX+this.aZombies[v].offsetX*ballPosMultiplier)*.85*(1+this.offsetY/2)+this.aZombies[v].offsetX*tableBackWidth/2+this.offsetX*this.sideMultiplier,this.aZombies[v].scale=this.genScale*(.3+.5*this.aZombies[v].offsetY);var I=1+.1*Math.sin(panel.incY+this.aZombies[v].id);ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,this.aZombies[v].x-r.bWidth/2*this.aZombies[v].scale*this.aZombies[v].tweenScale,this.aZombies[v].y-.8*r.bHeight*this.aZombies[v].scale*I*this.aZombies[v].tweenScale,r.bWidth*this.aZombies[v].scale*this.aZombies[v].tweenScale,r.bHeight*this.aZombies[v].scale*this.aZombies[v].tweenScale*I)}}ctx.save(),ctx.beginPath(),ctx.moveTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+l+c-2*this.genScale,i+2*this.genScale),ctx.lineTo(canvas.width/2+h+p-6*this.genScale,u),ctx.lineTo(canvas.width/2-h+p+6*this.genScale,u),ctx.lineTo(canvas.width/2-l+c+2*this.genScale,i+2*this.genScale),ctx.closePath(),ctx.clip();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.netReflect].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*this.genScale+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY+(e-4)*this.genScale,s*this.genScale,e*this.genScale);var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].height;if(ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,userBat.x-s/2*userBat.scale,userBat.y-(e/2-200)*userBat.scale,s*userBat.scale,e*userBat.scale),0==gameVariation||2==gameVariation||4==gameVariation){var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.batShadow].height;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,enemyBat.x-s/2*enemyBat.scale+(this.offsetX+1*enemyBat.flailInc)*this.sideMultiplier+enemyBat.swipeOffsetX*enemyBat.scale,enemyBat.y-(e/2-200)*enemyBat.scale,s*enemyBat.scale,e*enemyBat.scale)}ctx.restore();var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.tableEdge].height;if(ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,canvas.width/2-s/2*(1+this.offsetY/3)+300*this.offsetX*this.edgeMultuplier*(1+this.offsetY/3)+this.offsetX*this.edgeMultuplier*this.sideMultiplier,onScreenY+this.tableHeight*(1+this.offsetY/2)+50*this.offsetY,s*(1+this.offsetY/3),e*(1+this.offsetY/3)),this.zoomAlpha>0){var r=getSpriteData(assetLib.getData("gameElements"),"targetZoom");ctx.save(),ctx.globalAlpha=this.zoomAlpha,ctx.drawImage(r.img,r.bX,r.bY,r.bWidth,r.bHeight,this.zoomX-r.bWidth/2*this.zoomScale,this.zoomY-r.bHeight/2*this.zoomScale,r.bWidth*this.zoomScale,r.bHeight*this.zoomScale),ctx.restore()}if(this.bounceMarkScale>0&&aBalls.length>0){this.bounceMarkScale-=3*delta;var t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].x,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].y,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].width,e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.bounceMark].height,b=onScreenY+50*this.offsetY+aBalls[curBallId].bounceY*aBalls[curBallId].bounceY*tableDepth*(1+this.offsetY/2),_=canvas.width/2+(b-onScreenY)*(this.offsetX+aBalls[curBallId].bounceX*ballPosMultiplier)*num128*(1+this.offsetY/2)+aBalls[curBallId].bounceX*tableBackWidth/2+this.offsetX*this.sideMultiplier,B=.6+(b-onScreenY)/600;ctx.drawImage(this.oGameElementsImgData.img,t,a,s,e,_-s/2*(B*this.bounceMarkScale),b-e/2*(B*this.bounceMarkScale),s*(B*this.bounceMarkScale),e*(B*this.bounceMarkScale))}},t.prototype.renderNet=function(){var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds.net].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,canvas.width/2-a/2*this.genScale+this.offsetX*(.282*this.segs)*3*this.edgeMultuplier*this.genScale+this.offsetX*this.edgeMultuplier*this.sideMultiplier*this.segMultiplier,this.netY,a*this.genScale,this.netHeight)},t}();e.TableTop=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.oTextData={},this.inc=0,this.createTextObjects()}return e.prototype.createTextObjects=function(){for(var e in assetLib.textData.langText.text[curLang])this.oTextData[e]={},this.oTextData[e].aLineData=this.getCharData(assetLib.textData.langText.text[curLang][e]["@text"],assetLib.textData.langText.text[curLang][e]["@fontId"]),this.oTextData[e].aLineWidths=this.getLineWidths(this.oTextData[e].aLineData),this.oTextData[e].blockWidth=this.getBlockWidth(this.oTextData[e].aLineData),this.oTextData[e].blockHeight=this.getBlockHeight(this.oTextData[e].aLineData,assetLib.textData.langText.text[curLang][e]["@fontId"]),this.oTextData[e].lineHeight=parseInt(assetLib.textData["fontData"+assetLib.textData.langText.text[curLang][e]["@fontId"]].text.common["@lineHeight"]),this.oTextData[e].oFontImgData=assetLib.getData("font"+assetLib.textData.langText.text[curLang][e]["@fontId"])},e.prototype.getLineWidths=function(e){for(var t,a=[],s=0;s<e.length;s++){t=0;for(var i=0;i<e[s].length;i++)t+=parseInt(e[s][i]["@xadvance"]),0==i?t-=parseInt(e[s][i]["@xoffset"]):i==e[s].length-1&&(t+=parseInt(e[s][i]["@xoffset"]));a.push(t)}return a},e.prototype.getBlockWidth=function(e){for(var t,a=0,s=0;s<e.length;s++){t=0;for(var i=0;i<e[s].length;i++)t+=parseInt(e[s][i]["@xadvance"]),0==i?t-=parseInt(e[s][i]["@xoffset"]):i==e[s].length-1&&(t+=parseInt(e[s][i]["@xoffset"]));t>a&&(a=t)}return a},e.prototype.getBlockHeight=function(e,t){return e.length*parseInt(assetLib.textData["fontData"+t].text.common["@lineHeight"])},e.prototype.getCharData=function(e,t){for(var a=[],s=0;s<e.length;s++){a[s]=[];for(var i=0;i<e[s].length;i++)for(var r=0;r<assetLib.textData["fontData"+t].text.chars.char.length;r++)e[s][i].charCodeAt(0)==assetLib.textData["fontData"+t].text.chars.char[r]["@id"]&&a[s].push(assetLib.textData["fontData"+t].text.chars.char[r])}return a},e.prototype.renderText=function(e){var t,a=this.oTextData[e.text].aLineData,s=this.oTextData[e.text].oFontImgData,i=0,r=0,o=0,n=1,l=0;e.lineOffsetY&&(o=e.lineOffsetY),e.scale&&(n=e.scale);var m=1*n;e.maxWidth&&this.oTextData[e.text].blockWidth*n>e.maxWidth&&(m=e.maxWidth/this.oTextData[e.text].blockWidth),e.anim&&(this.inc+=7*delta);for(var h=0;h<a.length;h++){t=0,"centre"==e.alignX&&(i=this.oTextData[e.text].aLineWidths[h]/2),"centre"==e.alignY&&(r=this.oTextData[e.text].blockHeight/2+o*(a.length-1)/2);for(var d=0;d<a[h].length;d++){var u=a[h][d]["@x"],c=a[h][d]["@y"],g=a[h][d]["@width"],p=a[h][d]["@height"];e.anim&&(l=Math.sin(this.inc+d/2)*(p/15*m)),ctx.drawImage(s.img,u,c,g,p,e.x+(t+parseInt(a[h][d]["@xoffset"])-i)*m,e.y+(parseInt(a[h][d]["@yoffset"])+h*this.oTextData[e.text].lineHeight+h*o-r)*m+l,g*m,p*m),t+=parseInt(a[h][d]["@xadvance"])}}},e}();e.TextDisplay=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t){void 0===t&&(t=!1),this.aAllCountryCodes={0:"ES",1:"AU",2:"AT",3:"AG",4:"AR",5:"AM",6:"BO",7:"BQ",8:"BA",9:"TL",10:"VN",11:"GA",12:"PT",13:"AZ",14:"",15:"AW",16:"BS",17:"BD",18:"BW",19:"BR",20:"BN",21:"HW",22:"GY",23:"GM",24:"",25:"AL",26:"DZ",27:"BB",28:"BH",29:"BY",30:"BF",31:"BI",32:"VU",33:"GH",34:"GP",35:"GN",36:"AI",37:"AO",38:"AD",39:"BE",40:"BJ",41:"BG",42:"GB",43:"HU",44:"VE",45:"GN",46:"GW",47:"DE",48:"ZW",49:"IL",50:"IN",51:"KZ",52:"CM",53:"CA",54:"CO",55:"KM",56:"CD",57:"CW",58:"LA",59:"LV",60:"ID",61:"JO",62:"IQ",63:"QA",64:"KE",65:"CY",66:"CG",67:"KP",68:"KR",69:"LS",70:"LR",71:"LB",72:"IR",73:"IE",74:"IS",75:"",76:"KG",77:"KI",78:"",79:"CR",80:"CI",81:"LY",82:"LT",83:"LI",84:"IT",85:"",86:"",87:"CN",88:"",89:"",90:"CU",91:"",92:"CK",93:"",94:"",95:"",96:"",97:"",98:"",99:"",100:"",101:"",102:"",103:"",104:"",105:"NL",106:"",107:"NZ",108:"",109:"",110:"",111:"",112:"",113:"",114:"",115:"",116:"",117:"",118:"",119:"TR",120:"RU",121:"",122:"",123:"",124:"",125:"",126:"",127:"",128:"",129:"UZ",130:"",131:"UY",132:"",133:"WS",134:"",135:"",136:"",137:"",138:"",139:"",140:"",141:"",142:"PH",143:"FI",144:"",145:"",146:"",147:"",148:"",149:"US",150:"",151:"",152:"",153:"FR",154:"",155:"",156:"",157:"",158:"",159:"CZ",160:"CL",161:"CH",162:"MG",163:"",164:"",165:"",166:"",167:"",168:"HK",169:"",170:"GL",171:"SE",172:"",173:"EE",174:"",175:"MY",176:"",177:"",178:"NO",179:"",180:"GR",181:"",182:"DK",183:"ET",184:"",185:"ZA",186:"",187:"",188:"",189:"AE",190:"PK",191:"",192:"",193:"",194:"",195:"",196:"JM",197:"JP",198:"PE",199:"",200:"PL",201:"",202:"",203:"PG"},this.aIds=[];for(var a=0;a<e.length;a++)this.aIds.push(this.getIdFromISO(e[a]));t&&(this.aIds=this.randomise(this.aIds))}return e.prototype.getIdFromISO=function(e){var t=0;for(var a in this.aAllCountryCodes){if(this.aAllCountryCodes[a]==e)break;t++}return t},e.prototype.getBData=function(e){return{bX:e%12*124+30.5,bY:85.5*Math.floor(e/12)+14,bWidth:85.5,bHeight:59}},e.prototype.randomise=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[a],e[a]=s}return e},e}();e.CountryFlags=t}(Utils||(Utils={})),function(e){var t=function(e){function t(){var t=e.call(this,assetLib.getData("firework"),30,30,"explode")||this;return t.vy=0,t.setAnimType("once","explode"),t.animEndedFunc=function(){this.removeMe=!0},t.scaleX=.5,t.scaleY=.5,t}return __extends(t,e),t.prototype.blowUp=function(){TweenLite.to(this,.5,{scaleX:this.endScale,scaleY:this.endScale,ease:"Quad.easeOut"})},t.prototype.update=function(t,a){this.vy+=150*delta,this.y+=this.vy*delta,e.prototype.updateAnimation.call(this,delta)},t.prototype.render=function(){e.prototype.renderSimple.call(this,ctx)},t}(Utils.AnimSprite);e.Firework=t}(Elements||(Elements={})),function(e){var t=function(){function e(e){this.canStore=!1,this.batCount=57,this.addedIndex=56,this.saveDataId=e;var t,a="test",s=!1;try{t=window.localStorage,s=!0}catch(i){console.log("local storage denied"),s=!1,this.canStore=!1}if(s)try{t.setItem(a,"1"),t.removeItem(a),this.canStore=!0}catch(r){this.canStore=!1}this.clearData(),this.setInitialData(),0==this.getSeason()&&0==this.getRound()&&this.setRank(500),0==this.getCareerGames()&&this.setCareerGames(11),0==this.getCareerSets()&&this.setCareerSets(3)}return e.prototype.clearData=function(){this.aLevelStore=[],this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(2),this.aLevelStore.push(0),this.aLevelStore.push(2),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(0),this.aLevelStore.push(500),this.aLevelStore.push(11),this.aLevelStore.push(3),this.aLevelStore.push(0),this.aLevelStore.push(0);for(var e=0;e<42;e++)this.aLevelStore.push(0);for(var e=0;e<this.batCount;e++)0==e?this.aLevelStore.push(2):e<3?this.aLevelStore.push(1):this.aLevelStore.push(0);for(var e=0;e<16;e++)this.aLevelStore.push(0)},e.prototype.resetData=function(){this.clearData(),this.saveData()},e.prototype.setInitialData=function(){if(this.canStore&&"undefined"!=typeof Storage){if(null!=localStorage.getItem(this.saveDataId)&&""!=localStorage.getItem(this.saveDataId))for(var e in this.aLevelStore=localStorage.getItem(this.saveDataId).split(","),this.aLevelStore)this.aLevelStore[e]=parseInt(this.aLevelStore[e]);else this.saveData()}},e.prototype.setAudioState=function(e){this.aLevelStore[12]=e,this.saveData()},e.prototype.getAudioState=function(){return this.aLevelStore[12]},e.prototype.addPvpWins=function(){this.aLevelStore[13]++,this.saveData()},e.prototype.getPvpWins=function(){return this.aLevelStore[13]},e.prototype.setCareerGames=function(e){this.aLevelStore[10]=e,this.saveData()},e.prototype.getCareerGames=function(){return this.aLevelStore[10]},e.prototype.setCareerSets=function(e){this.aLevelStore[11]=e,this.saveData()},e.prototype.getCareerSets=function(){return this.aLevelStore[11]},e.prototype.setSensitveLevel=function(e){this.aLevelStore[5]=e,this.saveData()},e.prototype.getSensitveLevel=function(){return this.aLevelStore[5]},e.prototype.getAwardState=function(e){return this.aLevelStore[this.addedIndex+this.batCount+e]},e.prototype.setAward=function(e){this.aLevelStore[this.addedIndex+this.batCount+e]=1,this.saveData()},e.prototype.getSeason=function(){return this.aLevelStore[7]},e.prototype.setSeason=function(e){this.aLevelStore[7]=e,this.saveData()},e.prototype.getRound=function(){return this.aLevelStore[8]},e.prototype.setRound=function(e){this.aLevelStore[8]=e,this.saveData()},e.prototype.getRank=function(){return this.aLevelStore[9]},e.prototype.setRank=function(e){this.aLevelStore[9]=e,this.saveData()},e.prototype.getDifficultyLevel=function(){return this.aLevelStore[3]},e.prototype.setDifficultyLevel=function(e){this.aLevelStore[3]=e,this.saveData()},e.prototype.getBestBugScore=function(){return this.aLevelStore[6]},e.prototype.setBestBugScore=function(e){e>this.aLevelStore[6]&&(this.aLevelStore[6]=e,this.saveData())},e.prototype.getBestTargetScore=function(){return this.aLevelStore[2]},e.prototype.setBestTargetScore=function(e){e>this.aLevelStore[2]&&(this.aLevelStore[2]=e,this.saveData())},e.prototype.addGems=function(e){this.aLevelStore[0]+=e,this.saveData()},e.prototype.getGems=function(){return this.aLevelStore[0]},e.prototype.addClassicWins=function(){this.aLevelStore[4]++,this.saveData()},e.prototype.getClassicWins=function(){return this.aLevelStore[4]},e.prototype.setLevel=function(e){this.aLevelStore[1]=e,this.saveData()},e.prototype.getLevel=function(){return this.aLevelStore[1]},e.prototype.unlockBat=function(e){this.aLevelStore[e+this.addedIndex]=1,this.saveData()},e.prototype.getBatUnlockState=function(e){return this.aLevelStore[e+this.addedIndex]},e.prototype.getTotalBatsUnlocked=function(){for(var e=0,t=0;t<this.batCount;t++)this.aLevelStore[t+this.addedIndex]>0&&e++;return e},e.prototype.selectBat=function(e){for(var t=0;t<this.batCount;t++)if(2==this.aLevelStore[t+this.addedIndex]){this.aLevelStore[t+this.addedIndex]=1;break}this.aLevelStore[e+this.addedIndex]=2,this.saveData()},e.prototype.getCurBat=function(){for(var e=0,t=0;t<this.batCount;t++)if(2==this.aLevelStore[t+this.addedIndex]){e=t;break}return e},e.prototype.saveData=function(){if(this.canStore&&"undefined"!=typeof Storage){for(var e="",t=0;t<this.aLevelStore.length;t++)e+=this.aLevelStore[t],t<this.aLevelStore.length-1&&(e+=",");localStorage.setItem(this.saveDataId,e)}},e}();e.SaveDataHandler=t}(Utils||(Utils={})),function(e){var t=function(){function e(e,t,a,s,i,r,o,n,l){var m=this;void 0===r&&(r=10),void 0===o&&(o=1),void 0===n&&(n=0),void 0===l&&(l=null),this.effectType=1,this.inc=0,this.col="#FFFFFF",this.removeMe=!1,this.scale=-a/2,this.fixedScale=a,this.angle=i,this.x=e-n*Math.cos(i),this.y=t-n*Math.sin(i),this.lineLength=1.5*r,null!=l&&(this.col=l);var h=o+Math.random()*o;TweenLite.to(this,h,{scale:a,x:this.x-s*Math.cos(i),y:this.y-s*Math.sin(i),ease:"Cubic.easeOut",onComplete:function(){m.removeMe=!0}})}return e.prototype.update=function(){},e.prototype.render=function(){ctx.strokeStyle=this.col,ctx.lineWidth=(this.fixedScale-Math.abs(this.scale))*10,ctx.lineCap="round",ctx.beginPath(),ctx.moveTo(this.x,this.y),ctx.lineTo(this.x-this.lineLength*(this.fixedScale-Math.abs(this.scale))*Math.cos(this.angle),this.y-this.lineLength*(this.fixedScale-Math.abs(this.scale))*Math.sin(this.angle)),ctx.stroke()},e}();e.Particle=t}(Elements||(Elements={})),function(e){var t=function(){function e(e,t,a,s){var i=this;void 0===a&&(a=0),void 0===s&&(s=1),this.x=0,this.y=0,this.fallY=0,this.incY=0,this.removeMe=!1,this.incYRate=-1e3*Math.random(),this.aColours=["#FF3AE7","#00DAFF","#00FF25","#FFEE00","#FF9A00"],this.scale=(20*Math.random()+20)*s,this.angle=360*Math.random()*radian,this.rot=360*Math.random()*radian,this.colId=Math.floor(Math.random()*this.aColours.length),this.dist=200*Math.random()+200,this.x=e+75*Math.cos(this.angle),this.y=t+75*Math.sin(this.angle),this.rotRate=20*Math.random()-10,TweenLite.to(this,3+3*Math.random(),{scale:0,x:this.x+this.dist*Math.cos(this.angle),y:this.y+this.dist*Math.sin(this.angle),ease:"Cubic.easeOut",onComplete:function(){i.removeMe=!0}})}return e.prototype.update=function(){this.rot+=delta*this.rotRate,this.incYRate+=500*delta,this.incY+=delta*this.incYRate},e.prototype.render=function(){ctx.strokeStyle=this.aColours[this.colId],ctx.lineWidth=this.scale,ctx.lineCap="butt",ctx.beginPath(),ctx.moveTo(this.x,this.y+this.incY),ctx.lineTo(this.x-2*this.scale*Math.cos(2*this.rot)*Math.sin(this.rot),this.y-2*this.scale*Math.sin(this.rot)*Math.sin(2*this.rot)+this.incY),ctx.stroke()},e}();e.Confetti=t}(Elements||(Elements={})),function(e){var t=function(){function t(){if(this.gapX=180,this.gapY=255,this.posX=-25,this.posY=0,this.cropY=100,this.cornerLength=5,this.touchState=0,this.startTouchY=0,this.targY=0,this.inc=0,this.startMoveY=0,this.glowId=null,this.sideTouched=0,this.barPerc=0,this.blocksX=0,null!=newBatId){var e=Math.max(Math.floor((canvas.width+this.posX-50)/this.gapX),4);this.targY=-(newBatId/e)*this.gapY+canvas.height/2-this.gapY/2}}return t.prototype.glowBut=function(e,t){if(this.glowId=null,t>100&&t<canvas.height-100)for(var a=0;a<aBatData.length;a++)e>aBatData[a].x-this.gapX/2&&e<aBatData[a].x+this.gapX/2&&t>aBatData[a].y-this.gapY/2&&t<aBatData[a].y+this.gapY/2&&(this.glowId=a)},t.prototype.checkClick=function(e,t){for(var a=!1,s=0;s<aBatData.length;s++)e>aBatData[s].x-this.gapX/2&&e<aBatData[s].x+this.gapX/2&&t>aBatData[s].y-this.gapY/2&&t<aBatData[s].y+this.gapY/2&&(1==aBatData[s].unlockId?showRewardAd("batUnlock",s):0==aBatData[s].unlockId?(playSound("selectBat",.3),saveDataHandler.selectBat(s),curBat=saveDataHandler.getCurBat(),updateBatShopData()):2==aBatData[s].unlockId&&gems>=aBatData[s].gemCost?(playSound("buyBat",.5),saveDataHandler.selectBat(s),curBat=saveDataHandler.getCurBat(),saveDataHandler.addGems(-aBatData[s].gemCost),gems=saveDataHandler.getGems(),updateBatShopData(),awardPanel.checkForAward(curLevel),a=!0):playSound("lockedBat",.3));a&&this.batUnlocked()},t.prototype.batUnlocked=function(){for(var t=0;t<200;t++){var a=new e.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(a)}},t.prototype.renderRect=function(e,t,a,s,i,r){void 0===r&&(r=!1),ctx.strokeStyle="#000000",ctx.fillStyle=i,ctx.lineWidth=5,ctx.beginPath(),ctx.moveTo(e+this.cornerLength,t),ctx.lineTo(e+(a-this.cornerLength),t),ctx.bezierCurveTo(e+a,t,e+a,t,e+a,t+this.cornerLength),ctx.lineTo(e+a,t+(s-this.cornerLength)),ctx.bezierCurveTo(e+a,t+s,e+a,t+s,e+(a-this.cornerLength),t+s),ctx.lineTo(e+this.cornerLength,t+s),ctx.bezierCurveTo(e,t+s,e,t+s,e,t+(s-this.cornerLength)),ctx.lineTo(e,t+this.cornerLength),ctx.bezierCurveTo(e,t,e,t,e+this.cornerLength,t),ctx.closePath(),ctx.fill(),r&&ctx.stroke()},t.prototype.update=function(){this.inc+=delta},t.prototype.render=function(){this.blocksX=Math.max(Math.floor((canvas.width+this.posX-50)/this.gapX),4);var e,t,a=Math.ceil(aBatData.length/this.blocksX)*this.gapY-(canvas.height-200)+30;this.targY=Math.max(Math.min(this.targY,0),-a),this.posY=100+this.gapY/2+this.targY+15,this.barPerc=(canvas.height-200)/(Math.ceil(aBatData.length/this.blocksX)*this.gapY),this.renderRect(canvas.width-40,100,20,canvas.height-200,"rgba(0, 0, 0, .5)"),this.renderRect(canvas.width-40,100-this.targY/a*(canvas.height-200-(canvas.height-200)*this.barPerc),20,(canvas.height-200)*this.barPerc,"#FFFFFF"),ctx.save(),ctx.beginPath(),ctx.moveTo(0,this.cropY),ctx.lineTo(canvas.width,this.cropY),ctx.lineTo(canvas.width,canvas.height-this.cropY),ctx.lineTo(0,canvas.height-this.cropY),ctx.moveTo(0,this.cropY),ctx.closePath(),ctx.clip();for(var s=0;s<aBatData.length;s++){if(aBatData[s].x=canvas.width/2+s%this.blocksX*this.gapX-this.gapX*(this.blocksX/2-.5)+this.posX,aBatData[s].y=this.posY+Math.floor(s/this.blocksX)*this.gapY,ctx.translate(aBatData[s].x,aBatData[s].y),aBatData[s].y>this.cropY-125&&aBatData[s].y<canvas.height-this.cropY+125){if(0==aBatData[s].unlockId?e=1:1==aBatData[s].unlockId?e=3:2==aBatData[s].unlockId?e=gems>=aBatData[s].gemCost?0:2:3==aBatData[s].unlockId&&(e=2),t=getSpriteData(assetLib.getData("uiElements"),"batShopUnderlay"+e),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight),null!=this.glowId&&this.glowId==s&&2!=e&&curBat!=s&&(t=getSpriteData(assetLib.getData("uiElements"),"batShopGlow"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight)),ctx.scale(.75,.75),ctx.rotate(20*radian),s<49&&(t=getSpriteData(assetLib.getData("uiElements"),"batDropShadow"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2+3-5,-t.bHeight/2+10,t.bWidth,t.bHeight)),t=getSpriteData(assetLib.getData("gameElements"),"bat"+s),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2-10,-t.bHeight/2,t.bWidth,t.bHeight),ctx.rotate(-20*radian),ctx.scale(1/.75,1/.75),t=0==aBatData[s].unlockId?getSpriteData(assetLib.getData("uiElements"),"batShopOverlay1"):0==e||3==e?getSpriteData(assetLib.getData("uiElements"),"batShopOverlay2"):getSpriteData(assetLib.getData("uiElements"),"batShopOverlay0"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2,t.bWidth,t.bHeight),curBat==s)t=getSpriteData(assetLib.getData("uiElements"),"tick"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2+40,-t.bHeight/2+82,t.bWidth,t.bHeight);else if(1==e&&newBatId==s&&Math.sin(10*this.inc)>0)addText(0,50,165,"center",0,97,"new","#FFFFFF");else if(0!=aBatData[s].unlockId){if((2==aBatData[s].unlockId&&gems<aBatData[s].gemCost||3==aBatData[s].unlockId)&&(t=getSpriteData(assetLib.getData("uiElements"),"batLock"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2+20,t.bWidth,t.bHeight)),3==e)addText(0,30,165,"center",0,73,"unlock","#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"rewardIcon"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2,-t.bHeight/2+97,t.bWidth,t.bHeight);else if(0==e){addText(0,30,165,"center",0,73,"buy","#FFFFFF"),addDirectText(0,40,110,"left",-24,111,aBatData[s].gemCost,"#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"smallGem");var i=.6;ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2*i-46,-t.bHeight/2*i+97,t.bWidth*i,t.bHeight*i)}else if(2==aBatData[s].unlockId){addDirectText(0,40,110,"left",-24,96,aBatData[s].gemCost,"#FFFFFF"),t=getSpriteData(assetLib.getData("uiElements"),"smallGem");var i=.6;ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,-t.bWidth/2*i-46,-t.bHeight/2*i+97-15,t.bWidth*i,t.bHeight*i)}else 2==e&&(addText(0,30,165,"center",0,77,"completeBatShop","#FFFFFF"),addDirectText(0,30,165,"center",0,109,getText("world",0)+" "+aBatData[s].unlockWorld,"#FFFFFF"))}}ctx.translate(-aBatData[s].x,-aBatData[s].y)}ctx.restore(),t=getSpriteData(assetLib.getData("uiElements"),"batShopBorder0"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,0,this.cropY-t.bHeight/2,canvas.width,t.bHeight),t=getSpriteData(assetLib.getData("uiElements"),"batShopBorder1"),ctx.drawImage(t.img,t.bX,t.bY,t.bWidth,t.bHeight,0,canvas.height-this.cropY-t.bHeight/2,canvas.width,t.bHeight)},t}();e.BatShop=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.y=1,this.id=0,this.inc=0}return e.prototype.checkForAward=function(e){var t=Math.floor(e/levelsPerWorld);1==t&&0==saveDataHandler.getAwardState(0)?(saveDataHandler.setAward(0),awardPanel.showAward(0)):3==t&&0==saveDataHandler.getAwardState(1)?(saveDataHandler.setAward(1),awardPanel.showAward(1)):6==t&&0==saveDataHandler.getAwardState(2)?(saveDataHandler.setAward(2),awardPanel.showAward(2)):10==t&&0==saveDataHandler.getAwardState(3)&&(saveDataHandler.setAward(3),awardPanel.showAward(3)),1==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(4)?(saveDataHandler.setAward(4),awardPanel.showAward(4)):3==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(5)?(saveDataHandler.setAward(5),awardPanel.showAward(5)):6==saveDataHandler.getClassicWins()&&0==saveDataHandler.getAwardState(6)&&(saveDataHandler.setAward(6),awardPanel.showAward(6)),saveDataHandler.getTotalBatsUnlocked()>=10&&0==saveDataHandler.getAwardState(7)?(saveDataHandler.setAward(7),awardPanel.showAward(7)):saveDataHandler.getTotalBatsUnlocked()>=25&&0==saveDataHandler.getAwardState(8)?(saveDataHandler.setAward(8),awardPanel.showAward(8)):saveDataHandler.getTotalBatsUnlocked()>=50&&0==saveDataHandler.getAwardState(9)&&(saveDataHandler.setAward(9),awardPanel.showAward(9)),bugScore>=65&&0==saveDataHandler.getAwardState(10)&&(saveDataHandler.setAward(10),awardPanel.showAward(10)),bugScore>=90&&0==saveDataHandler.getAwardState(11)&&(saveDataHandler.setAward(11),awardPanel.showAward(11)),bugScore>=125&&0==saveDataHandler.getAwardState(12)&&(saveDataHandler.setAward(12),awardPanel.showAward(12)),curTargetScore>=25&&0==saveDataHandler.getAwardState(13)&&(saveDataHandler.setAward(13),awardPanel.showAward(13)),curTargetScore>=50&&0==saveDataHandler.getAwardState(14)&&(saveDataHandler.setAward(14),awardPanel.showAward(14)),curTargetScore>=80&&0==saveDataHandler.getAwardState(15)&&(saveDataHandler.setAward(15),awardPanel.showAward(15))},e.prototype.showAward=function(e){var t=this;this.awardTween&&this.awardTween.kill(),playSound("newAward"),this.y=1,this.id=e,this.awardTween=TweenLite.to(this,.5,{y:0,ease:"Cubic.easeOut",onComplete:function(){t.awardTween=TweenLite.to(t,.5,{y:1,delay:2,ease:"Cubic.easeIn",onComplete:function(){}})}})},e.prototype.render=function(){if(this.y<1){this.inc+=delta;var e=getSpriteData(assetLib.getData("awards"),"awardBg"),t=canvas.width-100-e.bWidth/2,a=-200*this.y;ctx.drawImage(e.img,e.bX,e.bY,e.bWidth,e.bHeight,t-e.bWidth/2,a,e.bWidth,e.bHeight),Math.sin(10*this.inc)>0&&addText(0,35,e.bWidth-20,"center",t,a+45,"newAward","#FFFFFF");var e=getSpriteData(assetLib.getData("awards"),"award"+this.id);ctx.drawImage(e.img,e.bX,e.bY,e.bWidth,e.bHeight,t-e.bWidth/2*1,a-e.bHeight/2*1+125,1*e.bWidth,1*e.bHeight);for(var s=getMultiLineTextByChars("awardInfo"+this.id,16,1),i=0;i<s.length;i++)addDirectText(1,25,200,"center",t,a+125+105+25*i,s[i],"#FFFFFF")}},e}();e.AwardPanel=t}(Elements||(Elements={})),function(e){var t=function(){function e(){this.x=0,this.y=0,this.rotation=0,this.scale=1,this.nX=0,this.nY=0,this.nRot=0,this.oGameElementsImgData=assetLib.getData("gameElements")}return e.prototype.setEnemyLevel=function(){},e.prototype.update=function(){this.y=onScreenY+50*tableTop.offsetY-this.nY,this.rotation=this.nRot,this.scale=Math.max(.4+(this.y-onScreenY)/300,.2),this.x=canvas.width/2+200*tableTop.genScale*this.nX*Math.max(1+(this.scale-.285)*8,1)},e.prototype.render=function(){ctx.save(),ctx.translate(this.x+tableTop.offsetX*tableTop.sideMultiplier,this.y),ctx.rotate(this.rotation),ctx.scale(this.scale,this.scale);var e=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].x,t=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].y,a=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].width,s=this.oGameElementsImgData.oData.oAtlasData[oImageIds["bat"+opBat]].height;ctx.drawImage(this.oGameElementsImgData.img,e,t,a,s,-a/2,-s/3,a,s),ctx.restore()},e}();e.NetworkBat=t}(Elements||(Elements={})),function(e){var t=function(){function e(e){this.lobbyCode="",this.shareURL="",this.playerNum=-1,this.networkReady=!1,this.connectState=0,this.actionOnCoonect="",this.gameId=e}return e.prototype.createNetwork=function(){var e=this;this.network=new netlib.Network(this.gameId),this.network.on("message",function(e,t,a){networkMessage(a)}),this.network.on("disconnected",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",networkMessage("disconnected")}),this.network.on("connected",function(t){console.log("new peer connected: "+t.id),e.peer=t,e.connectState=2,clearTimeout(e.joinTimer),1==e.playerNum&&e.send(!0,"peerConnect")}),this.network.on("lobby",function(t){if(0==e.playerNum){console.log("lobby created: "+t),e.lobbyCode=t;var a={id:e.lobbyCode};window.PokiSDK.shareableURL(a).then(function(t){e.shareURL=t}),addUrlBut()}}),this.network.on("ready",function(){console.log("Network ready"),e.networkReady=!0,"createLobby"==e.actionOnCoonect?e.createLobby():"joinLobby"==e.actionOnCoonect&&e.joinLobby()}),this.network.on("signalingerror",function(t){console.log("signalingerror:",t),clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="","lobby-not-found"==t.code||"lobby-is-full"==t.code?networkMessage(t.code):networkMessage("generalError")}),this.network.on("error",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",console.log("error:",t)}),this.network.on("rtcerror",function(t){clearTimeout(e.joinTimer),e.connectState=0,e.lobbyCode="",console.log("rtcerror:",t)})},e.prototype.disconnect=function(){console.log("disconnecting"),this.network.close(),this.lobbyCode="",this.playerNum=-1},e.prototype.connect=function(e){void 0===e&&(e=""),this.network&&this.disconnect(),this.actionOnCoonect=e,console.log("creating new network"),this.createNetwork()},e.prototype.createLobby=function(){console.log("createLobby"),this.playerNum=0,this.network.create({codeFormat:"short",public:!0,maxPlayers:2})},e.prototype.joinLobby=function(){var e=this;this.playerNum=1,this.joinTimer=setTimeout(function(){e.connectState=0,e.lobbyCode="",networkMessage("connectError")},1e4),console.log("joining lobby",this.lobbyCode),this.network.join(this.lobbyCode)},e.prototype.send=function(e,t,a){if(void 0===a&&(a=[]),this.peer){for(var s=t,i=0;i<a.length;i++)s+=",",s+=a[i];e?this.network.send("reliable",this.peer.id,s):this.network.send("unreliable",this.peer.id,s)}},e.prototype.shareLobbyCode=function(e){var t=!1;if(void 0!=navigator.clipboard&&navigator.clipboard.writeText(netLib.shareURL).then(function(){t=!0},function(e){console.warn("Clipboard copy error: ",e),t=!1}),!t){t=!0;var a=document.createElement("textArea");a.readOnly=!1,a.contenteditable=!0,a.value=netLib.shareURL,document.body.appendChild(a),a.select(),a.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(s){t=!1,console.warn("Clipboard copy error: "+s)}document.body.removeChild(a)}t?(console.log("Clipboard success: "+netLib.shareURL),e(1)):e(0)},e}();e.NetLib=t}(Elements||(Elements={}));var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.requestAnimationFrame||function(e){window.setTimeout(e,1e3/60,new Date().getTime())},canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),maxWidth=800,minWidth=800,maxHeight=800,minHeight=800,canvasScale=1,div=document.getElementById("canvas-wrapper"),audioType=0,muted=!1,splashTimer=0,isMobile=!1,gameState="loading",aLangs=["EN"],curLang="",isBugBrowser=!1,isIE10=!1,radian=Math.PI/180,ios9FirstTouch=!1,isRotated=!1,saveDataHandler=new Utils.SaveDataHandler("ppgv8"),hasFocus=!0,assetIdInc=0;navigator.userAgent.match(/MSIE\s([\d]+)/)&&(isIE10=!0);var deviceAgent=navigator.userAgent.toLowerCase();(deviceAgent.match(/(iphone|ipod|ipad)/)||deviceAgent.match(/(android)/)||deviceAgent.match(/(iemobile)/)||deviceAgent.match(/iphone/i)||deviceAgent.match(/ipad/i)||deviceAgent.match(/ipod/i)||deviceAgent.match(/blackberry/i)||deviceAgent.match(/bada/i)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&(isMobile=!0,deviceAgent.match(/(android)/)&&!/Chrome/.test(navigator.userAgent)&&(isBugBrowser=!0));var userInput=new Utils.UserInput(canvas,isBugBrowser);function visibleResume(){hasFocus||(userInput&&userInput.checkKeyFocus(),"suspended"==Howler.ctx.state&&Howler.ctx.resume(),muted||"pause"==gameState||"splash"==gameState||"loading"==gameState||(Howler.mute(!1),playMusic())),hasFocus=!0}function visiblePause(){hasFocus=!1,Howler.mute(!0),music.pause()}function playMusic(){music.playing()||music.play()}function isStock(){var e=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return e&&537>parseFloat(e[1])}resizeCanvas(),window.onresize=function(){setTimeout(function(){resizeCanvas()},1)},window.onpageshow=function(){hasFocus||(userInput&&userInput.checkKeyFocus(),muted||"pause"==gameState||"splash"==gameState||"loading"==gameState||(Howler.mute(!1),playMusic())),hasFocus=!0},window.onpagehide=function(){hasFocus=!1,Howler.mute(!0),music.pause()},window.addEventListener("load",function(){setTimeout(function(){resizeCanvas()},0),window.addEventListener("orientationchange",function(){setTimeout(function(){resizeCanvas()},500),setTimeout(function(){resizeCanvas()},2e3)},!1)});var ua=navigator.userAgent,isSharpStock=/SHL24|SH-01F/i.test(ua)&&isStock(),isXperiaAStock=/SO-04E/i.test(ua)&&isStock(),isFujitsuStock=/F-01F/i.test(ua)&&isStock();isIE10||isSharpStock||isXperiaAStock||isFujitsuStock||void 0===window.AudioContext&&void 0===window.webkitAudioContext&&-1!=navigator.userAgent.indexOf("Android")?audioType=0:(audioType=1,sound=new Howl({src:["audio/sound.mp3"],sprite:{silence:[0,502.87981859410434],arcadeWin:[1500,1564.4444444444448],botThrow:[4e3,234.01360544217732],bounce0:[5500,215.69160997732428],bounce1:[7e3,207.16553287981833],bounce2:[8500,252.51700680272114],bounce3:[1e4,282.63038548752917],bounce4:[11500,212.7891156462578],bounce5:[13e3,232.1995464852602],buyBat:[14500,679.9092970521539],classicGameLose:[16e3,380.22675736961276],classicGameWin:[17500,915.3061224489783],classicMatchLose:[19e3,1253.877551020409],classicMatchWin:[21500,1404.807256235827],click:[24e3,48.934240362811465],gameStart0:[25500,1651.519274376419],gameStart1:[28e3,1216.1451247165544],gem0:[30500,90.3854875283443],gem1:[32e3,93.24263038548963],gem2:[33500,349.97732426303685],gem3:[35e3,208.9795918367372],gem4:[36500,263.21995464852677],gemReward:[38e3,692.5170068027242],gemTweenOut:[39500,1856.530612244896],hit0:[42e3,213.33333333333115],hit1:[43500,213.33333333333115],hit2:[45e3,252.74376417233668],hit3:[46500,211.15646258503062],hit4:[48e3,230.38548752834487],hit5:[49500,261.04308390022624],hitTarget:[51e3,385.9410430839034],lockedBat:[52500,376.5532879818565],loseSet:[54e3,564.5804988662135],loseStar:[55500,320.2721088435396],missTarget:[57e3,377.1428571428572],selectBat:[58500,341.2244897959198],targetGameEnd:[6e4,1141.4058956916122],unlockBat:[62500,280.1587301587318],winSet:[64e3,835.8956916099771],winStar:[65500,674.3764172335602],worldComplete:[67e3,743.015873015878],cheer0:[68500,3428.072562358281],cheer1:[73e3,6597.369614512473],cheer2:[80500,4757.188208616782],cheer3:[86e3,4461.541950113371],cheer4:[91500,3059.2290249433063],cheer5:[96e3,4442.13151927437],hitNet:[101500,1245.170068027207],bugSplat0:[104e3,114.08163265306825],bugSplat1:[105500,155.64625850339553],bugSplat2:[107e3,94.73922902493825],bugSplat3:[108500,168.4807256235814],bugSplat4:[11e4,184.35374149659367]}}),music=new Howl({src:["audio/music.mp3"],volume:0,loop:!0}));var totalScore=0,levelScore=0,levelNum=0,aTutorials=[],oLogoData={},oImageIds={},swipeState=0,aFlags=[{id:0,x:-.51,y:-.136},{id:1,x:-.651,y:-.262},{id:2,x:-.34,y:.216},{id:3,x:.013,y:-.244},{id:4,x:.75,y:-.133},{id:5,x:-.063,y:-.194},{id:6,x:.789,y:.354},{id:7,x:.668,y:-.104},{id:8,x:-.093,y:-.116},{id:9,x:.389,y:.067},{id:10,x:.05,y:-.37},{id:11,x:-.005,y:-.193},{id:12,x:.069,y:-.244},{id:13,x:.028,y:-.121},{id:14,x:-.017,y:-.287},{id:15,x:-.098,y:-.275},{id:16,x:-.041,y:-.241},{id:17,x:-.632,y:.015},{id:18,x:-.014,y:-.35},{id:19,x:.923,y:.466},{id:20,x:.542,y:.145},{id:21,x:-.428,y:.424},{id:22,x:.579,y:.057},{id:23,x:.252,y:-.015},{id:24,x:.076,y:.367},{id:25,x:.508,y:.057},{id:26,x:.476,y:-.106},{id:27,x:.159,y:.167},{id:28,x:.167,y:-.024},{id:29,x:.139,y:-.126},{id:30,x:-.037,y:.101}],spareEnemyCountry="CH",oGameData={cupId:0,gameId:0,userId:null,enemyId:null,userScore:0,enemyScore:0},firstRun=!0,aMapMarkerPos=[[-203,-115],[-150,-31],[-136,98],[20,57],[-36,-109],[50,-72],[101,-16],[170,82],[192,-51],[143,-121]],justWonCup=!1,controlState=0,rallyHits=0,curLevel=0,curBat=0,opBat=0,aTournamentOrder=[],endChatId=0,tournamentSize=6,charLineUp=0,prevCanvasWidth=0,prevCanvasHeight=0,prevScreen="loading",hasAnyBats=!1,hasAnyPerks=!1,userCustomBat=null,userPerk=null,userCustomBatHighlight=null,userPerkHighlight=null,hasEndGameLink=!1,externalUrl="",gameVariation=0,challengeLevel=0,gameplayState=0,gems=0,levelStarTarg=0,curLevelStars=0,onScreenY=0,aPointScores=[10,25],aBatData=[],levelsPerWorld=5,newBatId=null,batUnlockedId=0,butDown=!0,testVar=">",curBallId=0,tableDepth=352.5,tableBackWidth=349.5,ballPosMultiplier=.6,curTargetScore=0,firstRun=!0,localTargetHighscore=0,userScore=0,enemyScore=0,userSets=0,enemySets=0,classicGameLevel=0,num128=1.28,testPrev=0,testCur=0,rewardButHit=!1,maxMusicVol=.5,minMusicVol=.2,batShopButDown=!1,bugScore=0,bugTime=0,bugTimeTarg=60,bugWaveKilled=0,bugWave=0,bugBonusTime=5,rewardGemTotal=0,rankChange=0,firstCareerGame=!0,netLib=new Elements.NetLib("6caab5cb-54d2-4c8f-aefe-0b0847f7cec6"),networkInc=0,opPvpWins=0,pvpGameTime=0;function resetBatShopData(){aBatData=[{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:0,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:1},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:2},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:3},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:4},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:5},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:6},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:7},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:1,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:8},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:9},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:3,x:0,y:0,gemCost:0,unlockWorld:10},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:9},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0},{unlockId:2,x:0,y:0,gemCost:0,unlockWorld:0}];for(var e=50,t=50,a=0,s=0;s<aBatData.length;s++)2==aBatData[s].unlockId&&(aBatData[s].gemCost=10*Math.round(e/10),++a%3==0&&(t*=1.25,e+=t))}function loadLang(e){void 0===e&&(e="en"),(curLang=e)&&null!=curLang&&void 0!=curLang||(curLang="en");var t=window.PokiSDK.getURLParam("id");null!=t&&(netLib.lobbyCode=t),loadPreAssets()}function initSplash(){window.PokiSDK.gameLoadingFinished(),"ar"==curLang&&(document.body.style.direction="rtl"),firstRun=!0,gameState="splash",1!=audioType||muted||0!=saveDataHandler.getAudioState()||(playMusic(),hasFocus||music.pause()),resetFromSaveData(),awardPanel=new Elements.AwardPanel,updateBatShopData(),opBat=getEnemyBat(),""==netLib.lobbyCode?initStartScreen():initPvpPrep(),resizeCanvas()}function initPvpPrep(){gameVariation=4,gameState="game",netLib.connectState=1,gameplayState=0,curLevel=saveDataHandler.getLevel(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),background=new Elements.Background;var e=[];aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),resetGameElements(),aEffects=[],1!=saveDataHandler.getAudioState()||muted||butEventHandler("mute",null),previousTime=new Date().getTime(),updateGameEvent(),netLib.connect("joinLobby")}function networkMessage(e){if(void 0===e&&(e=""),e&&void 0!=e&&""!=e){var t=e.split(",");switch(t[0]){case"latency":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("latency");break;case"rematch":startPvpGame();break;case"acceptPlayer":netLib.send(!0,"opData",[curBat,saveDataHandler.getPvpWins()]),initGame(),background.setRandom(),panel.showPvpStartMessage();break;case"lobby-not-found":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("noLobby");break;case"lobby-is-full":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("alreadyConnected");break;case"generalError":removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("disconnected");break;case"connectError":initStartScreen(),panel.showDisconnect("unableToConnect");break;case"disconnected":"game"==gameState&&4==gameVariation&&(removeAllButs(),gameVariation=0,initStartScreen(),panel.showDisconnect("disconnected"));break;case"peerConnect":netLib.send(!0,"acceptPlayer"),startPvpGame();break;case"opData":opBat=parseInt(t[1]),opPvpWins=parseInt(t[2]),opBat==curBat&&(opBat=0==curBat?1:0);break;case"batPos":enemyBat.nX=parseFloat(t[1]),enemyBat.nY=parseFloat(t[2]),enemyBat.nRot=parseFloat(t[3]);break;case"serveBounce":playSound("hit"+Math.floor(6*Math.random())),rallyHits++,aBalls[0].height=parseFloat(t[6]),aBalls[0].tablePosX=parseFloat(t[4]),aBalls[0].tablePosY=1-parseFloat(t[5]),aBalls[0].setBouncePoint({x:parseFloat(t[1]),y:parseFloat(t[2]),speed:parseFloat(t[3]),spin:0});break;case"offSide":aBalls[0].offSide=!0;break;case"hitBounce":playSound("hit"+Math.floor(6*Math.random())),rallyHits++,aBalls[0].offTablePvp=!1,aBalls[0].offTable=!1,aBalls[0].offTableTween&&aBalls[0].offTableTween.kill(),aBalls[0].servingState=2,aBalls[0].bounceNum=0,aBalls[0].lastHit="enemy",aBalls[0].height=parseFloat(t[6]),aBalls[0].tablePosX=parseFloat(t[4]),aBalls[0].tablePosY=1-parseFloat(t[5]),aBalls[0].setBouncePoint({x:parseFloat(t[1]),y:parseFloat(t[2])+.1,speed:parseFloat(t[3]),spin:0});break;case"ballOff":1==parseInt(t[1])?updateScore("user"):updateScore("enemy"),aBalls[0].nextServeChoice();break;case"hitNet":aBalls[0].hasHitNetPvP=!0}}}function removeAllButs(){removeStartButs(),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("batShopTouch"),userInput.removeHitArea("backFromBatShop"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),userInput.removeHitArea("pvpFromCustomGameEnd"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),userInput.removeHitArea("pvpFromWorldComplete"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),userInput.removeHitArea("pvpFromTargetGameEnd"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),userInput.removeHitArea("pvpFromBugGameEnd"),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeKey("keyPauseOn"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("backFromNetwork"),userInput.removeHitArea("urlFromNetwork"),userInput.removeHitArea("urlAreaFromNetwork")}function startPvpGame(){removeAllButs(),gameVariation=4,gameplayState=1,userScore=enemyScore=0,resetGameElements(),netLib.send(!0,"opData",[curBat,saveDataHandler.getPvpWins()]),resumeGame(),background.setRandom(),panel.showPvpStartMessage()}function resetFromSaveData(){curBat=saveDataHandler.getCurBat(),curLevel=saveDataHandler.getLevel(),gems=saveDataHandler.getGems(),userInput.sensitiveLevel=saveDataHandler.getSensitveLevel(),classicGameLevel=saveDataHandler.getDifficultyLevel()}function addMuteBut(e){if(1==audioType){var t=oImageIds.muteBut0,a=oImageIds.muteBut0Over;muted&&(t=oImageIds.muteBut1,a=oImageIds.muteBut1Over);var s={oImgData:assetLib.getData("uiButs"),aPos:[-50,50],align:[1,0],id:t,idOver:a,noTween:!0};userInput.addHitArea("mute",butEventHandler,null,"image",s);for(var i=0;i<e.length;i++)if(e[i].id==oImageIds.muteBut0||e[i].id==oImageIds.muteBut1)return;e.push(s)}}function initCreditsScreen(){gameState="credits";var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[-50,-50],align:[1,1],id:oImageIds.resetBut,idOver:oImageIds.resetButOver};userInput.addHitArea("backFromCredits",butEventHandler,null,"image",e),userInput.addHitArea("resetData",butEventHandler,null,"image",t);var a=[e,t];addMuteBut(a),panel=new Elements.Panel(gameState,a),updateSettingsButs(),panel.startTween(),previousTime=new Date().getTime(),resizeCanvas(),updateCreditsScreenEvent()}function initResetConfirmScreen(){gameState="resetConfirm";var e={oImgData:assetLib.getData("uiButs"),aPos:[-100,90],align:[.5,.5],id:oImageIds.tickBut,idOver:oImageIds.tickButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[100,90],align:[.5,.5],id:oImageIds.quitBut,idOver:oImageIds.quitButOver};userInput.addHitArea("yesFromResetConfirm",butEventHandler,null,"image",e),userInput.addHitArea("noFromResetConfirm",butEventHandler,null,"image",t);var a=[e,t];addMuteBut(a),(panel=new Elements.Panel(gameState,a)).startTween(),previousTime=new Date().getTime(),updateResetConfirmEvent()}function updateSettingsButs(){userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),panel.removeBut(oImageIds.minusBut),panel.removeBut(oImageIds.plusBut),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets");var e={oImgData:assetLib.getData("uiButs"),aPos:[-100,54],align:[.5,.3],id:oImageIds.minusBut,idOver:oImageIds.minusButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[100,54],align:[.5,.3],id:oImageIds.plusBut,idOver:oImageIds.plusButOver};userInput.addHitArea("minusGames",butEventHandler,null,"image",e),userInput.addHitArea("plusGames",butEventHandler,null,"image",t),panel.aButs.push(e,t);var a={oImgData:assetLib.getData("uiButs"),aPos:[-100,224],align:[.5,.3],id:oImageIds.minusBut,idOver:oImageIds.minusButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[100,224],align:[.5,.3],id:oImageIds.plusBut,idOver:oImageIds.plusButOver};userInput.addHitArea("minusSets",butEventHandler,null,"image",a),userInput.addHitArea("plusSets",butEventHandler,null,"image",s),panel.aButs.push(a,s)}function initStartScreen(e){void 0===e&&(e=!0),"game"==gameState?e=!1:gameState="game",gameVariation=0,gameplayState=0,curLevel=saveDataHandler.getLevel(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),background=new Elements.Background;var t=[];aEffects=[],addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),updateStartScreenButs(),resetGameElements(),aEffects=[],1!=saveDataHandler.getAudioState()||muted||butEventHandler("mute",null),e&&(previousTime=new Date().getTime(),updateGameEvent())}function removeStartButs(){userInput.removeHitArea("startTouch"),userInput.removeHitArea("infoFromStart"),userInput.removeHitArea("awardsFromStart"),userInput.removeHitArea("batShopFromStart"),userInput.removeHitArea("customMatchFromStart"),userInput.removeHitArea("challengeFromStart"),userInput.removeHitArea("bugGameFromStart"),userInput.removeHitArea("careerFromStart"),userInput.removeHitArea("pvpFromStart"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.infoBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),panel.removeBut(oImageIds.pvpGameBut)}function updateStartScreenButs(){removeStartButs(),batShopButDown=!1;var e,t,a,s,i,r,o={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.infoBut,idOver:oImageIds.infoButOver};userInput.addHitArea("infoFromStart",butEventHandler,null,"image",o),panel.aButs.push(o),canvas.width/canvas.height<.6?(saveDataHandler.getLevel()>0?(e={oImgData:assetLib.getData("uiButs"),aPos:[160,-250],align:[.5,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[320,-250],align:[.5,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver},a={oImgData:assetLib.getData("uiButs"),aPos:[-160,-250],align:[.5,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver},i={oImgData:assetLib.getData("uiButs"),aPos:[0,-250],align:[.5,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[-320,-250],align:[.5,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver},r={oImgData:assetLib.getData("uiButs"),aPos:[320,-430],align:[.5,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0}):r={oImgData:assetLib.getData("uiButs"),aPos:[320,-250],align:[.5,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0},userInput.addHitArea("startTouch",butEventHandler,null,"rect",{aRect:[250,300,canvas.width-250,canvas.height-350]},!0)):(saveDataHandler.getLevel()>0?(e={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver},a={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver},i={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver},s={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver},r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-570],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0}):r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0},userInput.addHitArea("startTouch",butEventHandler,null,"rect",{aRect:[250,300,canvas.width-250,canvas.height-100]},!0)),saveDataHandler.getLevel()>0?(userInput.addHitArea("awardsFromStart",butEventHandler,null,"image",e),userInput.addHitArea("batShopFromStart",butEventHandler,{multiTouch:!0},"image",t),userInput.addHitArea("challengeFromStart",butEventHandler,null,"image",a),userInput.addHitArea("careerFromStart",butEventHandler,null,"image",i),userInput.addHitArea("bugGameFromStart",butEventHandler,null,"image",s),userInput.addHitArea("pvpFromStart",butEventHandler,null,"image",r),panel.aButs.push(t,a,e,s,i,r)):(userInput.addHitArea("pvpFromStart",butEventHandler,null,"image",r),panel.aButs.push(r))}function resetGameElements(){if(tableTop=new Elements.TableTop,userBat=new Elements.UserBat,4==gameVariation?(enemyBat=new Elements.NetworkBat,pvpGameTime=0):enemyBat=new Elements.EnemyBat,4==gameVariation&&1==netLib.playerNum){aBalls=[];var e=new Elements.Ball("enemy");aBalls.push(e)}else{aBalls=[];var e=new Elements.Ball;aBalls.push(e)}background.setRandom(),tableTop.setTableCol()}function updateBatShopData(){resetBatShopData();for(var e=0;e<aBatData.length;e++)saveDataHandler.getBatUnlockState(e)>0&&(aBatData[e].unlockId=0)}function initBatShop(){gameState="batShop",updateBatShopData(),butDown=!1;var e=[];aEffects=[],addMuteBut(e),batShop=new Elements.BatShop,panel=new Elements.Panel(gameState,e),initBatShopButs(),panel.startTween(),aEffects=[],previousTime=new Date().getTime(),updateBatShopEvent()}function initMapScreen(){gameState="mapScreen";var e=[];aEffects=[],addMuteBut(e),aSeasonFlags=getSeasonFlags(saveDataHandler.getSeason()),saveDataHandler.getSeason(),saveDataHandler.getRound(),opBat=getEnemyBat(),aSeasonFlagsRender=[];for(var t=0;t<aSeasonFlags.length;t++)aSeasonFlagsRender.push({aSeasonFlagsIndex:t,y:aFlags[aSeasonFlags[t].id].y});aSeasonFlagsRender=sortBy(aSeasonFlagsRender,"y"),(panel=new Elements.Panel(gameState,e)).startTween(),panel.mapIntro(),aEffects=[],previousTime=new Date().getTime(),updateMapScreenEvent()}function addMapButs(){var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromMapScreen",butEventHandler,null,"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromMapScreen",butEventHandler,null,"image",t),panel.aButs.push(t)}function initBatShopButs(){var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBatShop",butEventHandler,null,"image",e),panel.aButs.push(e),userInput.addHitArea("batShopTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0)}function getEnemyBat(){if(0==curLevel||firstRun)return firstRun=!1,1;for(var e=Math.floor(Math.random()*aBatData.length);0!=aBatData[e].unlockWorld||e==curBat;)e=Math.floor(Math.random()*aBatData.length);return e}function showAd(e){window.PokiSDK.commercialBreak(function(){muted||(Howler.mute(!0),music.pause()),userInput.pointerLockOff()}).then(function(){console.log("Commercial break finished, proceeding to game"),userInput.pointerLockOn(),muted||(Howler.mute(!1),playMusic()),e()})}function showRewardAd(e,t){void 0===t&&(t=null),window.PokiSDK.rewardedBreak(function(){muted||(Howler.mute(!0),music.pause()),userInput.pointerLockOff()}).then(function(a){userInput.pointerLockOn(),muted||(Howler.mute(!1),playMusic()),rewardAdSuccess(e,a,t),console.log("Rewarded break finished, proceeding to game")})}function rewardAdSuccess(e,t,a){switch(void 0===a&&(a=null),e){case"customGameEnd":t&&addRewardGems(rewardGemTotal),initCustomGameEndButs();break;case"levelComplete":t&&addRewardGems(rewardGemTotal),initLevelCompleteButs();break;case"targetGameEnd":t&&addRewardGems(rewardGemTotal),initTargetGameEndButs();break;case"bugGameEnd":t&&addRewardGems(rewardGemTotal),initBugGameEndButs();break;case"batUnlock":userInput.removeHitArea("backFromBatShop"),userInput.removeHitArea("batShopTouch"),panel.removeBut(oImageIds.backBut),t&&(playSound("unlockBat",.5),saveDataHandler.unlockBat(a),saveDataHandler.selectBat(a),curBat=saveDataHandler.getCurBat(),updateBatShopData(),awardPanel.checkForAward(curLevel),batShop.batUnlocked()),initBatShopButs()}}function initPvpGame(){gameState="network";var e={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromNetwork",butEventHandler,null,"image",e);var t=Array(e);addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),netLib.connect("createLobby"),previousTime=new Date().getTime(),resizeCanvas(),updateNetworkScreenEvent()}function addUrlBut(){panel.linkTextId=0,panel.shareButOn=!0,userInput.addHitArea("urlAreaFromNetwork",butEventHandler,null,"rect",{aRect:[200,200,canvas.width-200,canvas.height-200]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[0,230],align:[.5,.5],id:oImageIds.shareBut,idOver:oImageIds.shareButOver,flash:!0};userInput.addHitArea("urlFromNetwork",butEventHandler,null,"image",e),panel.aButs.push(e)}function initGame(){window.PokiSDK.gameplayStart(),1==audioType&&setTimeout(function(){music.fade(music.volume(),minMusicVol,500)},500),levelStarTarg=2+Math.min(Math.floor((curLevel=saveDataHandler.getLevel())/levelsPerWorld),3),curLevelStars=0,1==gameVariation?localTargetHighscore=saveDataHandler.getBestTargetScore():3==gameVariation&&(localTargetHighscore=saveDataHandler.getBestBugScore()),rewardButHit=!1,isMobile&&userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};if(userInput.addHitArea("pause",butEventHandler,null,"image",e),panel.aButs.push(e),panel.startGameTween(),gameplayState=1,resetGameElements(),1==gameVariation){playSound("gameStart1",.6),curTargetScore=0,tableTop.setTarget(),userBat.x=userBat.prevX=userBat.startX=canvas.width/2,userBat.y=userBat.prevY=userBat.startY=onScreenY+355,userBat.rotation=userBat.startRotation=0,aBalls=[];var t=new Elements.Ball("enemy");aBalls.push(t),setTimeout(function(){aBalls[0].enemyServe()},1e3),tableTop.startBot()}else if(3==gameVariation)bugScore=0,bugTime=0,bugWaveKilled=0,bugWave=0,playSound("gameStart1",.6),curTargetScore=0,tableTop.setZombieStart();else if(4==gameVariation){if(playSound("gameStart0"),1==netLib.playerNum){aBalls=[];var t=new Elements.Ball("enemy");aBalls.push(t)}}else playSound("gameStart0");4!=gameVariation&&setTimeout(function(){userInput.addKey("keyPauseOn",butEventHandler,null,80),userInput.addKey("keyPauseOn",butEventHandler,null,27),userInput.addKey("keyPauseOn",butEventHandler,null,32)},500),userScore=enemyScore=userSets=enemySets=0}function initPause(){gameState="pause",window.PokiSDK.gameplayStop();var e={oImgData:assetLib.getData("uiButs"),aPos:[0,-110],align:[.5,.5],id:oImageIds.continueBut,idOver:oImageIds.continueButOver},t={oImgData:assetLib.getData("uiButs"),aPos:[0,110],align:[.5,.5],id:oImageIds.quitBut,idOver:oImageIds.quitButOver};userInput.addHitArea("continueFromPause",butEventHandler,null,"image",e),userInput.addHitArea("quitFromPause",butEventHandler,{isDraggable:!0,multiTouch:!0},"image",t),setTimeout(function(){userInput.addKey("keyPauseOff",butEventHandler,null,80),userInput.addKey("keyPauseOff",butEventHandler,null,27),userInput.addKey("keyPauseOff",butEventHandler,null,32)},500),(panel=new Elements.Panel(gameState,[e,t])).startTween(),previousTime=new Date().getTime(),updatePauseEvent()}function resumeGame(){window.PokiSDK.gameplayStart(),background=new Elements.Background,isMobile&&userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0);var e={oImgData:assetLib.getData("uiButs"),aPos:[-140,50],align:[1,0],id:oImageIds.pauseBut,idOver:oImageIds.pauseButOver};userInput.addHitArea("pause",butEventHandler,null,"image",e);var t=Array(e);setTimeout(function(){userInput.addKey("keyPauseOn",butEventHandler,null,80),userInput.addKey("keyPauseOn",butEventHandler,null,27),userInput.addKey("keyPauseOn",butEventHandler,null,32)},500),addMuteBut(t),(panel=new Elements.Panel(gameState,t)).startTween(),"game"!=gameState&&(gameState="game",previousTime=new Date().getTime(),updateGameEvent())}function initTargetGameEnd(){if(window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=7,saveDataHandler.setBestTargetScore(curTargetScore),Math.round(curTargetScore/2)>0?saveDataHandler.addGems(Math.round(curTargetScore/2)):setTimeout(function(){initTargetGameEndButs()},1e3),awardPanel.checkForAward(curLevel),curTargetScore>localTargetHighscore)for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenTargetGameComplete()}function initTargetGameEndButs(){panel.startTween(),gameplayState=8,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromTargetGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),Math.round(curTargetScore/2)>0){if(!rewardButHit){t=canvas.height<1.2*canvas.width?.325:.35;var t,a={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromTargetGameEnd",butEventHandler,null,"image",a),panel.aButs.push(a)}}else{var s={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.awardsBut,idOver:oImageIds.awardsButOver};userInput.addHitArea("awardsFromTargetGameEnd",butEventHandler,null,"image",s),panel.aButs.push(s)}var i={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromTargetGameEnd",butEventHandler,{multiTouch:!0},"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromTargetGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromTargetGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromTargetGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromTargetGameEnd",butEventHandler,null,"image",l),panel.aButs.push(l);var m={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromTargetGameEnd",butEventHandler,null,"image",m),panel.aButs.push(m)}function initBugGameEnd(){if(window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),playSound("targetGameEnd"),curTargetScore>50&&playSound("cheer"+Math.floor(6*Math.random())),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=11,saveDataHandler.setBestBugScore(bugScore),Math.ceil(bugScore/4)>0?saveDataHandler.addGems(Math.ceil(bugScore/4)):setTimeout(function(){initBugGameEndButs()},1e3),awardPanel.checkForAward(curLevel),bugScore>localTargetHighscore)for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenBugGameComplete()}function initBugGameEndButs(){panel.startTween(),gameplayState=12,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromBugGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),Math.ceil(bugScore/4)>0&&!rewardButHit){t=canvas.height<1.2*canvas.width?.325:.35;var t,a={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromBugGameEnd",butEventHandler,null,"image",a),panel.aButs.push(a)}var s={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromBugGameEnd",butEventHandler,{multiTouch:!0},"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromBugGameEnd",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromBugGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromBugGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromBugGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBugGameEnd",butEventHandler,null,"image",l),panel.aButs.push(l)}function initGameWon(){gameplayState=2;for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),userInput.removeKey("keyPauseOn"),panel.removeBut(oImageIds.pauseBut),userBat.levelComplete(),enemyBat.levelComplete()}function prepForCareerMatch(){gameplayState=1,gameVariation=2,gameState="game",background=new Elements.Background;var e=[];aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),previousTime=new Date().getTime(),updateGameEvent(),initGame()}function initPvpGameComplete(){window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userScore>enemyScore&&saveDataHandler.addPvpWins(),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=13,firstCareerGame=!1;for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}panel.tweenPvpGameComplete()}function initPvpGameEndButs(){panel.startTween(),gameplayState=14,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromPvpGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromPvpGameEnd",butEventHandler,null,"image",t),panel.aButs.push(t)}function initCustomGameComplete(){window.PokiSDK.gameplayStop(),1==audioType&&music.fade(music.volume(),maxMusicVol,500),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("pause"),panel.removeBut(oImageIds.pauseBut),userInput.removeKey("keyPauseOn"),gameplayState=9,firstCareerGame=!1;var e=saveDataHandler.getRank()-aSeasonFlags[saveDataHandler.getRound()].rank;saveDataHandler.setRound(saveDataHandler.getRound()+1),saveDataHandler.getRound()>=6&&(saveDataHandler.setSeason(saveDataHandler.getSeason()+1),saveDataHandler.setRound(0)),userSets>enemySets?(saveDataHandler.addGems(50+10*saveDataHandler.getSeason()+saveDataHandler.getRound()),saveDataHandler.addClassicWins(),rankChange=Math.ceil(Math.min(Math.max(e/2,5),25))):(saveDataHandler.addGems(25),rankChange=Math.round(Math.min(Math.max(-e/2,-25),-5))),saveDataHandler.setRank(Math.max(saveDataHandler.getRank()-rankChange,1)),awardPanel.checkForAward(curLevel);for(var t=0;t<200;t++){var a=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(a)}panel.tweenCustomGameComplete()}function initCustomGameEndButs(){panel.startTween(),gameplayState=10,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromCustomGameEnd",butEventHandler,null,"image",e),panel.aButs.push(e),!rewardButHit){var t={oImgData:assetLib.getData("uiButs"),aPos:[285,0],align:[.5,.4],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromCustomGameEnd",butEventHandler,null,"image",t),panel.aButs.push(t)}var a={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromCustomGameEnd",butEventHandler,{multiTouch:!0},"image",a),panel.aButs.push(a);var s={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromCustomGameEnd",butEventHandler,null,"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.arcadeBut,idOver:oImageIds.arcadeButOver};userInput.addHitArea("arcadeFromCustomGameEnd",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromCustomGameEnd",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromCustomGameEnd",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromCustomGameEnd",butEventHandler,null,"image",n),panel.aButs.push(n)}function initLevelComplete(){window.PokiSDK.gameplayStop(),navigator.sendBeacon("https://leveldata.poki.io/planes","4ee6d38c-41e3-4c87-a9f8-85f0b2a0df48"),1==audioType&&music.fade(music.volume(),maxMusicVol,500),gameplayState=3,firstCareerGame=!1,panel.tweenLevelComplete(),saveDataHandler.setLevel(curLevel+1),saveDataHandler.addGems(panel.winGemTarg),awardPanel.checkForAward(curLevel+1),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0&&(newBatId=batUnlockedId,saveDataHandler.unlockBat(batUnlockedId))}function anyWorldBatsLeft(){var e=!1;return curLevel<10*levelsPerWorld&&(e=!0),e}function initWorldComplete(){gameplayState=5,playSound("classicMatchWin",.5),playSound("cheer"+Math.floor(6*Math.random())),panel.tweenWorldComplete(),awardPanel.checkForAward(curLevel+1),setTimeout(function(){playSound("worldComplete",.5),initWorldCompleteButs();for(var e=0;e<200;e++){var t=new Elements.Confetti(Math.random()*canvas.width,Math.random()*canvas.height);aEffects.push(t)}},1500)}function initLevelCompleteButs(){gameplayState=4,panel.startTween(),batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};if(userInput.addHitArea("playFromLevelComplete",butEventHandler,null,"image",e),panel.aButs.push(e),!rewardButHit){canvas.height<1.2*canvas.width?(t=.25,a=218):(t=.35,a=158);var t,a,s={oImgData:assetLib.getData("uiButs"),aPos:[285,a],align:[.5,t],id:oImageIds.rewardMultiplyBut,idOver:oImageIds.rewardMultiplyButOver,flash:!0};userInput.addHitArea("rewardFromLevelComplete",butEventHandler,null,"image",s),panel.aButs.push(s)}var i={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};if(userInput.addHitArea("backFromLevelComplete",butEventHandler,null,"image",i),panel.aButs.push(i),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0);else{var r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromLevelComplete",butEventHandler,{multiTouch:!0},"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromLevelComplete",butEventHandler,null,"image",o),panel.aButs.push(o);var n={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromLevelComplete",butEventHandler,null,"image",n),panel.aButs.push(n);var l={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromLevelComplete",butEventHandler,null,"image",l),panel.aButs.push(l);var m={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromLevelComplete",butEventHandler,null,"image",m),panel.aButs.push(m)}}function initWorldCompleteButs(){panel.startTween(),gameplayState=6,batShopButDown=!1;var e={oImgData:assetLib.getData("uiButs"),aPos:[-90,-210],align:[1,1],id:oImageIds.batShopBut,idOver:oImageIds.batShopButOver};userInput.addHitArea("batShopFromWorldComplete",butEventHandler,{multiTouch:!0},"image",e),panel.aButs.push(e);var t={oImgData:assetLib.getData("uiButs"),aPos:[0,50],align:[.5,.7],id:oImageIds.playBut,idOver:oImageIds.playButOver,flash:!0};userInput.addHitArea("playFromWorldComplete",butEventHandler,null,"image",t),panel.aButs.push(t);var a={oImgData:assetLib.getData("uiButs"),aPos:[90,-390],align:[0,1],id:oImageIds.challengeBut,idOver:oImageIds.challengeButOver};userInput.addHitArea("challengeFromWorldComplete",butEventHandler,null,"image",a),panel.aButs.push(a);var s={oImgData:assetLib.getData("uiButs"),aPos:[90,-210],align:[0,1],id:oImageIds.careerBut,idOver:oImageIds.careerButOver};userInput.addHitArea("careerFromWorldComplete",butEventHandler,null,"image",s),panel.aButs.push(s);var i={oImgData:assetLib.getData("uiButs"),aPos:[90,-570],align:[0,1],id:oImageIds.bugGameBut,idOver:oImageIds.bugGameButOver};userInput.addHitArea("bugGameFromWorldComplete",butEventHandler,null,"image",i),panel.aButs.push(i);var r={oImgData:assetLib.getData("uiButs"),aPos:[-90,-390],align:[1,1],id:oImageIds.pvpGameBut,idOver:oImageIds.pvpGameButOver,flash:!0};userInput.addHitArea("pvpFromWorldComplete",butEventHandler,null,"image",r),panel.aButs.push(r);var o={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromWorldComplete",butEventHandler,null,"image",o),panel.aButs.push(o)}function initNextLevel(){tableTop=new Elements.TableTop,userBat=new Elements.UserBat,enemyBat=new Elements.EnemyBat,aBalls=[];var e=new Elements.Ball;aBalls.push(e),opBat=getEnemyBat(),initGame()}function initAwards(){gameState="awards";var e=[],t={oImgData:assetLib.getData("uiButs"),aPos:[50,-50],align:[0,1],id:oImageIds.backBut,idOver:oImageIds.backButOver};userInput.addHitArea("backFromBatShop",butEventHandler,null,"image",t),e.push(t),aEffects=[],addMuteBut(e),(panel=new Elements.Panel(gameState,e)).startTween(),aEffects=[],previousTime=new Date().getTime(),updateAwardsEvent()}function addRewardGems(e){saveDataHandler.addGems(e),gems=saveDataHandler.getGems(),playSound("gemReward");for(var t=360*Math.random()*radian,a=0;a<100;a++){var s=new Elements.Particle(canvas.width-getDirectWidth(0,75,"00")-95+27,canvas.height-80+25,1*Math.random()+1,400*Math.random()+50,t+3.6*a*radian,20,1,50);aEffects.push(s)}rewardButHit=!0}function butEventHandler(e,t){if(!isRotated)switch(e){case"infoFromStart":playSound("click"),removeStartButs(),initCreditsScreen();break;case"resetData":playSound("click"),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),initResetConfirmScreen();break;case"yesFromResetConfirm":playSound("loseStar",.5),saveDataHandler.resetData(),updateBatShopData(),resetFromSaveData(),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("mute"),initStartScreen();break;case"noFromResetConfirm":playSound("click"),userInput.removeHitArea("yesFromResetConfirm"),userInput.removeHitArea("noFromResetConfirm"),userInput.removeHitArea("mute"),initCreditsScreen();break;case"backFromCredits":playSound("click"),userInput.removeHitArea("backFromCredits"),userInput.removeHitArea("resetData"),userInput.removeHitArea("minusGames"),userInput.removeHitArea("plusGames"),userInput.removeHitArea("minusSets"),userInput.removeHitArea("plusSets"),userInput.removeHitArea("mute"),initStartScreen();break;case"plusGames":playSound("click"),saveDataHandler.setCareerGames(Math.min(saveDataHandler.getCareerGames()+1,21));break;case"minusGames":playSound("click"),saveDataHandler.setCareerGames(Math.max(saveDataHandler.getCareerGames()-1,8));break;case"plusSets":playSound("click"),saveDataHandler.setCareerSets(Math.min(saveDataHandler.getCareerSets()+1,5));break;case"minusSets":playSound("click"),saveDataHandler.setCareerSets(Math.max(saveDataHandler.getCareerSets()-1,2));break;case"startTouch":playSound("click"),removeStartButs(),gameVariation=0,showAd(initGame),enemyBat.trackBall=!0;break;case"batShopFromStart":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),removeStartButs(),prevGameplayState=gameplayState,initBatShop());break;case"careerFromStart":playSound("click"),removeStartButs(),initMapScreen();break;case"bugGameFromStart":playSound("click"),removeStartButs(),gameVariation=3,initGame();break;case"pvpFromStart":playSound("click"),removeStartButs(),gameVariation=4,initPvpGame();break;case"urlFromNetwork":case"urlAreaFromNetwork":playSound("click"),netLib.shareLobbyCode(function(e){return panel.clipboardCallback(e)}),userInput.removeHitArea("urlFromNetwork"),panel.removeBut(oImageIds.shareBut);break;case"backFromNetwork":userInput.removeHitArea("backFromNetwork"),userInput.removeHitArea("urlFromNetwork"),userInput.removeHitArea("urlAreaFromNetwork"),initStartScreen();break;case"customMatchFromStart":playSound("click"),removeStartButs(),gameVariation=2,initGame();break;case"challengeFromStart":playSound("click"),removeStartButs(),gameVariation=1,initGame();break;case"awardsFromStart":playSound("click"),removeStartButs(),prevGameplayState=gameplayState,initAwards();break;case"backFromBatShop":playSound("click"),newBatId=null,userInput.removeHitArea("batShopTouch"),userInput.removeHitArea("backFromBatShop"),panel.removeBut(oImageIds.backBut),0==prevGameplayState?initStartScreen():4==prevGameplayState?(gameState="game",panel.aWinGems=[],(curLevel+1)%levelsPerWorld==0?panel.winGemTarg=aPointScores[1]:panel.winGemTarg=aPointScores[0],panel.winGemCount=0,initLevelCompleteButs(),previousTime=new Date().getTime(),updateGameEvent()):6==prevGameplayState?(gameState="game",initWorldCompleteButs(),previousTime=new Date().getTime(),updateGameEvent()):8==prevGameplayState?(gameState="game",panel.aWinGems=[],panel.winGemTarg=Math.round(curTargetScore/2),panel.winGemCount=0,initTargetGameEndButs(),previousTime=new Date().getTime(),updateGameEvent()):10==prevGameplayState?(gameState="game",panel.aWinGems=[],userSets>enemySets?panel.winGemTarg=50+10*saveDataHandler.getSeason()+saveDataHandler.getRound():panel.winGemTarg=25,panel.winGemCount=0,initCustomGameEndButs(),previousTime=new Date().getTime(),updateGameEvent()):12==prevGameplayState&&(gameState="game",panel.aWinGems=[],panel.winGemTarg=Math.ceil(bugScore/4),panel.winGemCount=0,initBugGameEndButs(),previousTime=new Date().getTime(),updateGameEvent());break;case"batShopTouch":t.y>100&&t.y<canvas.height-100&&(t.isDown&&!t.isBeingDragged?(batShop.startMoveY=batShop.targY,batShop.checkMoveY=0,t.x<canvas.width/2+(batShop.blocksX-1)*batShop.gapX-batShop.gapX*(batShop.blocksX/2-1)+batShop.posX?(batShop.sideTouched=0,batShop.startTouchY=t.y-batShop.targY):(batShop.sideTouched=1,batShop.startTouchY=t.y+batShop.targY/(1/batShop.barPerc)),butDown=!0):t.isBeingDragged?0==batShop.sideTouched?(batShop.targY=t.y-batShop.startTouchY,batShop.checkMoveY+=Math.abs(batShop.startMoveY-batShop.targY)):1==batShop.sideTouched&&(batShop.targY=-(t.y-batShop.startTouchY)*(1/batShop.barPerc),batShop.checkMoveY+=Math.abs(batShop.startMoveY-batShop.targY)):butDown&&(butDown=!1,(!isMobile&&batShop.checkMoveY<3||isMobile&&batShop.checkMoveY<10)&&batShop.checkClick(t.x,t.y)));break;case"gameTouch":t.isDown&&!t.isBeingDragged?(swipeState=1,startTouchY=t.y-userBat.targY):1==swipeState&&t.isBeingDragged?(userBat.targX=t.x,0==controlState?userBat.targY=t.y:userBat.targY=t.y-startTouchY):1==swipeState&&(swipeState=0);break;case"playFromMapScreen":playSound("click"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),firstCareerGame?prepForCareerMatch():showAd(prepForCareerMatch);break;case"backFromMapScreen":playSound("click"),userInput.removeHitArea("playFromMapScreen"),userInput.removeHitArea("backFromMapScreen"),initStartScreen();break;case"playFromPvpGameEnd":playSound("click"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.backBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),startPvpGame(),netLib.send(!0,"rematch");break;case"backFromPvpGameEnd":playSound("click"),userInput.removeHitArea("playFromPvpGameEnd"),userInput.removeHitArea("backFromPvpGameEnd"),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.backBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),netLib.disconnect(),initStartScreen();break;case"playFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initMapScreen();break;case"awardsFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"batShopFromCustomGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"challengeFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"arcadeFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"bugGameFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"backFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromCustomGameEnd":playSound("click"),userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"rewardFromCustomGameEnd":userInput.removeHitArea("playFromCustomGameEnd"),userInput.removeHitArea("rewardFromCustomGameEnd"),userInput.removeHitArea("batShopFromCustomGameEnd"),userInput.removeHitArea("challengeFromCustomGameEnd"),userInput.removeHitArea("arcadeFromCustomGameEnd"),userInput.removeHitArea("backFromCustomGameEnd"),userInput.removeHitArea("bugGameFromCustomGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.arcadeBut),userInput.removeHitArea("pvpFromCustomGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("customGameEnd");break;case"playFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),anyWorldBatsLeft()&&(curLevel+1)%levelsPerWorld==0?initWorldComplete():(curLevel=saveDataHandler.getLevel(),showAd(initNextLevel));break;case"batShopFromLevelComplete":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),userInput.removeHitArea("pvpFromLevelComplete"),prevGameplayState=gameplayState,initBatShop());break;case"rewardFromLevelComplete":userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("levelComplete");break;case"careerFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"challengeFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"bugGameFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"backFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromLevelComplete":playSound("click"),userInput.removeHitArea("playFromLevelComplete"),userInput.removeHitArea("batShopFromLevelComplete"),userInput.removeHitArea("rewardFromLevelComplete"),userInput.removeHitArea("careerFromLevelComplete"),userInput.removeHitArea("challengeFromLevelComplete"),userInput.removeHitArea("backFromLevelComplete"),userInput.removeHitArea("bugGameFromLevelComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromLevelComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"playFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),curLevel++,showAd(initNextLevel);break;case"batShopFromWorldComplete":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),userInput.removeHitArea("pvpFromWorldComplete"),prevGameplayState=gameplayState,initBatShop());break;case"customMatchFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=2,showAd(initGame);break;case"challengeFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"bugGameFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"careerFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"backFromWorldComplete":playSound("click"),userInput.removeHitArea("playFromWorldComplete"),userInput.removeHitArea("batShopFromWorldComplete"),userInput.removeHitArea("careerFromWorldComplete"),userInput.removeHitArea("challengeFromWorldComplete"),userInput.removeHitArea("backFromWorldComplete"),userInput.removeHitArea("bugGameFromWorldComplete"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromWorldComplete"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"rewardFromTargetGameEnd":userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("targetGameEnd");break;case"playFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initGame);break;case"batShopFromTargetGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"backFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"careerFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"arcadeFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"bugGameFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=3,showAd(initGame);break;case"awardsFromTargetGameEnd":playSound("click"),userInput.removeHitArea("playFromTargetGameEnd"),userInput.removeHitArea("batShopFromTargetGameEnd"),userInput.removeHitArea("careerFromTargetGameEnd"),userInput.removeHitArea("arcadeFromTargetGameEnd"),userInput.removeHitArea("awardsFromTargetGameEnd"),userInput.removeHitArea("rewardFromTargetGameEnd"),userInput.removeHitArea("backFromTargetGameEnd"),userInput.removeHitArea("bugGameFromTargetGameEnd"),panel.removeBut(oImageIds.bugGameBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromTargetGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"rewardFromBugGameEnd":userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showRewardAd("bugGameEnd");break;case"playFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initGame);break;case"batShopFromBugGameEnd":t.isDown&&(batShopButDown=!0),t.isUp&&batShopButDown&&(batShopButDown=!1,playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initBatShop());break;case"backFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),initStartScreen(!1);break;case"pvpFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=4,initPvpGame();break;case"careerFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),showAd(initMapScreen);break;case"arcadeFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=0,showAd(initGame);break;case"challengeFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),gameVariation=1,showAd(initGame);break;case"awardsFromBugGameEnd":playSound("click"),userInput.removeHitArea("playFromBugGameEnd"),userInput.removeHitArea("batShopFromBugGameEnd"),userInput.removeHitArea("careerFromBugGameEnd"),userInput.removeHitArea("arcadeFromBugGameEnd"),userInput.removeHitArea("awardsFromBugGameEnd"),userInput.removeHitArea("rewardFromBugGameEnd"),userInput.removeHitArea("backFromBugGameEnd"),userInput.removeHitArea("challengeFromBugGameEnd"),panel.removeBut(oImageIds.challengeBut),panel.removeBut(oImageIds.backBut),panel.removeBut(oImageIds.rewardMultiplyBut),panel.removeBut(oImageIds.awardsBut),panel.removeBut(oImageIds.playBut),panel.removeBut(oImageIds.batShopBut),panel.removeBut(oImageIds.arcadeBut),panel.removeBut(oImageIds.classicGameBut),panel.removeBut(oImageIds.careerBut),userInput.removeHitArea("pvpFromBugGameEnd"),panel.removeBut(oImageIds.pvpGameBut),prevGameplayState=gameplayState,initAwards();break;case"mute":playSound("click"),toggleMute(),muted?(panel.switchBut(oImageIds.muteBut0,oImageIds.muteBut1,oImageIds.muteBut1Over),saveDataHandler.setAudioState(1)):(panel.switchBut(oImageIds.muteBut1,oImageIds.muteBut0,oImageIds.muteBut0Over),saveDataHandler.setAudioState(0));break;case"keyPauseOn":t.isDown||butEventHandler("pause",null);break;case"pause":playSound("click"),1==audioType?(Howler.mute(!0),music.pause()):2==audioType&&music.pause(),userInput.removeHitArea("pause"),userInput.removeHitArea("gameTouch"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOn"),initPause();break;case"keyPauseOff":t.isDown||butEventHandler("continueFromPause",null);break;case"continueFromPause":playSound("click"),1==audioType?muted||(Howler.mute(!1),playMusic()):2!=audioType||muted||playMusic(),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOff"),resumeGame();break;case"quitFromPause":t.isDown||t.isBeingDragged||t.hasLeft||(playSound("click"),1==audioType?muted||(Howler.mute(!1),playMusic()):2!=audioType||muted||playMusic(),userInput.removeHitArea("quitFromPause"),userInput.removeHitArea("continueFromPause"),userInput.removeHitArea("mute"),userInput.removeKey("keyPauseOff"),4==gameVariation&&netLib.disconnect(),gameVariation=0,initStartScreen())}}function getSeasonFlags(e){for(var t=[],a=0;a<aFlags.length;a++)t.push(a);t=shuffleArray(t);for(var s=[],a=0;a<6;a++)s.push({id:t[a],rank:getEnemyRank()});return sortBy(s,"rank",!1)}function getEnemyRank(){for(var e=saveDataHandler.getRank(),t=saveDataHandler.getSeason();e==saveDataHandler.getRank();)e=Math.ceil(Math.random()*Math.max(6-t,1)*30+60*Math.max(6-t,0));return e}function shuffleArray(e){for(var t,a=e.length-1;a>0;a--){var s=Math.floor(Math.random()*(a+1));t=[e[s],e[a]],e[a]=t[0],e[s]=t[1]}return e}function sortBy(e,t,a){return(void 0===a&&(a=!0),a)?e.sort(function(e,a){return e[t]<a[t]?-1:e[t]>a[t]?1:0}):e.sort(function(e,a){return e[t]>a[t]?-1:e[t]<a[t]?1:0})}function getSpriteData(e,t){return{img:e.img,bX:e.oData.oAtlasData[oImageIds[t]].x,bY:e.oData.oAtlasData[oImageIds[t]].y,bWidth:e.oData.oAtlasData[oImageIds[t]].width,bHeight:e.oData.oAtlasData[oImageIds[t]].height}}function getMultiLineTextByChars(e,t,a){for(var s=[],i=getText(e,a);i.length>t;){var r=i.substring(0,t).lastIndexOf(" ");-1==r?(s.push(i.substring(0,t)+"-"),i=i.substring(t+1)):(s.push(i.substring(0,r)),i=i.substring(r+1))}return s.push(i),s}function addDirectText(e,t,a,s,i,r,o,n){if(void 0===n&&(n="#202020"),ctx.fillStyle=n,ctx.textAlign=s,a<getDirectWidth(e,t,o))for(t--;a<getDirectWidth(e,t,o)&&(t--,1););ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.fillText(o,i,r)}function addText(e,t,a,s,i,r,o,n){if(void 0===n&&(n="#202020"),ctx.fillStyle=n,ctx.textAlign=s,a<getTextWidth(e,t,o))for(t--;a<getTextWidth(e,t,o)&&(t--,1););"ar"==curLang&&(r-=t/15),ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.fillText(getText(o,e),i,r)}function getText(e,t){var a=assetLib.textData.langText[e][curLang];if("tr"==curLang){for(var s,i="",r=0;r<a.length;)s=a.charAt(r),"Bangers"==assetLib.textData.langText["font"+t][curLang]&&"i"==s&&(s="Ä°"),i+=s,r++;a=i}return a}function getTextWidth(e,t,a){return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(getText(a,e)).width}function getDirectWidth(e,t,a){return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(a).width}function getCorrectedTextWidth(e,t,a,s){if(a<getTextWidth(e,t,s))for(t--;a<getTextWidth(e,t,s)&&(t--,1););return ctx.font=t+"px "+assetLib.textData.langText["font"+e][curLang],ctx.measureText(getText(s,e)).width}function checkButtonsOver(){if(!isMobile)for(var e=0;e<panel.aButs.length;e++)panel.aButs[e].isOver=!1,userInput.mouseX>panel.aButs[e].aOverData[0]&&userInput.mouseX<panel.aButs[e].aOverData[2]&&userInput.mouseY>panel.aButs[e].aOverData[1]&&userInput.mouseY<panel.aButs[e].aOverData[3]&&(panel.aButs[e].isOver=!0)}function clearButtonOvers(){userInput.mouseX=-100,userInput.mouseY=-100}function updateScore(e){var t=!1;if("user"==e&&rallyHits>3&&Math.random()>.5&&(playSound("cheer"+Math.floor(6*Math.random())),t=!0),0==gameVariation){if("user"==e){enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff+.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax);for(var a=0;a<15;a++){var s=canvas.width/2+70*curLevelStars-70*(levelStarTarg/2-.5)-100*panel.starsX,i=Math.max(onScreenY-200,60)-100*panel.starsY,r=new Elements.Particle(s,i,1,200,24*a*radian,100);aEffects.push(r)}playSound("winStar"),curLevelStars++,panel.tweenStars(!0),curLevelStars!=levelStarTarg||(initGameWon(),playSound("arcadeWin"),t||playSound("cheer"+Math.floor(6*Math.random())))}else enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff-.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),curLevelStars>0&&curLevelStars--,panel.tweenStars(!1),playSound("loseStar")}else if(2==gameVariation||4==gameVariation){var o,n=!1;if("user"==e){if(userScore++,enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff+.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),playSound("classicGameWin",.5),panel.tweenCustomGameScore(0),2==gameVariation)(enemyScore<saveDataHandler.getCareerGames()-1&&userScore==saveDataHandler.getCareerGames()||enemyScore>=saveDataHandler.getCareerGames()-1&&userScore>=enemyScore+2)&&(userSets++,userScore=enemyScore=0,t||playSound("cheer"+Math.floor(6*Math.random())),userSets>=saveDataHandler.getCareerSets()?(initCustomGameComplete(),playSound("classicMatchWin",.5)):(n=!0,playSound("winSet",.3)));else if(4==gameVariation){if(console.log("rallyHits",rallyHits),rallyHits>8||Math.random()>.8){userBat.successFlip(),panel.showCongrats(),playSound("hitTarget",.3),playSound("cheer"+Math.floor(6*Math.random()));for(var a=0;a<25;a++){var l=new Elements.Confetti(canvas.width/2+400*Math.random()-200,.9*canvas.height);aEffects.push(l)}}(enemyScore<10&&11==userScore||enemyScore>=10&&userScore>=enemyScore+2)&&(t||playSound("cheer"+Math.floor(6*Math.random())),initPvpGameComplete(),playSound("classicMatchWin",.5))}o=-80}else enemyScore++,enemyBat.scoreDiff=Math.min(Math.max(enemyBat.scoreDiff-.025,-enemyBat.scoreDiffMax),enemyBat.scoreDiffMax),playSound("classicGameLose",.5),panel.tweenCustomGameScore(1),2==gameVariation?(userScore<saveDataHandler.getCareerGames()-1&&enemyScore==saveDataHandler.getCareerGames()||userScore>=saveDataHandler.getCareerGames()-1&&enemyScore>=userScore+2)&&(enemySets++,userScore=enemyScore=0,t||playSound("cheer"+Math.floor(6*Math.random())),enemySets>=saveDataHandler.getCareerSets()?(initCustomGameComplete(),playSound("classicMatchLose",.5)):(n=!0,playSound("loseSet",.5))):4==gameVariation&&(userScore<10&&11==enemyScore||userScore>=10&&enemyScore>=userScore+2)&&(t||playSound("cheer"+Math.floor(6*Math.random())),initPvpGameComplete(),playSound("classicMatchLose",.5)),o=80;for(var s=canvas.width/2+o,i=Math.max(onScreenY-200,60)-100*panel.starsY-10,a=0;a<15;a++){var r=new Elements.Particle(s,i,1,200,24*a*radian,100,.75,50);aEffects.push(r)}if(n)for(var a=0;a<50;a++){var l=new Elements.Confetti(s+200*Math.random()-100,i+200*Math.random()-100);aEffects.push(l)}}}function addFirework(e,t,a){if(void 0===a&&(a=1),!(aEffects.length>10)){var s=new Elements.Firework;s.x=e,s.y=t,s.endScale=a,s.blowUp(),aEffects.push(s)}}function updateGameEvent(){if("game"==gameState){if(delta=getDelta(),background.render(),4==gameVariation&&(pvpGameTime+=delta,netLib.peer&&netLib.peer.latency&&pvpGameTime>5&&netLib.peer.latency.average>250&&(networkMessage("latency"),netLib.send(!0,"latency")),(networkInc+=delta)>1/30)){var e=getSpriteData(assetLib.getData("gameElements"),"tableEdge").bWidth,t=(userBat.x-canvas.width/2-500*tableTop.offsetX*tableTop.genScale)/(e*tableTop.genScale/2),a=(userBat.y-(onScreenY+352*(1+tableTop.offsetY/2)+50*tableTop.offsetY))*.18+40;netLib.send(!1,"batPos",[Math.round(1e3*t)/1e3,Math.round(1e3*a)/1e3,Math.round(1e3*userBat.rotation)/1e3]),networkInc=0}for(var s=0;s<aBalls.length;s++)0==aBalls[s].curBallState&&(curBallId=s),2==aBalls[s].curBallState&&(aBalls.splice(s,1),s-=1);for(var s=0;s<aBalls.length;s++)aBalls[s].update(),s==curBallId&&(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.update(),aBalls[s].offTable||aBalls[s].offSide||aBalls[s].height<0&&aBalls[s].tablePosY<.5&&(aBalls[s].tablePosX<-1||aBalls[s].tablePosX>1)?(aBalls[s].render(),s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet())):aBalls[s].tablePosY>.5?(s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet()),aBalls[s].render()):aBalls[s].tablePosY<.5&&(1!=gameVariation&&s==curBallId&&aBalls[s].y<enemyBat.y+200*enemyBat.scale-30?(tableTop.render(),aBalls[s].render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render(),tableTop.renderNet()):(s==curBallId&&(tableTop.render(),(0==gameVariation||2==gameVariation||4==gameVariation)&&enemyBat.render()),aBalls[s].render(),s==curBallId&&tableTop.renderNet()));(0==aBalls.length||curBallId>=aBalls.length)&&(curBallId=0,tableTop.render(),tableTop.renderNet()),userBat.update(),userBat.render(),panel.update(),panel.render(),awardPanel.render();for(var s=0;s<aEffects.length;s++)aEffects[s].update(),aEffects[s].render(),aEffects[s].removeMe&&(aEffects.splice(s,1),s-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateGameEvent)}}function updateAwardsEvent(){if("awards"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateAwardsEvent)}}function updateMapScreenEvent(){if("mapScreen"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateMapScreenEvent)}}function updateBatShopEvent(){if("batShop"==gameState){delta=getDelta(),background.render(),panel.update(),panel.render(),batShop.update(),batShop.render(),awardPanel.render();for(var e=0;e<aEffects.length;e++)aEffects[e].update(),aEffects[e].render(),aEffects[e].removeMe&&(aEffects.splice(e,1),e-=1);checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateBatShopEvent)}}function updateCreditsScreenEvent(){"credits"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateCreditsScreenEvent))}function updateNetworkScreenEvent(){"network"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateNetworkScreenEvent))}function updateResetConfirmEvent(){"resetConfirm"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),awardPanel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updateResetConfirmEvent))}function updateLoaderEvent(){"loading"==gameState&&(delta=getDelta(),assetLib.render(),requestAnimFrame(updateLoaderEvent))}function updatePauseEvent(){"pause"==gameState&&(delta=getDelta(),background.render(),panel.update(),panel.render(),checkButtonsOver(),panel.renderPointer(),requestAnimFrame(updatePauseEvent))}function getDelta(){var e=new Date().getTime(),t=(e-previousTime)/1e3;return previousTime=e,t>.5&&(t=0),t}function checkSpriteCollision(e,t){var a=e.x,s=e.y,i=t.x,r=t.y;return(a-i)*(a-i)+(s-r)*(s-r)<e.radius*t.radius}function getScaleImageToMax(e,t){var a;return e.isSpriteSheet?t[0]/e.oData.spriteWidth<t[1]/e.oData.spriteHeight?Math.min(t[0]/e.oData.spriteWidth,1):Math.min(t[1]/e.oData.spriteHeight,1):t[0]/e.img.width<t[1]/e.img.height?Math.min(t[0]/e.img.width,1):Math.min(t[1]/e.img.height,1)}function getCentreFromTopLeft(e,t,a){var s=[];return s.push(e[0]+t.oData.spriteWidth/2*a),s.push(e[1]+t.oData.spriteHeight/2*a),s}function loadPreAssets(){(preAssetLib=new Utils.AssetLoader(curLang,[{id:"loader",file:"images/loader.png"},{id:"loadSpinner",file:"images/loadSpinner.png"}],ctx,canvas.width,canvas.height,!1)).onReady(initLoadAssets)}function initLangSelect(){for(var e,t,a,s=0,i=0,r=0;r<aLangs.length;r++)if(e=preAssetLib.getData("lang"+aLangs[r]),(r+1)*(1*e.img.width)+(r+2)*10<canvas.width)s++;else break;i=Math.ceil(aLangs.length/s);for(var r=0;r<aLangs.length;r++){e=preAssetLib.getData("lang"+aLangs[r]),t=canvas.width/2-s/2*(1*e.img.width)-(s-1)/2*10,t+=r%s*(1*e.img.width+10),a=canvas.height/2-i/2*(1*e.img.height)-(i-1)/2*10,a+=Math.floor(r/s)%i*(1*e.img.height+10),ctx.drawImage(e.img,0,0,e.img.width,e.img.height,t,a,1*e.img.width,1*e.img.height);var o={oImgData:e,aPos:[t+1*e.img.width/2,a+1*e.img.height/2],scale:1,id:"none",noMove:!0};userInput.addHitArea("langSelect",butEventHandler,{lang:aLangs[r]},"image",o)}}function initLoadAssets(){loadAssets()}function loadAssets(){assetLib=new Utils.AssetLoader(curLang,[{id:"uiButs",file:"images/uiButs.png",oAtlasData:{id0:{x:525,y:138,width:132,height:136},id1:{x:525,y:0,width:132,height:136},id10:{x:0,y:548,width:196,height:200},id11:{x:0,y:346,width:196,height:200},id12:{x:0,y:173,width:255,height:171},id13:{x:0,y:0,width:255,height:171},id14:{x:84,y:760,width:82,height:82},id15:{x:168,y:760,width:82,height:82},id16:{x:0,y:760,width:82,height:82},id17:{x:734,y:306,width:82,height:82},id18:{x:600,y:552,width:132,height:136},id19:{x:600,y:414,width:132,height:136},id2:{x:600,y:690,width:132,height:136},id20:{x:600,y:276,width:132,height:136},id21:{x:466,y:690,width:132,height:136},id22:{x:659,y:138,width:82,height:82},id23:{x:734,y:222,width:82,height:82},id24:{x:466,y:552,width:132,height:136},id25:{x:466,y:414,width:132,height:136},id26:{x:466,y:276,width:132,height:136},id27:{x:391,y:138,width:132,height:136},id28:{x:391,y:0,width:132,height:136},id29:{x:332,y:690,width:132,height:136},id3:{x:659,y:0,width:132,height:136},id30:{x:252,y:760,width:54,height:54},id31:{x:793,y:0,width:54,height:54},id32:{x:793,y:56,width:54,height:54},id33:{x:257,y:276,width:54,height:54},id34:{x:257,y:0,width:132,height:136},id35:{x:332,y:414,width:132,height:136},id36:{x:332,y:552,width:132,height:136},id37:{x:198,y:346,width:132,height:136},id38:{x:198,y:622,width:132,height:136},id39:{x:198,y:484,width:132,height:136},id4:{x:734,y:726,width:82,height:82},id40:{x:257,y:138,width:132,height:136},id41:{x:332,y:276,width:132,height:136},id5:{x:734,y:642,width:82,height:82},id6:{x:734,y:558,width:82,height:82},id7:{x:734,y:474,width:82,height:82},id8:{x:734,y:390,width:82,height:82},id9:{x:743,y:138,width:82,height:82}}},{id:"flags",file:"images/flags.png",oAtlasData:{id0:{x:198,y:297,width:97,height:97},id1:{x:396,y:495,width:97,height:97},id10:{x:297,y:198,width:97,height:97},id11:{x:297,y:99,width:97,height:97},id12:{x:297,y:0,width:97,height:97},id13:{x:198,y:495,width:97,height:97},id14:{x:198,y:396,width:97,height:97},id15:{x:495,y:0,width:97,height:97},id16:{x:198,y:198,width:97,height:97},id17:{x:198,y:99,width:97,height:97},id18:{x:198,y:0,width:97,height:97},id19:{x:99,y:495,width:97,height:97},id2:{x:396,y:396,width:97,height:97},id20:{x:99,y:396,width:97,height:97},id21:{x:99,y:297,width:97,height:97},id22:{x:99,y:198,width:97,height:97},id23:{x:99,y:99,width:97,height:97},id24:{x:99,y:0,width:97,height:97},id25:{x:0,y:495,width:97,height:97},id26:{x:0,y:396,width:97,height:97},id27:{x:0,y:297,width:97,height:97},id28:{x:0,y:198,width:97,height:97},id29:{x:0,y:99,width:97,height:97},id3:{x:396,y:297,width:97,height:97},id30:{x:0,y:0,width:97,height:97},id4:{x:396,y:198,width:97,height:97},id5:{x:396,y:99,width:97,height:97},id6:{x:396,y:0,width:97,height:97},id7:{x:297,y:495,width:97,height:97},id8:{x:297,y:396,width:97,height:97},id9:{x:297,y:297,width:97,height:97}}},{id:"flare",file:"images/flare.png"},{id:"gameElements",file:"images/gameElements.png",oAtlasData:{id0:{x:0,y:47,width:618,height:51},id1:{x:182,y:1395,width:62,height:62},id10:{x:1226,y:564,width:172,height:280},id11:{x:1310,y:0,width:172,height:280},id12:{x:1400,y:1692,width:172,height:280},id13:{x:1400,y:1128,width:172,height:280},id14:{x:1574,y:1692,width:172,height:280},id15:{x:1574,y:1410,width:172,height:280},id16:{x:1574,y:1128,width:172,height:280},id17:{x:1574,y:846,width:172,height:280},id18:{x:1574,y:564,width:172,height:280},id19:{x:1484,y:0,width:172,height:280},id2:{x:182,y:1357,width:65,height:36},id20:{x:1478,y:282,width:172,height:280},id21:{x:1136,y:0,width:172,height:280},id22:{x:1400,y:1410,width:172,height:280},id23:{x:1304,y:282,width:172,height:280},id24:{x:1400,y:846,width:172,height:280},id25:{x:1400,y:564,width:172,height:280},id26:{x:1226,y:1692,width:172,height:280},id27:{x:1226,y:1410,width:172,height:280},id28:{x:1226,y:1128,width:172,height:280},id29:{x:1226,y:846,width:172,height:280},id3:{x:0,y:845,width:299,height:87},id30:{x:356,y:1409,width:172,height:280},id31:{x:356,y:1127,width:172,height:280},id32:{x:1130,y:282,width:172,height:280},id33:{x:530,y:1409,width:172,height:280},id34:{x:356,y:1691,width:172,height:280},id35:{x:1052,y:1739,width:172,height:280},id36:{x:1052,y:1457,width:172,height:280},id37:{x:1052,y:1175,width:172,height:280},id38:{x:1052,y:893,width:172,height:280},id39:{x:356,y:845,width:172,height:280},id4:{x:0,y:552,width:606,height:13},id40:{x:962,y:0,width:172,height:280},id41:{x:956,y:329,width:172,height:280},id42:{x:878,y:1792,width:172,height:280},id43:{x:878,y:1510,width:172,height:280},id44:{x:878,y:1228,width:172,height:280},id45:{x:878,y:946,width:172,height:280},id46:{x:878,y:664,width:172,height:280},id47:{x:788,y:47,width:172,height:280},id48:{x:782,y:382,width:172,height:280},id49:{x:704,y:1680,width:172,height:280},id5:{x:0,y:0,width:896,height:45},id50:{x:704,y:1398,width:172,height:280},id51:{x:704,y:1116,width:172,height:280},id52:{x:704,y:834,width:172,height:280},id53:{x:614,y:100,width:172,height:280},id54:{x:608,y:552,width:172,height:280},id55:{x:530,y:1691,width:172,height:280},id56:{x:0,y:1780,width:178,height:284},id57:{x:1748,y:920,width:165,height:332},id58:{x:0,y:1214,width:180,height:278},id59:{x:1908,y:1549,width:148,height:286},id6:{x:182,y:1459,width:37,height:21},id60:{x:1748,y:1254,width:158,height:293},id61:{x:1748,y:1549,width:158,height:289},id62:{x:180,y:1786,width:174,height:290},id63:{x:1658,y:0,width:166,height:291},id64:{x:182,y:934,width:172,height:280},id65:{x:0,y:567,width:606,height:49},id66:{x:0,y:326,width:612,height:224},id67:{x:182,y:1216,width:120,height:139},id68:{x:0,y:1494,width:178,height:284},id69:{x:1748,y:586,width:165,height:332},id7:{x:530,y:845,width:172,height:280},id70:{x:0,y:934,width:180,height:278},id71:{x:1915,y:586,width:148,height:286},id72:{x:1908,y:1254,width:158,height:293},id73:{x:1826,y:0,width:158,height:289},id74:{x:180,y:1494,width:174,height:290},id75:{x:1748,y:293,width:166,height:291},id76:{x:0,y:618,width:603,height:225},id77:{x:0,y:100,width:612,height:224},id8:{x:1052,y:611,width:172,height:280},id9:{x:530,y:1127,width:172,height:280}}},{id:"uiElements",file:"images/uiElements.png",oAtlasData:{id0:{x:193,y:1054,width:70,height:66},id1:{x:271,y:825,width:182,height:177},id10:{x:653,y:1067,width:62,height:58},id11:{x:359,y:1034,width:85,height:86},id12:{x:628,y:751,width:171,height:249},id13:{x:868,y:248,width:167,height:245},id14:{x:801,y:747,width:168,height:245},id15:{x:868,y:0,width:168,height:246},id16:{x:751,y:500,width:168,height:245},id17:{x:404,y:500,width:172,height:281},id18:{x:0,y:1054,width:191,height:70},id19:{x:894,y:1053,width:40,height:37},id2:{x:718,y:1002,width:59,height:60},id20:{x:837,y:994,width:56,height:57},id21:{x:578,y:500,width:171,height:249},id22:{x:455,y:783,width:171,height:249},id23:{x:0,y:792,width:311,height:31},id24:{x:0,y:760,width:311,height:30},id25:{x:921,y:495,width:165,height:242},id26:{x:717,y:1067,width:59,height:60},id27:{x:313,y:760,width:84,height:48},id28:{x:779,y:1002,width:56,height:57},id29:{x:838,y:1053,width:54,height:54},id3:{x:271,y:1017,width:42,height:11},id30:{x:936,y:1044,width:31,height:47},id31:{x:446,y:1034,width:71,height:81},id32:{x:653,y:1002,width:63,height:63},id33:{x:0,y:0,width:866,height:498},id34:{x:0,y:825,width:269,height:227},id35:{x:895,y:994,width:36,height:48},id36:{x:933,y:994,width:36,height:48},id37:{x:0,y:630,width:402,height:128},id38:{x:399,y:783,width:49,height:38},id39:{x:0,y:500,width:402,height:128},id4:{x:271,y:1004,width:42,height:11},id40:{x:315,y:1004,width:33,height:28},id5:{x:519,y:1034,width:65,height:65},id6:{x:271,y:1034,width:86,height:86},id7:{x:971,y:739,width:160,height:248},id8:{x:586,y:1034,width:65,height:65},id9:{x:778,y:1064,width:58,height:56}}},{id:"awards",file:"images/awards.png",oAtlasData:{id0:{x:294,y:330,width:145,height:163},id1:{x:588,y:330,width:145,height:163},id10:{x:240,y:165,width:145,height:163},id11:{x:240,y:0,width:145,height:163},id12:{x:147,y:591,width:145,height:163},id13:{x:147,y:426,width:145,height:163},id14:{x:0,y:591,width:145,height:163},id15:{x:0,y:426,width:145,height:163},id16:{x:0,y:278,width:153,height:146},id17:{x:0,y:0,width:238,height:276},id2:{x:534,y:165,width:145,height:163},id3:{x:534,y:0,width:145,height:163},id4:{x:441,y:495,width:145,height:163},id5:{x:441,y:330,width:145,height:163},id6:{x:387,y:165,width:145,height:163},id7:{x:387,y:0,width:145,height:163},id8:{x:294,y:495,width:145,height:163},id9:{x:588,y:495,width:145,height:163}}},{id:"bugs",file:"images/bugs.png",oAtlasData:{id0:{x:124,y:300,width:122,height:115},id1:{x:372,y:194,width:122,height:104},id2:{x:248,y:301,width:122,height:101},id3:{x:248,y:194,width:122,height:105},id4:{x:372,y:300,width:122,height:136},id5:{x:124,y:194,width:122,height:104},id6:{x:0,y:304,width:122,height:105},id7:{x:0,y:194,width:122,height:108},id8:{x:0,y:0,width:502,height:192}}},{id:"langText",file:"json/text.json"},{id:"info",file:"images/splashLogo.png"},{id:"bg0",file:"images/bg0.jpg"},{id:"bg1",file:"images/bg1.jpg"},{id:"bg2",file:"images/bg2.jpg"},{id:"bg3",file:"images/bg3.jpg"},{id:"bg4",file:"images/bg4.jpg"},{id:"fadeBg0",file:"images/spinBg0.jpg"},{id:"fadeBg1",file:"images/spinBg1.jpg"},{id:"fadeBg2",file:"images/spinBg2.jpg"}],ctx,canvas.width,canvas.height),oImageIds.net="id0",oImageIds.ball0="id1",oImageIds.ballShadow="id2",oImageIds.batShadow="id3",oImageIds.tableClip="id4",oImageIds.tableEdge="id5",oImageIds.bounceMark="id6",oImageIds.bat0="id7",oImageIds.bat1="id8",oImageIds.bat2="id9",oImageIds.bat3="id10",oImageIds.bat4="id11",oImageIds.bat5="id12",oImageIds.bat6="id13",oImageIds.bat7="id14",oImageIds.bat8="id15",oImageIds.bat9="id16",oImageIds.bat10="id17",oImageIds.bat11="id18",oImageIds.bat12="id19",oImageIds.bat13="id20",oImageIds.bat14="id21",oImageIds.bat15="id22",oImageIds.bat16="id23",oImageIds.bat17="id24",oImageIds.bat18="id25",oImageIds.bat19="id26",oImageIds.bat20="id27",oImageIds.bat21="id28",oImageIds.bat22="id29",oImageIds.bat23="id30",oImageIds.bat24="id31",oImageIds.bat25="id32",oImageIds.bat26="id33",oImageIds.bat27="id34",oImageIds.bat28="id35",oImageIds.bat29="id36",oImageIds.bat30="id37",oImageIds.bat31="id38",oImageIds.bat32="id39",oImageIds.bat33="id40",oImageIds.bat34="id41",oImageIds.bat35="id42",oImageIds.bat36="id43",oImageIds.bat37="id44",oImageIds.bat38="id45",oImageIds.bat39="id46",oImageIds.bat40="id47",oImageIds.bat41="id48",oImageIds.bat42="id49",oImageIds.bat43="id50",oImageIds.bat44="id51",oImageIds.bat45="id52",oImageIds.bat46="id53",oImageIds.bat47="id54",oImageIds.bat48="id55",oImageIds.bat49="id56",oImageIds.bat50="id57",oImageIds.bat51="id58",oImageIds.bat52="id59",oImageIds.bat53="id60",oImageIds.bat54="id61",oImageIds.bat55="id62",oImageIds.bat56="id63",oImageIds.batBehind0="id64",oImageIds.netReflect="id65",oImageIds.target0="id66",oImageIds.bot="id67",oImageIds.batBehind49="id68",oImageIds.batBehind50="id69",oImageIds.batBehind51="id70",oImageIds.batBehind52="id71",oImageIds.batBehind53="id72",oImageIds.batBehind54="id73",oImageIds.batBehind55="id74",oImageIds.batBehind56="id75",oImageIds.targetZoom="id76",oImageIds.target1="id77",oImageIds.bug0="id0",oImageIds.bug1="id1",oImageIds.bug2="id2",oImageIds.bug3="id3",oImageIds.bug4="id4",oImageIds.bug5="id5",oImageIds.bug6="id6",oImageIds.bug7="id7",oImageIds.bugBack="id8",oImageIds.award0="id0",oImageIds.award1="id1",oImageIds.award2="id2",oImageIds.award3="id3",oImageIds.award4="id4",oImageIds.award5="id5",oImageIds.award6="id6",oImageIds.award7="id7",oImageIds.award8="id8",oImageIds.award9="id9",oImageIds.award10="id10",oImageIds.award11="id11",oImageIds.award12="id12",oImageIds.award13="id13",oImageIds.award14="id14",oImageIds.award15="id15",oImageIds.award16="id16",oImageIds.awardBg="id17",oImageIds.batShopBut="id0",oImageIds.batShopButOver="id1",oImageIds.pvpGameBut="id2",oImageIds.pvpGameButOver="id3",oImageIds.infoBut="id4",oImageIds.infoButOver="id5",oImageIds.muteBut1="id6",oImageIds.muteBut1Over="id7",oImageIds.muteBut0="id8",oImageIds.muteBut0Over="id9",oImageIds.playBut="id10",oImageIds.playButOver="id11",oImageIds.rewardMultiplyBut="id12",oImageIds.rewardMultiplyButOver="id13",oImageIds.backBut="id14",oImageIds.backButOver="id15",oImageIds.pauseBut="id16",oImageIds.pauseButOver="id17",oImageIds.quitBut="id18",oImageIds.quitButOver="id19",oImageIds.continueBut="id20",oImageIds.continueButOver="id21",oImageIds.resetBut="id22",oImageIds.resetButOver="id23",oImageIds.awardsBut="id24",oImageIds.awardsButOver="id25",oImageIds.challengeBut="id26",oImageIds.challengeButOver="id27",oImageIds.arcadeBut="id28",oImageIds.arcadeButOver="id29",oImageIds.minusBut="id30",oImageIds.minusButOver="id31",oImageIds.plusBut="id32",oImageIds.plusButOver="id33",oImageIds.bugGameBut="id34",oImageIds.bugGameButOver="id35",oImageIds.tickBut="id36",oImageIds.tickButOver="id37",oImageIds.careerBut="id38",oImageIds.careerButOver="id39",oImageIds.shareBut="id40",oImageIds.shareButOver="id41",oImageIds.smallGem=getAssetId(!0),oImageIds.bigGem=getAssetId(),oImageIds.smallCup=getAssetId(),oImageIds.progressLine0=getAssetId(),oImageIds.progressLine1=getAssetId(),oImageIds.progressCup0=getAssetId(),oImageIds.progressCup2=getAssetId(),oImageIds.startFinger=getAssetId(),oImageIds.progressCup1=getAssetId(),oImageIds.star1=getAssetId(),oImageIds.star0=getAssetId(),oImageIds.progressCup3=getAssetId(),oImageIds.batShopOverlay0=getAssetId(),oImageIds.batShopUnderlay0=getAssetId(),oImageIds.batShopUnderlay1=getAssetId(),oImageIds.batShopUnderlay2=getAssetId(),oImageIds.batShopUnderlay3=getAssetId(),oImageIds.batDropShadow=getAssetId(),oImageIds.batLock=getAssetId(),oImageIds.rewardIcon=getAssetId(),oImageIds.tick=getAssetId(),oImageIds.batShopOverlay1=getAssetId(),oImageIds.batShopOverlay2=getAssetId(),oImageIds.batShopBorder0=getAssetId(),oImageIds.batShopBorder1=getAssetId(),oImageIds.batShopGlow=getAssetId(),oImageIds.targetIcon=getAssetId(),oImageIds.setsBg=getAssetId(),oImageIds.classicTick1=getAssetId(),oImageIds.classicTick0=getAssetId(),oImageIds.mousePointer=getAssetId(),oImageIds.stopWatch=getAssetId(),oImageIds.bugIcon=getAssetId(),oImageIds.map=getAssetId(),oImageIds.pin0=getAssetId(),oImageIds.pin1=getAssetId(),oImageIds.pin2=getAssetId(),oImageIds.shareHeader0=getAssetId(),oImageIds.shareTick=getAssetId(),oImageIds.shareHeader1=getAssetId(),oImageIds.crown=getAssetId(),oImageIds.flag0=getAssetId(!0);for(var e=1;e<aFlags.length;e++)oImageIds["flag"+e]=getAssetId();assetLib.onReady(initSplash),gameState="loading",previousTime=new Date().getTime(),updateLoaderEvent()}function getAssetId(e){return void 0===e&&(e=!1),e&&(assetIdInc=0),"id"+assetIdInc++}function resizeCanvas(){var e,t,a,s,i=window.innerWidth,r=window.innerHeight;switch(canvas.height=r,canvas.width=i,canvas.style.width=i+"px",canvas.style.height=r+"px",canvasScale=1,i<r?(e=maxWidth,t=maxHeight,a=minWidth,s=minHeight):(e=maxHeight,t=maxWidth,a=minHeight,s=minWidth),canvas.width/canvas.height<a/s?(canvas.width=e,canvas.height=e*(r/i),canvasScale=e/i):(canvas.height=s,canvas.width=s*(i/r),canvasScale=s/r),gameState){case"network":userInput.removeHitArea("urlAreaFromNetwork"),userInput.addHitArea("urlAreaFromNetwork",butEventHandler,null,"rect",{aRect:[200,200,canvas.width-200,canvas.height-200]},!0);break;case"game":isMobile&&1==gameplayState?(userInput.removeHitArea("gameTouch"),userInput.addHitArea("gameTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,100,canvas.width,canvas.height]},!0)):0==gameplayState&&4!=gameVariation&&updateStartScreenButs();break;case"batShop":userInput.removeHitArea("batShopTouch"),userInput.addHitArea("batShopTouch",butEventHandler,{isDraggable:!0,multiTouch:!0},"rect",{aRect:[0,0,canvas.width,canvas.height]},!0)}prevCanvasWidth=i,prevCanvasHeight=r,window.scrollTo(0,0)}function playSound(e,t){if(void 0===t&&(t=1),1==audioType){var a=sound.play(e);sound.volume(t,a)}}function toggleMute(){muted=!muted,1==audioType?muted?(Howler.mute(!0),music.pause()):(Howler.mute(!1),playMusic(),1==gameplayState?music.volume(minMusicVol):music.volume(maxMusicVol)):2==audioType&&(muted?music.pause():playMusic())}</script>
<script type="text/javascript"> 
	
		var tempBrowserLang = (navigator.language).slice(0, 2)
		var tempLang = "en"
		
		if(tempBrowserLang == "fr" || tempBrowserLang == "de" || tempBrowserLang == "pt" ||tempBrowserLang == "es" ){
			tempLang = tempBrowserLang
		}
		
		
		PokiSDK.init().then(() => {
			console.log("Poki SDK successfully initialized");
			// fire your function to continue to game
			
			loadLang(tempLang);
		}).catch(() => {
			console.log("Initialized, something went wrong, load you game anyway");
			// fire your function to continue to game
			
			loadLang(tempLang);
		});
	</script>
</html>